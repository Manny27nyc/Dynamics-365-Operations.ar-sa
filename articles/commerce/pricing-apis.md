---
title: واجات برمجه تطبيقات تسعير التجارة
description: توضح هذه المقالة واجات برمجه تطبيقات الأسعار المتنوعة التي يتم توفيرها بواسطة مشغل التسعير Microsoft Dynamics 365 Commerce.
author: boycez
ms.date: 08/10/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: global
ms.author: boycez
ms.search.validFrom: 2022-07-15
ms.openlocfilehash: d694c44f6987fbf2a360869d2fb2a2fbaf0d2e4d
ms.sourcegitcommit: 924dbcdc6b03f6a7ae3a07378ec405fd15c7e359
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 08/13/2022
ms.locfileid: "9294102"
---
# <a name="commerce-pricing-apis"></a>واجات برمجه تطبيقات تسعير التجارة

[!include [banner](../includes/banner.md)]

توضح هذه المقالة واجات برمجه تطبيقات الأسعار المتنوعة التي يتم توفيرها بواسطة مشغل التسعير Microsoft Dynamics 365 Commerce.

يوفر مشغل التسعير Dynamics 365 Commerce واجات برمجه التطبيقات (APIs) لخادم البيع بالتجزئة التالية التي يمكن استهلاكها بواسطة التطبيقات الخارجية لدعم سيناريوهات التسعير المختلفة:

- **جيتاكتيفيبريسيس** – يحصل API هذا علي سعر المنتج المحسوب ، بما في ذلك الخصومات البسيطة.
- **كالكولاتيساليسدوكومينت** – تقوم واجهه برمجه التطبيقات هذه بحساب الأسعار والخصومات بالكميات المحددة إذا تم شراؤها معا.
- **جيتافيلابليبروموشنز** – يحصل API هذا علي خصومات قابله للتطبيق للمنتجات في سله التسوق. 
- **أدكوبونس** – يضيف API القسائم إلى سله التسوق.
- **ريموفيكوبونس** – يقوم API هذا بازاله القسائم من سله التسوق.

لمزيد من المعلومات حول كيفيه استهلاك واجات برمجه تطبيقات خادم البيع بالتجزئة في التطبيقات الخارجية ، راجع [استهلاك واجات برمجه تطبيقات خادم البيع بالتجزئة في التطبيقات](dev-itpro/consume-retail-server-api.md) الخارجية.

## <a name="getactiveprices"></a>جيتاكتيفيبريسيس

*تم تقديم جيتاكتيفيبريسيس* API في إصدار 10.0.4 الخاص بالتجارة. يحصل API هذا علي سعر المنتج المحسوب ، بما في ذلك الخصومات البسيطة. وهو لا يقوم بحساب الخصومات متعددة السطور ، ويفترض ان كل منتج في طلب API له كميه قيمتها 1. يمكن أيضا لواجهه برمجه التطبيقات هذه الحصول علي قائمه بالمنتجات كادخال واستعلام سعر المنتجات الفردية بشكل مجمع.

تدعم *واجهه برمجه التطبيقات (API) جيتاكتيفيبريسيس* ادوار التجارة **للموظف** و **العميل** والمستخدمين المجهولين **و** **التطبيقات**.

حاله الاستخدام الرئيسية ل *جيتاكتيفيبريسيس* API هي صفحه تفاصيل المنتج (بدب) ، حيث يرغب بائعي التجزئة في الحصول علي أفضل سعر للمنتج ، بما في ذلك إيه خصومات فعاله.

يعرض الجدول التالي معلمات الإدخال ل *API جيتاكتيفيبريسيس*.

| Name                                    | الاسم الفرعي | النوع | مطلوب / اختياري | ‏‏الوصف‬ |
|-----------------------------------------|----------|------|-------------------|-------------|
| مشروع المجال                           | | ProjectionDomain | مطلوب | |
|                                         | معرف القناة | طويل | مطلوب | |
|                                         | معرف الكتالوج | طويل | مطلوب | |
| معرف المنتج                              | | IEnumerable\<long\> | مطلوب | قائمه المنتجات المطلوب حساب الأسعار لها. |
| تاريخ التفعيل                              | | DateTimeOffset | مطلوب | التاريخ الذي يتم فيه حساب الأسعار. |
| CustomerId                              | | سلسلة | اختياري | رقم حساب العميل. |
| affiliationLoyaltyTiers                 | | IEnumerable\<AffiliationLoyaltyTier\> | اختياري | ‏‫طبقة تبعية وبطاقة‬ الولاء |
|                                         | AffiliationId | طويل | مطلوب | معرف التبعية |
|                                         | لويالتيتيريد | طويل | اختياري | معرّف فئة التبعية. |
| includeSimpleDiscountsInContextualPrice | | قيمة منطقية | اختياري | قم بتعيين هذه المعلمة علي **true** لتضمين خصومات بسيطه في حساب التسعير. القيمة الافتراضية هي **false**. |
| includeVariantPriceRange                | | قيمة منطقية | اختياري | قم بتعيين هذه المعلمة علي **true** للحصول علي الأسعار الأدنى والأقصى بين كافة المتغيرات لمنتج رئيسي. القيمة الافتراضية هي **false**. |
| includeAttainablePricesAndDiscounts     | | قيمة منطقية | اختياري | قم بتعيين هذه المعلمة علي true **للحصول علي الأسعار والخصومات بأتاينابل**. القيمة الافتراضية هي **false**. |

**هيئة طلب العينة**

```json
{
    "projectDomain": 
    {
        "ChannelId": 5637144592,
        "CatalogId": 0
    },
    "productIds": 
    [
        68719489871
    ],
    "activeDate": "2022-06-20T14:40:05.873+08:00",
    "includeSimpleDiscountsInContextualPrice": true,
    "includeVariantPriceRange": false
}
```

**هيئة استجابة العينة**

```json
{
    "value": 
    [
        {
            "ProductId": 68719489871,
            "ListingId": 68719489871,
            "BasePrice": 0,
            "TradeAgreementPrice": 0,
            "AdjustedPrice": 0,
            "MaxVariantPrice": 0,
            "MinVariantPrice": 0,
            "CustomerContextualPrice": 0,
            "DiscountAmount": 0,
            "CurrencyCode": "USD",
            "ItemId": "82000",
            "InventoryDimensionId": null,
            "UnitOfMeasure": "ea",
            "ValidFrom": "2022-06-20T01:40:05.873-05:00",
            "ProductLookupId": 0,
            "ChannelId": 5637144592,
            "CatalogId": 0,
            "SalesAgreementPrice": 0,
            "PriceSourceTypeValue": 1,
            "DiscountLines": [],
            "AttainablePriceLines": [],
        }
    ]
}
```

## <a name="calculatesalesdocument"></a>CalculateSalesDocument

تم *تقديمCalculateSalesDocument* API في إصدار 10.0.25 الخاص بالتجارة. تحسب واجهة برمجة التطبيقات هذه الأسعار والخصومات للمنتجات بكميات معينة إذا تم شراؤها معًا في طلب. ياخذ حساب التسعير خلف كالكولاتيساليسدوكومينت *API العديد من الخصومات* علي البند الواحد والخصومات متعددة البنود.

حاله الاستخدام الرئيسية ل كالكولاتيساليسدوكومينت *API هي حساب التسعير في وحدات السيناريو التي لا يستمر فيها السياق الكامل لسله* التسوق (مثل عروض أسعار المبيعات). يمكن أيضا ان تستفيد السيناريوهات التي يتم بها في نقطه البيع (POS) والتجارة الكترونيه التجارية من حاله الاستخدام هذه. السعر الأقل للإجمالي عند حساب أصناف العربة كمجموعه (علي سبيل المثال ، بالنسبة لمجموعات المنتجات المنفصلة أو المنتجات المرتبطة أو الموصي بها ، أو المنتجات التي تمت اضافتها بالفعل إلى سله التسوق) قد إقناع العملاء باضافه منتجات إلى سله التسوق.

نموذج البيانات لكل من طلب واستجابه واجهه برمجه التطبيقات *كالكولاتيساليسدوكومينت* API هو **عربه**. ومع ذلك ، في سياق API هذا ، يتم تسميه **نموذج البيانات ساليسدوكومينت**. ونظرا لان معظم الخصائص اختياريه ، بينما تؤثر بعضها فقط علي حساب التسعير ، يتم عرض الحقول المتعلقة بالأسعار فقط في الجدول التالي. ولا نوصي بان يتم تضمين إيه حقول أخرى في طلب API.

نطاق *API كالكولاتيساليسدوكومينت* هو فقط حساب الأسعار والخصومات. لا تشتمل الضرائب والرسوم.

يعرض الجدول التالي معلمات الإدخال داخل الكائن الذي يسمي **ساليسدوكومينت**.

| Name             | الاسم الفرعي | النوع | مطلوب / اختياري | ‏‏الوصف‬ |
|------------------|----------|------|-------------------|-------------|
| معرف               | | سلسلة | مطلوب | معرّف مستند المبيعات. |
| كارتلاينز        | | IList\<CartLine\> | اختياري | قائمة الأسطر المراد حساب الأسعار والخصومات لها. |
|                  | ProductId | طويل | مطلوب في نطاق الكارتليني | معرف سجل المنتج. |
|                  | ItemId | سلسلة | اختياري | معرف العنصر. في حاله توفير قيمه ، يجب ان تتطابق مع قيمه المعلمة **ProductId**. |
|                  | InventoryDimensionId | سلسلة | اختياري | معرّف بُعد المخزون. في حاله توفير قيمه ، يجب ان تتطابق مجموعه **قيم ItemId** و **إينفينتوريديمينسيونيد** مع قيمه المعلمة **ProductId**. |
|                  | Quantity | عشري | مطلوب في نطاق الكارتليني | كمية المنتج. |
|                  | UnitOfMeasureSymbol | سلسلة | اختياري | وحدة المنتج. بشكل افتراضي ، إذا لم تكن القيمة متوفرة ، تستخدم واجهه برمجه التطبيقات (API) وحده المبيعات الخاصة بالمنتج. |
| CustomerId       | | سلسلة | اختياري | رقم حساب العميل. |
| LoyaltyCardId    | | سلسلة | اختياري | معرّف بطاقة الولاء. ويجب ان يتطابق اي حساب عميل مقترن ببطاقة الولاء مع قيمه المعلمة **CustomerId** (في حاله توفره). لن يتم اعتبار بطاقة الولاء إذا لم يتم العثور عليها أو ان حالتها قد تم **حظرها** . |
| AffiliationLines | | IList\<AffiliationLoyaltyTier\> | اختياري | خطوط فئات الولاء. إذا **تم توفير قيم CustomerId** و/أو **لويالتيكارديد** ، سيتم دمج بنود طبقه الولاء المرتبطة المقابلة بالبنود التي تم توفيرها في **قيمه أفيلياتيونلينيس**. |
|                  | AffiliationId | طويل | مطلوب في نطاق AffiliationLoyaltyTier | معرف سجل الانتماء. |
|                  | لويالتيتيريد | طويل | مطلوب في نطاق AffiliationLoyaltyTier | معرّف سجل طبقة الولاء. |
|                  | أفيلياتيونتيبيفالوي | الفترة | مطلوب في نطاق AffiliationLoyaltyTier | قيمة تشير إلى ما إذا كان سطر الانتساب من **نوع** عام (**0**) أو **نوع** التبعية (**1**). في حاله تعيين هذه المعلمة علي **0**, يأخذ API **التبعية** القيمة كمعرف ويتجاهل **LoyaltyTierId** القيمة. إذا تم التعيين على **1** ، تاخذ واجهه برمجه التطبيقات **LoyaltyTierId** كمعرف وتتجاهل **قيمه AffiliationId** . |
|                  | خطوط كود السبب. | تشكيلة\<ReasonCodeLine\> | مطلوب في نطاق AffiliationLoyaltyTier | خطوط كود السبب. لا تؤثر هذه المعلمة علي حساب التسعير ولكنها تكون مطلوبه كجزء من **كائن أفيلياتيونلويالتيتير**. |
|                  | CustomerId | سلسلة | مطلوب في نطاق AffiliationLoyaltyTier | رقم حساب العميل. |
| القسائم          | | IList\<Coupon\> | اختياري | لن يتم اعتبار القسائم غير القابلة للتطبيق (غير النشطة أو المنتهية أو التي لم يتم العثور عليها) في حساب التسعير. |
|                  | الكود | سلسلة | مطلوب في نطاق القسيمة | رمز القسيمة. |
|                  | كوديد | سلسلة | اختياري | معرّف رمز القسيمة. في حاله توفير قيمه ، يجب ان تتطابق مع قيمه المعلمة **الرمز**. |
|                  | DiscountOfferId | سلسلة | اختياري | معرّف الخصم. في حاله توفير قيمه ، يجب ان تتطابق مع قيمه المعلمة **الرمز**. |

**هيئة طلب العينة**

```json
{
    "salesDocument": 
    {
        "Id": "CalculateSalesDocument",
        "CartLines": 
        [
            {
                "ProductId": 68719491408,
                "ItemId": "91003",
                "InventoryDimensionId": "",
                "Quantity": 1,
                "UnitOfMeasureSymbol": "ea"
            },
            {
                "ProductId": 68719493014,
                "Quantity": 2,
                "UnitOfMeasureSymbol": "ea"
            }
        ],
        "CustomerId": "3003",
        "AffiliationLines": 
        [
            {
                "AffiliationId": 68719476742,
                "LoyaltyTierId": 0,
                "AffiliationTypeValue": 0,
                "ReasonCodeLines": [],
                "CustomerId": null
            }
        ],
        "LoyaltyCardId": "55103",
        "Coupons": 
        [
            {
                "CodeId": "CODE-0005",
                "Code": "CPN0004",
                "DiscountOfferId": "ST100077"
            }
        ]
    }
}
```

يتم إرجاع كائن سله بالبالكامل كنص الاستجابة. لفحص الأسعار والخصومات ، يجب عليك التركيز علي الحقول الموجودة في الجدول التالي.

| Name           | الاسم الفرعي | النوع | ‏‏الوصف‬ |
|----------------|----------|------|--------------|
| NetPrice       | | عشري | صافي سعر مستند المبيعات بالبالكامل قبل تطبيق الخصومات. |
| DiscountAmount | | عشري | إجمالي مبلغ الخصم لمستند المبيعات بالكامل. |
| المبلغ الإجمالي    | | عشري | المبلغ الإجمالي لمستند المبيعات بالكامل. |
| كارتلاينز      | | IList\<CartLine\> | البنود المحتسبة التي تشتمل علي تفاصيل السعر والخصم. |
|                | السعر | عشري | سعر الوحدة للمنتج. |
|                | NetPrice | عشري | السعر الصافي للبند قبل تطبيق الخصومات (= *السعر* &times; *الكمية*). |
|                | DiscountAmount | عشري | مبلغ الخصم. |
|                | المبلغ الإجمالي | عشري | النتيجة الاجماليه النهائية لتسعير البند. |
|                | PriceLines | IList\<PriceLine\> | تفاصيل السعر ، بما في ذلك مصدر السعر (السعر الأساسي أو تعديل السعر أو الاتفاقية التجارية) والمبلغ. |
|                | DiscountLines | IList\<DiscountLine\> | تفاصيل الخصم. |

## <a name="getavailablepromotions"></a>GetAvailablePromotions 

تقوم الجيتافايلابليبروموشنز *API بإعطاء كافة الخصومات القابلة للتطبيق لبنود سله التسوق ، وذلك بمنح العربة* عده بنود لسله التسوق. 

حاله الاستخدام الرئيسية ل *جيتافيلابليبروموشنز* API هي صفحه السلة ، حيث ترغب بائعي التجزئة في الوضع الذي يقومون به في الخصومات المطبقة أو القسائم المتوفرة لسله التسوق الحالية.

يعرض الجدول التالي معلمات الإدخال ل *API GetAvailablePromotions*.

| Name        | النوع | مطلوب / اختياري | ‏‏الوصف‬ |
|-------------|------|-------------------|-------------|
| المفتاح         | سلسلة | مطلوب | معرف عربة التسوق. |
| كارتلينيدس | IEnumerable\<string\> | اختياري | تعيين هذه المحددة لإرجاع خصومات لبنود السلة المحددة فقط. |

**هيئة استجابة العينة**

```json
{
    "value": 
    [
        {
            "LineId": "f495ffa507bc4f63a47a409cd8713dd7",
            "Promotion": {
                "OfferId": "ST100012",
                "OfferName": "Loyalty 5% off over $100",
                "PeriodicDiscountTypeValue": 4,
                "IsDiscountCodeRequired": false,
                "ValidationPeriodId": null,
                "AdditionalRestrictions": null,
                "Description": "All loyalty members get 5% with transaction total above $10 unless some exclusive or best price discounts are already applied on the transaction",
                "ValidFromDate": "2022-06-20T06:52:56.2460219Z",
                "ValidToDate": "2022-06-20T06:52:56.2460224Z",
                "CouponCodes": [],
                "ValidationPeriod": null
            }
        }
    ]
}
```

## <a name="addcoupons"></a>أدكوبونس

*يدعم أدكوبونس* API أضافه قائمه بالقسائم إلى سله التسوق. وتقوم بإرجاع كائن سله التسوق بعد أضافه القسائم.

يعرض الجدول التالي معلمات الإدخال ل *API AddCoupons*.

| Name                 | النوع | مطلوب / اختياري | ‏‏الوصف‬ |
|----------------------|------|-------------------|-------------|
| المفتاح                  | سلسلة | مطلوب | معرف عربة التسوق. |
| couponCodes          | IEnumerable\<string\> | مطلوب | أكواد القسيمة المراد اضافتها إلى سله التسوق. |
| إيسليجاسيديسكونتكودي | قيمة منطقية | اختياري | قم بتعيين هذه المعلمة علي **rue** للاشاره إلى ان القسيمة عبارة عن كود خصم قديم. القيمة الافتراضية هي **false**. |

## <a name="removecoupons"></a>RemoveCoupons

*يدعم ريموفيكوبونس* API أزاله قائمه بالقسائم من سله التسوق. تقوم بإرجاع عنصر عربة التسوق بعد إزالة القسائم.

يعرض الجدول التالي معلمات الإدخال ل *API RemoveCoupons*.

| Name        | النوع | مطلوب / اختياري | ‏‏الوصف‬ |
|-------------|------|-------------------|-------------|
| المفتاح         | سلسلة | مطلوب | معرف عربة التسوق. |
| couponCodes | IEnumerable\<string\> | مطلوب | رموز القسيمة المراد إزالتها من سلة التسوق. |

[!INCLUDE[footer-include](../includes/footer-banner.md)]
