---
title: الوحدة النمطية للدفع
description: يتناول هذا الموضوع الوحدة النمطية للدفع ويشرح كيفية تكوينها في Microsoft Dynamics 365 Commerce.
author: anupamar-ms
manager: annbe
ms.date: 11/18/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
audience: Application user
ms.reviewer: v-chgri
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: anupamar
ms.search.validFrom: 2019-10-31
ms.dyn365.ops.version: Release 10.0.14
ms.openlocfilehash: d9c0956e30d413f5ae695cf75b06fb58711b2944
ms.sourcegitcommit: eaf330dbee1db96c20d5ac479f007747bea079eb
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/15/2021
ms.locfileid: "5222479"
---
# <a name="payment-module"></a>الوحدة النمطية للدفع

[!include [banner](includes/banner.md)]

يتناول هذا الموضوع الوحدة النمطية للدفع ويشرح كيفية تكوينها في Microsoft Dynamics 365 Commerce.

تتيح الوحدة النمطية للدفع للعملاء بتسديد قيمة الأوامر باستخدام بطاقة الائتمان أو بطاقة الخصم. يتم توفير سلامة الدفع لهذه الوحدة النمطية باستخدام موصل دفع Dynamics 365 لـ Adyen‬. للحصول على معلومات حول كيفية إعداد وتكوين موصل الدفع، راجع [موصل دفع Dynamics 365 لـ Adyen‬](dev-itpro/adyen-connector.md).  

واعتبارًا من 10.0.14 من Commerce، تم أيضًا دمج وحدة الدفع مع Dynamics 365 Payment Connector لـ PayPal للسماح للعملاء بالدفع مقابل الأوامر باستخدام PayPal. للحصول على معلومات حول كيفية إعداد وتكوين Dynamics 365 Payment Connector لـ PayPal، راجع [Dynamics 365 Payment Connector لـ PayPalAdyen‬](paypal.md). 

## <a name="dynamics-365-payment-connector-for-adyen"></a>موصل دفع Dynamics 365 لـ Adyen 

تستضيف الوحدة النمطية للدفع معلومات الدفع التي يتم تقديمها عبر Adyen في اطار HTML مضمن (iframe). تتفاعل الوحدة النمطية للدفع مع Commerce Scale Unit لاسترداد معلومات دفع Adyen. وكجزء من تفاعل Commerce Scale Unit، بإمكان الوحدة النمطية للدفع أن تسمح بتقديم معلومات عنوان الفوترة إما في iframe عبر Adyen أو كوحدة نمطية منفصلة. في نسق ‏‫Fabrikam‬، يتم تمكين عنوان الفوترة في وحدة نمطية منفصلة. يسمح هذا الأسلوب بالحصول على مرونة أكبر في التنسيق، نظرًا لإمكانية عرض بنود العنوان بحيث تشبه بنود عنوان الشحن.

وتتيح أيضًا الوحدة النمطية للدفع للعملاء الذين سجلوا دخولهم بحفظ معلومات الدفع الخاصة بهم. تُحفظ معلومات الدفع وعنوان الفوترة وتتم إدارتها بواسطة موصل دفع Adyen.

تغطي الوحدة النمطية للدفع مصاريف الأوامر التي لم تتم تغطيتها بواسطة نقاط الولاء أو بطاقة هدايا. إذا تمت تغطية القيمة الإجمالية للأمر بواسطة نقاط الولاء أو أرصدة بطاقات الهدايا، فستكون الوحدة النمطية للدفع مخفية، وسيتمكن العميل من تسجيل الأمر من دونها.

يدعم أيضًا موصل دفع Adyen مصادقة العملاء القوية (SCA) يتطلب جزء من التوجيه لخدمات الدفع المُعدلة (PSD2) في الاتحاد الأوروبي أن تتم مصادقة المتسوقين عبر الإنترنت خارج تجربة التسوق الخاصة بهم عبر الإنترنت عندما يستخدمون طريقة دفع إلكترونية. أثناء عملية سير عمل السداد مع الخروج، تتم إعادة توجيه العملاء إلى موقعهم المصرفي، وبعد المصادقة تتم إعادة توجيههم مرة أخرى إلى عملية سير عمل السداد مع الخروج في Commerce. أثناء عملية إعادة التوجيه هذه، سيستمر وجود المعلومات التي أدخلها العميل أثناء عملية سير عمل السداد مع الخروج (على سبيل المثال، عنوان الشحن وخيارات التسليم ومعلومات بطاقة الهدايا ومعلومات الولاء). قبل أن تتمكن من تشغيل ميزة موصل المدفوعات Adyen، يتعين تكوين موصل الدفع لـ SCA في المراكز الرئيسية لـ Commerce. لمزيد من المعلومات، راجع [مصادقة العميل القوية باستخدام Adyen‎](adyen_redirect.md). تم تمكين هذه الميزة في الإصدار 10.0.12 من Commerce.

> [!NOTE]
> بالنسبة لموصل المدفوعات Adyen، يمكن عرض الوحدة النمطية iframe في الوحدة النمطية للدفع فقط إذا قمت بإضافة عنوان Adyen URL إلى قائمة السماح الخاصة بموقعك. لإكمال هذه الخطوة ، قم بإضافة **\*.adyen.com** إلى توجيهات **child-src** و **connect-src** و **img-src** و **script-src** و **style-src** الخاصة بسياسة أمان محتوى الموقع. لمزيد من المعلومات، راجع [إدارة سياسة أمان المحتوى](manage-csp.md). 

يعرض الشكل التوضيحي التالي مثالاً عن وحدات بطاقة الهدايا ونقاط الولاء وموصل المدفوعات Adyen في صفحة السداد مع الخروج.

![مثال على الوحدات النمطية لبطاقة الهدايا ونقاط الولاء وموصل المدفوعات Adyen في صفحة السداد مع الخروج](./media/ecommerce-payments.PNG)

## <a name="dynamics-365-payment-connector-for-paypal"></a>Dynamics 365 Payment Connector لـ PayPal

واعتبارًا من الإصدار 10.0.14 من Commerce، فان الوحدة النمطية للدفع يتم أيضًا دمجها مع Dynamics 365 Payment Connector لـ PayPal. للحصول على معلومات حول كيفية إعداد وتكوين موصل الدفع هذا، راجع [Dynamics 365 Payment Connector لـ PayPal‬](paypal.md).
 
في صفحة السداد والخروج، يمكنك تكوين موصلات Adyen و PayPal. تم تحسين وحدة الدفع بخصائص إضافية للمساعدة في تحديد الموصل الذي يجب أن تعمل باستخدامه. للحصول علي تفاصيل، راجع **أنواع طرق الدفع المعتمدة** وخصائص الوحدة النمطية **الدفع الأساسي** في الجدول التالي.
  
عند تكوين الوحدة النمطية للدفع لاستخدام موصل الدفع PayPal، يظهر زر PayPal في صفحة السداد والخروج. عند الاستدعاء من طرف العميل، تعرض الوحدة النمطية للدفع إطار iframe يحتوي على معلومات PayPal. يمكن للعميل تسجيل الدخول وتوفير معلومات PayPal الخاصة بهم ضمن iframe لإكمال الحركة الخاصة بهم. عندما يختار العميل الدفع باستخدام PayPal، سيتم خصم الرصيد المتبقي في الأمر عبر PayPal.

لا يتطلب موصل الدفع PayPal وحدة عنوان الفوترة لأن PayPal يتعامل مع جميع المعلومات المتعلقة بالفوترة ضمن إطار iframe الخاص به. ومع ذلك، فإن عنوان الشحن ووحدات خيارات التسليم مطلوبة.

يبين الرسم التوضيحي التالي مثالاً لوحدتي دفع على صفحة الدفع، إحداهما تم تكوينها باستخدام موصل الدفع Adyen والأخرى باستخدام موصل الدفع PayPal.
![مثال لوحدات الدفع باستخدام Adyen وPayPal على صفحة السداد مع الخروج](./media/ecommerce-paypal.png)

يبين الرسم التوضيحي التالي مثالاً على PayPal iframe الذي تم استدعاؤه باستخدام زر PayPal. 
![مثال على Paypal iframe على صفحة الدفع](./media/ecommerce-paypal-iframe.png)

## <a name="payment-module-properties"></a>خصائص الوحدة النمطية للدفع

| اسم الخاصية | القيم | الوصف |
|---------------|--------|-------------|
| العنوان | نص العنوان | عنوان اختياري للوحدة النمطية للدفع. |
| ارتفاع iframe | بكسل | ارتفاع iframe بالبكسل. يمكن ضبط الارتفاع كما هو مطلوب. |
| إظهار عنوان الفاتورة | **صحيح** أم **خطأ** | إذا تم تعيين هذه الخاصية إلى **صواب**، سيتم تقديم عنوان الفاتورة بواسطة Adyen داخل iframe للوحدة النمطية للدفع. إذا تم تعيينها إلى **خطأ**، فلن يتم عرض عنوان الفوترة بواسطة Adyen، وسيتعين على مستخدم Commerce تكوين وحدة نمطية لعرض عنوان الفوترة على صفحة السداد مع الخروج. بالنسبة لموصل الدفع PayPal، ليس لهذا الحقل أي تأثير، حيث يتم التعامل مع عنوان الفواتير بالكامل داخل PayPal. |
| تجاوز نمط الدفع | كود أوراق الأنماط المتتالية (CSS) | بسبب استضافة الوحدة النمطية للدفع في iframe، هناك إمكانية محدودة لتطبيق الأنماط. يمكنك تطبيق بعض الأنماط باستخدام هذه الخاصية. لتجاوز أنماط الموقع، يجب عليك لصق كود CSS كقيمة لهذه الخاصية. لا تنطبق تجاوزات وأنماط CSS منشئ الموقع على هذه الوحدة النمطية. |
|أنواع طرق الدفع المدعومة| سلسلة| إذا تم تكوين موصلات دفع متعددة، فينبغي عليك توفير سلسلة أنواع طرق الدفع المعتمدة‬‏‫ كما هو محدد في تكوين موصل الدفع للمراكز الرئيسية لـ Commerce (طالع الصورة التالية). إذا كان فارغًا، فسيتم تعيينه افتراضيًا على موصل الدفع Adyen. تمت إضافتها في الإصدار 10.0.14 من Commerce.|
|عبارة عن عملية دفع أولية|  **صحيح** أم **خطأ** | إذا كانت القيمة **صحيح**، سيتم إنشاء أي رسائل خطأ من موصل الدفع الأساسي في صفحة السداد مع الخروج. إذا تم تكوين موصلات الدفع Adyen وPayPal، فقم بتعيين Adyen إلى **صحيح**، والذي تمت إضافته في الإصدار 10.0.14 من Commerce.|

يبين الرسم التوضيحي التالي مثالاً لقيمة **‬‏‫أنواع طرق الدفع المعتمدة‬‏‫** التي تم تعيينها على "PayPal" في تكوين موصل الدفع في المراكز الرئيسية لـ Commerce.
![مثال علي أنواع طرق الدفع المعتمدة في المراكز الرئيسية لـ Commerce](./media/ecommerce-paymenttendertypes.png)

## <a name="billing-address"></a>عنوان الفوترة

يمكن استخدام الوحدة النمطية لعنوان الفاتورة في صفحة السداد مع الخروج إذا كانت سطور عنوان فوترة لموصل الدفع Adyen لا تتطابق بشكل كافٍ مع مظهر باقي الموقع. 

لاستخدام وحدة عنوان الفوترة في صفحة السداد مع الخروج عندما يتم دمج الوحدة النمطية للدفع مع موصل الدفع Adyen، قم بتعيين خاصية **إظهار عنوان الفاتورة** إلى **خطأ** بحيث يمكن استخدام الوحدة النمطية لعنوان الدفع المخصص بدلاً من عنوان فوترة Adyen الافتراضي. في هذه الحالة، يتعين على مؤلف الموقع تضمين وحدة عنوان الفاتورة في صفحة السداد مع الخروج. ويسمح موصل الدفع Adyen أيضًا بالقدرة على استخدام عنوان الشحن كعنوان للفاتورة وذلك لتقليل عدد الخطوات لمستخدم الموقع.

وعلى غرار الوحدات النمطية للدفع، تمت إضافة خاصية **أنواع طرق الدفع المعتمدة** إلى وحدة عنوان الفواتير في الإصدار 10.0.14 من Commerce. يجب أن تكون قيمة هذه الخاصية مطابقة للقيمة المقدمة في الوحدة النمطية للدفع للتأكد من أنها تعمل معًا. بالنسبة لموصل الدفع Adyen، يتعين أن تترك كل من الوحدة النمطية للدفع ووحدة عنوان الفاتورة هذه القيمة فارغة (الحالة الافتراضية). بالنسبة لموصل PayPal، لا يلزم وجود وحدة مخصصة لعنوان الفاتورة. بالنسبة للأنواع الأخرى من موصلات الدفع، ينبغي توفير السلسلة كما تم تكوينها في المراكز الرئيسية لـ Commerce.

## <a name="add-a-payment-module-to-a-checkout-page-and-set-the-required-properties"></a>إضافة وحدة نمطية للدفع إلى صفحة السداد مع الخروج وتعيين الخصائص المطلوبة

يمكن إضافة وحده نمطية للدفع فقط إلى وحدة نمطية للسداد مع الخروج. لمزيد من المعلومات حول كيفية تكوين وحدة نمطية للدفع لصفحة السداد مع الخروج، راجع [الوحدة النمطية للسداد مع الخروج](add-checkout-module.md).

إذا كانت هناك حاجة إلى موصلات دفع Adyen وPayPal، فقم بإضافة كلا الوحدتين النمطيتين إلى قسم الدفع. تأكد من تكوين قيمة خاصية **‬‏‫أنواع طرق الدفع المعتمدة‬‏‫** لـ PayPal، وتركها فارغة لـ Adyen. وقم أيضًا بتعيين خاصية **‬‏‫الدفع الأساسي** إلى **صحيح** لـ Adyen.

## <a name="additional-resources"></a>الموارد الإضافية

[الوحدة النمطية لعربة التسوق](add-cart-module.md)

[الوحدة النمطية لرمز عربة التسوق](cart-icon-module.md)

[الوحدة النمطية للسداد مع الخروج](add-checkout-module.md)

[الوحدة النمطية لعنوان الشحن](ship-address-module.md)

[الوحدة النمطية لخيارات التسليم](delivery-options-module.md)

[الوحدة النمطية لمعلومات الالتقاط](pickup-info-module.md)

[الوحدة النمطية لتفاصيل الأوامر](order-confirmation-module.md)

[الوحدة النمطية لبطاقة الهدايا](add-giftcard.md)

[موصل دفع Dynamics 365 لـ Adyen](dev-itpro/adyen-connector.md)

[Dynamics 365 Payment Connector لـ PayPal](paypal.md)

[مصادقة العملاء القوية باستخدام Adyen](adyen_redirect.md)


[!INCLUDE[footer-include](../includes/footer-banner.md)]