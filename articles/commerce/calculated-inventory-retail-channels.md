---
title: حساب توفر المخزون لقنوات البيع بالتجزئة
description: يصف هذا الموضوع الخيارات المتوفرة لإظهار المخزون المتاح للمتجر والقنوات عبر الإنترنت.
author: hhainesms
manager: annbe
ms.date: 08/13/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-commerce
ms.technology: ''
audience: Application User
ms.reviewer: v-chgri
ms.search.scope: Retail, Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: hhaines
ms.search.validFrom: 2020-02-11
ms.dyn365.ops.version: Release 10.0.10
ms.openlocfilehash: de4ee98198f441b8f42a8a55aa5ff1015f485234
ms.sourcegitcommit: 708ca25687a4e48271cdcd6d2d22d99fb94cf140
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 10/10/2020
ms.locfileid: "3975982"
---
# <a name="calculate-inventory-availability-for-retail-channels"></a>حساب توفر المخزون لقنوات البيع بالتجزئة

[!include [banner](../includes/banner.md)]

يصف هذا الموضوع كيفية استخدام شركة Microsoft Dynamics 365 Commerce لعرض توافر المنتجات الحالي المقدر في قنوات عبر الإنترنت وقنوات المتجر.

## <a name="accuracy-of-calculation"></a>دقة الحساب

يستخدم Commerce خوادم وقواعد بيانات متعددة لضمان إمكانية التوسع والأداء. وبالتالي، فإنه من المهم أن تفهم أن قيم المخزون المتوفرة التي يتم توفيرها من خلال تطبيق نقطة البيع (POS) وواجهات برمجة التطبيقات (API) الخاصة بتوافر في التجارة الإلكترونية وصفحات المخزون الحالي في Commerce Headquarters قد لا يكون دقيقًا بنسبة 100 بالمائة في الوقت الحقيقي. في حالة عدم مزامنة الحركات التي تم إنشاؤها للمنتجات الموجودة في القناة عبر الإنترنت أو المتجر بخادم Commerce Headquarters وقاعدة البيانات، فقد لا تعرض صفحات المخزون الحالي في Commerce Headquarters قيمة مخزون الوقت الحقيقي الدقيقة لتلك المنتجات. وعلى العكس، إذا قمت بتكوين شركتك بحيث يمكن للمستخدمين في Commerce Headquarters أو التطبيقات المتكاملة البيع أو الاستلام أو الإرجاع أو القيام بتعديل المخزون من متجر أو مستودع عبر الإنترنت، فقد لا تشتمل نقطة البيع أو القناة عبر الإنترنت على كافة المعلومات المطلوبة لعرض قيمة الدقيقة حالية في الوقت الحقيقي للأصناف.

يشرح هذا الموضوع عمليات مزامنة البيانات التي يمكن تشغيلها بشكل متكرر للمساعدة في تحديد زمن انتقال البيانات بين التطبيقات أو القنوات. ومع ذلك، فإنه من الضروري معرفة أن كافة بيانات التوافر الحالية التي يتم توفيرها أثناء يوم العمل تعتبر قيمة تقديرية. وبالتالي، إذا حاولت مقارنة معلومات المخزون الحالية التي يقدمها التطبيق مع المخزون الفعلي على الأرفف، أو إذا حاولت مقارنة القيم الحالية التي تظهر في نقطة البيع مع البيانات الحالية التي تعثر عليها للمستودع نفسه في Commerce Headquarters، فقد تختلف القيم. ومن المتوقع حدوث هذا الاختلاف أثناء يوم التشغيل ولا يجب اعتباره إصدارًا. إذا كنت ترغب في تدقيق البيانات والتأكد من أن القيم التي يتم تقديمها في واجهات برمجة التطبيقات (API) لتوافر المخزون وCommerce Headquarters تطابق الوحدات الفعلية التي تجدها في المتجر أو أرفف المستودع، فإن أفضل وقت للقيام بذلك يكون توقف عمليات القناة لليوم وتمت مزامنة كافة الحركات بشكل صحيح بين Commerce Headquarters والقناة.

## <a name="use-inventory-lookup-apis-for-e-commerce-inventory-availability-requests"></a>استخدام واجهات برمجة التطبيقات للبحث في المخزون لطلبات توفر مخزون التجارة الإلكترونية

يمكنك استخدام واجهات برمجة التطبيقات التالية لإظهار إتاحة المخزون لمنتج ما عندما يتسوق العملاء على موقع تجارة إلكترونية.

- **GetEstimatedAvailability** – استخدم واجهة برمجة التطبيقات هذه للحصول على إمكانية توفر المخزون للصنف في مستودع قناة التجارة الإلكترونية أو كافة المستودعات التي تم ربطها بتكوين مجموعة التنفيذ لقناة التجارة الإلكترونية. يمكن استخدام واجهة برمجة التطبيقات هذه أيضًا للمستودعات الموجودة في منطقة بحث أو نصف قطر معينة، استنادًا إلى بيانات خط الطول وخط العرض.
- **GetEstimatedProductWarehouseAvailability** – استخدم واجهة برمجة التطبيقات هذه لطلب مخزون لعنصر ما من مستودع معين. على سبيل المثال، يمكنك استخدامه لإظهار إتاحة المخزون في السيناريوهات التي تتضمن انتقاء الأمر.

> [!NOTE]
> تحل واجهات برمجة التطبيقات هذه محل واجهات برمجة التطبيقات **GetProductAvailabilities** و **GetAvailableInventoryNearby** هذه في Dynamics 365 Retail الإصدار 10.0.7 وما قبله.

تقوم كلا واجهتي برمجة التطبيقات بإحضار البيانات من خادم Commerce وتوفير تجزء مُقدر للمخزون الحالي لمجموعة معينة المنتجات أو متغيرات المنتج والمستودع. على الرغم من أن واجهات برمجة التطبيقات الأخرى المتوفرة على خادم Commerce يمكنها الانتقال مباشره إلى Commerce Headquarters لإحضار كميات حالية للمنتجات، إلا أننا لا نوصي باستخدامها في بيئة تجارة إلكترونية نظرًا لوجود مشكلات محتملة في الأداء والتأثير المرتبط بالطلبات المتكررة هذه يمكن أن تكون موجودة على خوادم Commerce Headquarters الخاصة بك. بالإضافة إلى ذلك، إذا تم حساب المخزون الحالي من خلال خادم Commerce، فإنه من المحتمل أن تشتمل العملية الحسابية على المخزون الذي تم بيعه في حركات التجارة الإلكترونية الحديثة التي لم تتم مزامنتها بعد إلى Commerce Headquarters. على الرغم من أن Commerce Headquarters لا تحتوي على معلومات حول هذه الحركات، فإن خادم Commerce وقاعدة بيانات القناة تحتوي على البيانات. وبالتالي، سيتم تحليل البيانات ويمكن أن تساعد في توفير تقدير أكثر دقة للمخزون المتوفر للمنتج.

### <a name="get-started-with-e-commerce-calculated-inventory-availability"></a>البدء مع توفر المخزون المحسوب للتجارة الإلكترونية

قبل استخدام واجهتي برمجة التطبيقات التي سبق ذكرها، يجب تمكين ميزة **الحساب المحسن لتوفر المنتج** من خلال مساحة عمل **إدارة الميزات** في مركز Commerce الرئيسي.

قبل أن تتمكن واجهات برمجة التطبيقات (API) من حساب أفضل تقدير لتوفر المخزون لأحد الأصناف، فإنه يجب معالجة اللقطة الدورية لتوفر المخزون من Commerce Headquarters وإرسالها إلى قاعدة بيانات القناة التي تستخدمها Commerce Scale Unit الخاصة بالتجارة الإلكترونية. تمثل اللقطة المعلومات التي يشتمل عليها Commerce Headquarters حول توفر المخزون لمجموعة معينة من منتج أو متغير المنتج ومستودع. ويمكن أن يتضمن تعديلات المخزون أو الحركات الناتجة عن إيصالات استلام المخزون أو بواسطة الشحنات أو العمليات الأخرى التي يتم إجراؤها في Commerce Headquarters وبأن قناه التجارة الإلكترونية بها معلومات عن ذلك فقط بسبب عملية المزامنة.

تقوم لقطة قاعدة البيانات التي تقوم وظيفة **توافر المنتج** بحساب حركات المخزون التي تمت معالجتها وترحيلها فقط في Commerce Headquarters في الوقت الذي تم فيه أخذ اللقطة. إذا تم بيع المخزون لأحد المنتجات في مستودع متجر من خلال مبيعات أمر الدفع نقدًا أو عميل غير متزامن في تطبيق نقطة البيع، فلن يحصل Commerce Headquarters فورًا على معلومات حول حركة إصدار المخزون المرتبطة بعملية البيع. ستحتوي على معلومات حول المخزون الذي يتم بيعه لهذه الأنواع من مبيعات المتجر فقط بعد قيام وظيفة P بتحميل الحركة المرتبطة من قاعدة بيانات القناة الخاصة بالمتجر على Commerce Headquarters ويتم إنشاء أمر المبيعات المرتبط من خلال عمليات ترحيل بيان أو ترحيل التغذية المستمرة. وتقوم عملية إنشاء الأمر في Commerce Headquarters بإنشاء حركات المخزون المرتبطة. بالنسبة لأوامر القنوات التجارة الإلكترونية، يحتوي Commerce Headquarters على معلومات حول حركات المخزون فقط بعد إرسال الحركات إلى Commerce Headquarters خلال وظيفة P وتكتمل عملية مزامنة الأمر. وبالتالي، فإنه من المهم أن تفهم أن قيمة لقطة المخزون التي يتم تقديمها في وظيفة **توفر المنتج** قد لا تكون دقيقة بنسبة 100 بالمائة في الوقت الحقيقي بسبب معالجة المبيعات الثابتة التي تحدث عبر الخوادم الموزعة.

لتصوير لقطة للمخزون في Commerce Headquarters، اتبع الخطوات التالية.

1. انتقل إلى **Retail and Commerce \> تكنولوجيا معلومات Retail and Commerce \> المنتجات والمخزون \> توفر المنتج** .
1. حدد **موافق** لتشغيل وظيفة **توفر المنتج** . يمكنك أيضًا جدولة هذه الوظيفة بحيث يتم تشغيلها في دفعة.

بعد انتهاء تشغيل وظيفة **توفر المنتج** ، فإنه يجب دفع البيانات التي تم الحصول عليها إلى قواعد بيانات قناه التجارة الإلكترونية، حتى يمكن اعتبار أحدث لقطة لمخزون Commerce Headquarters في حساب المخزون الحالي المقدر.

1. انتقل إلى **البيع بالتجزئة والتجارة \> تكنولوجيا معلومات البيع بالتجزئة والتجارة \> جدول التوزيع** .
1. قم بتشغيل وظيفة **1130** ( **توفر المنتج** ) لمزامنة بيانات اللقطة التي تم إنشاء وظيفة **توفر المنتج** منها من Commerce Headquarters إلى قواعد بيانات القناة الخاصة بك.

عندما يتم طلب توفر المخزون من واجهة برمجة التطبيقات **GetEstimatedAvailability** أو **GetEstimatedProductWarehouseAvailability** ، يتم تشغيل عملية حسابية لمحاولة الحصول على أفضل تقدير ممكن لمخزون المنتج. وتشير العملية الحسابية إلى أي أوامر عميل في التجارة الإلكترونية موجودة في قاعدة بيانات القناة ولكن لم يتم تضمينها في بيانات اللقطة في وظيفة 1130 المقدمة. ويتم أداء هذا المنطق من خلال تعقب آخر حركة مخزون تمت معالجتها من Commerce Headquarters ومقارنتها بالحركات في قاعدة بيانات القناة. ويوفر أساسًا لمنطق حساب جانب القناة، بحيث يمكن تحليل حركات المخزون الإضافية التي حدثت لحركات مبيعات أمر العميل في قاعدة بيانات قناة التجارة الإلكترونية إلى قيمة المخزون المقدرة التي تقدم واجهة برمجة التطبيقات.

يقوم منطق حساب جانب القناة بإرجاع القيمة المتاحة فعليًا المقدرة والقيمة الإجمالية المتاحة للمنتج والمستودع المطلوبين. يمكن عرض القيم على موقع التجارة الإلكترونية الخاص بك إذا أردت، أو يمكن استخدامها لتشغيل منطق الأعمال الأخرى على موقع التجارة الإلكترونية الخاص بك. على سبيل المثال، يمكنك إظهار الرسالة "نفاد الأسهم" بدلاً من الكمية الحالية الفعلية التي اجتازتها واجهة برمجة التطبيقات.

يعمل منطق الحساب الذي تستخدمه واجهات برمجة التطبيقات (API) الخاصة بالتجارة الإلكترونية بجانب القناة لقيمة المخزون المقدرة على تقييم المخزون استنادًا إلى أوامر العملاء التي تم إنشاؤها في قاعدة بيانات القناة فقط، ولكن لم تتم مزامنتها وترحيلها في Commerce Headquarters بعد. إذا كانت قاعدة بيانات القناة كذلك تحتوي على بيانات المعاملات لمبيعات الدفع نقدًا للمستودعات الخاصة بالمتجر، فلن يتم تحليل مبيعات الدفع نقدًا إلى حساب التجارة الإلكترونية لجانب القناة لهذه المستودعات.

## <a name="configure-the-inventory-lookup-operation-in-the-pos-channel"></a>تكوين عملية البحث في المخزون في قناة نقطة البيع

في إصدار Retail 10.0.9 والإصدارات السابقة، قامت عملية **البحث عن المخزون** من نقطة البيع باستخدام استدعاء خدمة في الوقت الحقيقي لـ Commerce Headquarters للحصول على معلومات المخزون للمنتج المحدد، لكل من المتجر الحالي للمستخدم وأية قصص أخرى يتم تكوينها لمجموعة التنفيذ كجزء من تكوين القناة للمتجر. في إصدار Commerce 10.0.10 والإصدارات الأحدث، يمكنك إيقاف تشغيل استدعاءات خدمة في الوقت الحقيقي لـ Commerce Headquarters. بدلاً من ذلك، يمكنك استخدام حساب جانب القناة على ملقم التجارة لتحديد المخزون الحالي المتوفر فعليًا للمتجر وأية مواقع أخرى يتم تحديدها في مجموعة التنفيذ. يكون تكوين المخزون المحسوب لهذه القناة مفيدًا أيضًا للمواقع التي يكون فيها اتصال الإنترنت غير موثوق، لأنه ليس من الضروري أن تكون متصلاً بالإنترنت للحصول على عمليات بحث المخزون من Commerce Headquarters.

عند تكوين حساب جانب القناة بشكل صحيح وإدارته، فإنه يمكن أن يوفر تقديراً أكثر موثوقية لمخزون المتجر الحالي، نظرًا لأنه يستخدم بيانات الحركة الموجودة في قاعدة بيانات قناة Commerce، ولكن قد لا يحتوي Commerce Headquarters على المعلومات بعد. على سبيل المثال، إذا قمت باستخدام استدعاء خدمة في الوقت الحقيقي الموجودة لعمليات بحث المخزون في نقطة البيع، فمن المحتمل ألا تشتمل Commerce Headquarters على معلومات حول عملية بيع الدفع نقدًا والتي حدثت للتو لأحد المنتجات. وبالتالي، من المحتمل أن تتجاوز قيمة المخزون الحالي التي يقوم بإرجاعها Commerce Headquarters لذلك المنتج المخزون الحالي الفعلي بمقدار وحدة واحدة. ومع ذلك، إذا كنت تستخدم حساب جانب القناة، فإنه يمكن تحليل عملية البيع والدفع نقدًا للحساب والخصم من القيمة الحالية التي يتم عرضها. وعلى الرغم من أن القيم التي توفرها كل من حساب جانب القناة واستدعاء خدمة في الوقت الحقيقي هي فقط التقديرات الخاصة بالمخزون الحالي والقيمة التي يوفرها حساب جانب القناة من المحتمل أن تكون أكثر دقة للمتجر الحالي.

### <a name="get-started-with-pos-channel-side-calculated-inventory-availability"></a>البدء مع توفر المخزون المحسوب لجانب قناة نقطة البيع

لاستخدام منطق الحساب بجانب القناة وإيقاف تشغيل استدعاءات الخدمة في الوقت الحقيقي لعمليات البحث الخاصة بالمخزون من تطبيق نقطة البيع، يجب أولا تمكين ميزة **الحساب المحسن لتوفر المنتج** من خلال مساحة عمل **إدارة الميزات** في مركز Commerce الرئيسي. بالإضافة إلى تمكين الميزة، يجب إجراء تغييرات على **ملف تعريف الوظائف** .

لتغيير **ملف تعريف الوظيفة** ، اتبع هذه الخطوات:

1. انتقل إلى **البيع بالتجزئة والتجارة \> إعداد القناة \> إعداد قناة البيع \> ملفات تعريف نقطة البيع \> ملفات تعريف الوظائف** .
1. حدد ملف تعريف وظائف.
1. في علامة التبويب السريعة **وظائف** ، في القسم **حساب توفر المخزون** ، ثم قم بتغيير قيمة الحقل **وضع حساب توفر المخزون** من **خدمة Real time service** إلى **القناة** . بشكل افتراضي، تستخدم كافة ملفات تعريف الوظائف استدعاءات خدمة في الوقت الحقيقي. وبالتالي، يجب تغيير قيمة هذا الحقل إذا كنت تريد استخدام منطق حساب جانب القناة. سيتأثر كل متجر للبيع بالتجزئة مرتبط بملف تعريف الوظائف المحددة بهذا التغيير.

يجب عليك بعد ذلك مزامنة التغييرات إلى القناة من خلال عملية جدولة التوزيع من خلال تنفيذ الخطوات التالية:

1. انتقل إلى **البيع بالتجزئة والتجارة \> تكنولوجيا معلومات البيع بالتجزئة والتجارة \> جدول التوزيع** .
1. قم بتشغيل وظيفة **1070** ( **تكوين القناة** ).

بعد اكتمال التكوين، لا تستخدم المعلومات التي يتم تقديمها عن المخزون المتوفر فعليًا استدعاء خدمة في الوقت الحقيقي عندما يستخدم المستخدم في تطبيق نقطة البيع عملية **البحث عن المخزون** (طرق العرض القياسية والمصفوفة). بدلاً من ذلك، يتم حساب البيانات الخاصة بالمخزون المتوفر فعليًا للمتجر الحالي وكذلك كافة المتاجر في مجموعة التنفيذ بناء على آخر لقطة معروفة تم تسليمها إلى قاعدة بيانات القنوات من Commerce Headquarters. يتم تحسين قيمة اللقطة بشكل أكبر بواسطة حساب جانب القناة لتسوية القيمة المتوفرة فعليًا، استنادًا إلى المبيعات الإضافية أو حركات الإرجاع الموجودة للمنتج المحدد في قاعدة بيانات القناة التي لم يتم تضمينها في آخر لقطة تمت مزامنتها من الوظيفة 1130. إذا كانت قاعدة بيانات القناة لا تحتوي على بيانات حركة لأي من المستودعات أو المتاجر في مجموعة التنفيذ، فإنها لا تحتوي على أية حركات إضافية يمكن تحليلها إلى إعادة حساب القيمة. وبالتالي، يكون أفضل تقدير للمخزون الحالي الذي يمكن عرضه لهذه المستودعات أو المتاجر هو البيانات الموجودة في آخر لقطة معروفة من Commerce Headquarters.

تقوم كذلك شاشات **تنفيذ الأمر** لنقطة البيع بزيادة حساب جانب القناة لإظهار المخزون الحالي للأصناف عند تحديد خط تنفيذ الأمر ويعرض المستخدم لوحة **التفاصيل** للمخزون الحالي للصنف المحدد.

## <a name="optimize-your-inventory-data"></a>تحسين بيانات المخزون

لضمان أفضل تقدير ممكن للمخزون، فمن الضروري أن تقوم باستخدام الوظائف الدفعية لـ Commerce التالية وتشغيلها بشكل متكرر:

- **الوظيفة P** – تم العثور على وظيفة P في الصفحة **جداول التوزيع** ويجب تشغيلها بشكل متكرر. تقوم هذه الوظيفة بإحضار أوامر التجارية الإلكترونية وأوامر العميل غير المتزامنة التي قامت نقطة البيع بإنشائها وأوامر الدفع نقدًا التي قامت نقطة البيع بإنشائها من قواعد بيانات القناة في Commerce Headquarters، لذلك يمكن معالجتها أكثر من ذلك. حتى تتم مزامنة هذه البيانات من القناة إلى Commerce Headquarters، لا يحتوي Commerce Headquarters على معلومات حول تعديلات المخزون إلى المنتجات الموجودة في المستودعات التي تنتج عن هذه الحركات.
- **مزامنة الأوامر** – تقوم هذه الوظيفة بمعالجة بيانات الحركة الأولية في Commerce Headquarters التي تقدم وظيفة P وتحول التجارة الإلكترونية وحركات أمر العميل غير المتزامنة والتجارة الإلكترونية إلى أوامر المبيعات في Commerce Headquarters. وحتى تتم معالجة هذه الوظيفة وإنشاء أوامر المبيعات، فإنه لن يتم إنشاء أية حركات مخزون. وبالتالي، فإن المخزون الحالي في Commerce Headquarters لا يعتبر الحركات.
- **حساب كشوف الحركات في الدفعة** - بالنسبة لحركات الدفع نقدًا التي يتم إنشاؤها في المتجر، تعمل عملية ترحيل التغذية المستمرة على تأكيد أنه يتم تحديث المخزون المرتبط بالمبيعات بكفاءة. للحصول على المعالجة الأكثر كفاءة لحركات المخزون لأوامر الدفع نقدًا، تأكد من أنك تقوم بتكوين نظامك لاستخدام [ترحيل التغذية المستمرة](https://docs.microsoft.com/dynamics365/commerce/trickle-feed).
- **ترحيل كشوف الحركات على دفعات** - هذه الوظيفة مطلوبة أيضًا لترحيل التغذية المستمرة. ويتبع الوظيفة **حساب كشوف الحركات على دفعات** . تقوم هذه الوظيفة بترحيل ‏‫كشوف الحساب المحسوبة بشكل منتظم، بحيث يتم إنشاء أوامر المبيعات الخاصة بمبيعات الدفع نقدًا في Commerce Headquarters ويعكس Commerce Headquarters لمخزون المتجر بشكل أكثر دقة.
- **توفر المنتج** – تقوم هذه الوظيفة بإنشاء لقطة المخزون من Commerce Headquarters.
- **1130 (توفر المنتج)** – يتم العثور على هذه الوظيفة في الصفحة **جداول التوزيع** وينبغي تشغيلها على الفور بعد وظيفة **توفر المنتج** . تقوم هذه الوظيفة بنقل بيانات لقطة المخزون من Commerce Headquarters إلى قواعد بيانات القنوات.

من المستحسن عدم تشغيل المهام الدُفعية بشكل متكرر (كل بضع دقائق). تؤدي عمليات التشغيل المتكررة إلى زيادة التحميل في مركز Commerce الرئيسي ويمكنها أن تؤثر على الأداء. بشكل عام، من الأفضل تشغيل توفر المنتجات ومهام 1130 بالساعة، وجدولة وظيفة P ومزامنة الأوامر، والتغذية المستمرة للمهام ذات الصلة بالترحيل بالتكرار نفسه أو أعلى..

> [!NOTE]
> لأسباب تتعلق بالأداء، عند استخدام حسابات توفر مخزون جانب القناة لإصدار طلب توفر المخزون باستخدام واجهة برمجة التطبيقات بالتجارة الإلكترونية أو منطق المخزون الخاص بقناة نقطة البيع الجديدة، يستخدم الحساب ذاكرة تخزين مؤقت لتحديد ما إذا كان قد مر وقت كاف لضبط تشغيل منطق الحساب مرة أخرى. يتم تعيين ذاكرة التخزين المؤقتة الافتراضية على 60 ثانية. على سبيل المثال، إذا قمت بتشغيل حساب جانب القناة للمتجر الخاص بك وقمت بعرض المخزون الحالي لأحد المنتجات في الصفحة **البحث عن المخزون** . إذا تم بيع إحدى وحدات المنتج بعد ذلك، فلن تعرض الصفحة **البحث عن المخزون** المخزون المخفض حتى يتم مسح ذاكرة التخزين المؤقت. بعد قيام المستخدمون بترحيل الحركات في نقطة البيع، فإنه يجب عليهم الانتظار 60 ثانية قبل التحقق من أن المخزون الحالي قد تم خفضه.

إذا تطلب السيناريو التجاري الخاص بك وقتًا أقل في ذاكرة التخزين المؤقت، فاتصل بممثل دعم المنتج للحصول على المساعدة.
