---
title: ملفات تعريف الشهادات المعرفة من قِبل المستخدمين لمتاجر البيع بالتجزئة
description: يوفر هذا المقال نظرة عامة حول ملفات تعريف الشهادات المتوفرة في Microsoft Dynamics 365 Commerce.
author: josaw1
ms.date: 09/21/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.region: Global
ms.author: v-chgriffin
ms.search.validFrom: 2020-10-09
ms.dyn365.ops.version: 10.0.15
ms.search.industry: Retail
ms.search.form: RetailFormLayout, RetailParameters
ms.openlocfilehash: 5baf043a43210d819b605546089e981c86922ca9
ms.sourcegitcommit: 4f28f262cfb8f047cb5c0070261aa0748835e74b
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 09/21/2022
ms.locfileid: "9558427"
---
# <a name="user-defined-certificate-profiles-for-retail-stores"></a>ملفات تعريف الشهادات المعرفة من قِبل المستخدمين لمتاجر البيع بالتجزئة

[!include [banner](../includes/banner.md)]

يوفر هذا المقال نظرة عامة حول ملفات تعريف الشهادات المتوفرة في Microsoft Dynamics 365 Commerce. تعمل هذه الوظيفة علي توسيع ميزه [أداره قنوات البيع بالتجزئة](../dev-itpro/manage-secrets.md) عن طريق أضافه دعم للشهادات المحلية.

في أثناء تشغيل نقطه البيع (POS) في الوضع "غير متصل"، لا يمكن الوصول إلى الشهادات المخزنة في المخزن الرئيسي‬ Microsoft Azure. يجب استخدام الشهادة المحلية بدلا منها. الإمكانات التالية مدعومة:

- استخدام الشهادات المحلية في سيناريوهات المخزن الرئيسي الاحتياطية
- استخدام الشهادات المحلية من دون المخزن الرئيسي (علي سبيل المثال، في تثبيت محلي)
- تحديث تدريجي للشهادات، حيث تستخدم بعض المخازن والوحدات الطرفية إصدارا جديدا للشهادة، ولكن بعض المتاجر والوحدات الطرفية الأخرى تستمر في استخدام الإصدار السابق

تمكنك وظيفة ملفات تعريف الشهادات من تحديد الشهادة الافتراضية وتعيين الترتيب الذي يتم من خلاله البحث في الشهادات الموجودة في نفس ملف تعريف الشهادة. توفر هذه الوظيفة أيضا أسلوب اعداد مشابه للشهادات المحلية وشهادات المخزن الرئيسي. يمكنك أضافه إعدادات خاصه بالشركة للشهادات، ولكن يمكن استخدام معرف الشركة المشتركة الفريد لكل شهادة في قنوات التجارة.

### <a name="scenarios"></a>السيناريوهات

تدعم وظيفة ملفات تعريف الشهادات السيناريوهات التالية في قنوات التجارة:

- استخدم شهادة محلية في سيناريوهات المخزن الرئيسي الاحتياطية. فيما يلي بعض الأمثلة عن هذه سيناريوهات الاحتياطي هذه:

    - لا يمكن الوصول إلى مساحة التخزين في المخزن الرئيسي.
    - لم يتم العثور علي شهادة في مساحة التخزين في المخزن الرئيسي.
    - نقطه البيع قيد التشغيل في وضع عدم الاتصال.

- استخدام الشهادات المحلية بدون تخزينها في المخزن الرئيسي (علي سبيل المثال، في تثبيت محلي).
- قم بتحديث تدريجي للشهادات، حيث يتم استخدام إصدار جديد من الشهادة فقط في المتاجر أو علي الوحدات الطرفية التي يكون فيها الإصدار الجديد متاحا بالفعل.
- استخدم نفس الشهادة في العديد من الشركات.

## <a name="set-up-certificate-profiles"></a>إعداد ملفات تعريف الشهادات

يوضح الاجراء التالي كيفيه اعداد ملفات تعريف الشهادات.

### <a name="set-up-key-vault"></a>إعداد المخزن الرئيسي

يجب إكمال الخطوات التالية قبل أن تتمكن من استخدام شهادة رقمية مخزنة في المخزن الرئيسي.

1. قم بإنشاء حساب تخزين في المخزن الرئيسي. نوصي بنشر حساب التخزين في نفس المنطقة الجغرافية بمثابة Commerce Scale Unit.
1. قم بتحميل الشهادة الرقمية إلى حساب تخزين المخزن الرئيسي.
1. قم بتفويض تطبيق Application Object Server (AOS) لقراءة الأسرار من حساب تخزين المخزن الرئيسي.

لمزيد من المعلومات حول كيفيه العمل مع المخزن الرئيسي، راجع [الشروع في العمل مع المخزن الرئيسي لـ Azure](/azure/key-vault/key-vault-get-started).

### <a name="set-up-system-parameters"></a>إعداد محددات النظام

قبل تكوين ملفات تعريف الشهادة في قنوات التجارة، يجب تمكين Commerce لاستخدام كل من الشهادات المخزنة في المخزن الرئيسي وملفات تعريف الشهادات.

لإعداد مُعلمات النظام في Commerce headquarters، اتبع هذه الخطوات.

1. في صفحة **معلمات النظام** اضبط الخيار **‏‫استخدام مخزن الشهادات المتقدم‬** على **نعم**.
1. في مساحة عمل **أداره الميزات** قم بتشغيل ميزة **ملفات تعريف الشهادات المعرفة من قبل المستخدم لمخازن البيع بالتجزئة**.

### <a name="set-up-key-vault-parameters"></a>إعداد معلمات المخزن الرئيسي

في صفحة **معلمات المخزن الرئيس** يجب عليك تحديد المعلمات التالية للوصول إلى تخزين المخزن الرئيسي:

- **الاسم** **والوصف** – اسم ووصف حساب تخزين المخزن الرئيسي.
- **عنوان URL للمخزن الرئيسي** – عنوان URL الخاص بحساب تخزين المخزن الرئيسي.
- **عميل المخزن الرئيسي** – معرّف العميل التفاعلي لتطبيق Azure Active Directory (Azure AD) المرتبط بتخزين المخزن الرئيسي لأغراض المصادقة. يجب أن يكون لهذا العميل حق الوصول لقراءة الأسرار من حساب التخزين.
- **مفتاح سر Key Vault** – مفتاح السر مرتبط بتطبيق Azure AD المستخدم للمصادقة في حساب تخزين المخزن الرئيسي.
- **الاسم** **والوصف** **والمرجع السري** – الاسم والوصف والمرجع السري للشهادة.

لمزيد من المعلومات، راجع [إعداد عميل Azure Key Vault](../../finance/localizations/setting-up-azure-key-vault-client.md).

### <a name="configure-a-certificate-profile"></a>تكوين ملف تعريف الشهادة

لتكوين ملف تعريف شهادة في Commerce headquarters، اتبع هذه الخطوات.

1. انتقل إلى **إدارة النظام \> الإعداد \> ملفات تعريف الشهادات**.
1. في جزء الإجراءات، حدد **جديد** لإنشاء سجل.
1. أدخل القيم في حقول **ملف تعريف الشهادة** **والاسم** **والوصف**.

    > [!NOTE]
    > ملف تعريف الشهادة هو معرف فريد لأحدي الشهادات عبر كافة الشركات ومكونات التجارة.

1. على علامة التبويب السريعة **الكيانات القانونية** حدد **إضافة** لإضافة بند.
1. ضمن **الكيان القانوني** حدد الكيان القانوني (الشركة) الذي يجب استخدام ملف تعريف الشهادة الحالية له.

    إذا كان يجب استخدام ملف تعريف الشهادة للعديد من الكيانات القانونية، فكرر الخطوتين 4 و 5 لإضافة بند لكل كيان قانوني إضافي.

1. حدد **الإعدادات** لفتح صفحه **إعدادات ملف تعريف الشهادات** حيث يمكنك إدخال إعدادات خاصه بالشركة لملف تعريف الشهادات. حدد الشهادات التي يمكن استخدامها عند استدعاء ملف تعريف الشهادات الحالي في قنوات Commerce‬. أضف العديد من الشهادات المطلوبة وعيّن الأولويات لها. إذا كانت الشهادة التي لها أولوية أعلى غير متوفرة، فسيتم استخدام الشهادة التالية، بناءً على الأولوية. لمزيد من المعلومات ، راجع قسم [سير العمل: البحث عن الشهادات في Commerce Runtime](#workflow-searching-certificates-in-the-commerce-runtime).

    > [!NOTE]
    > يتم تعيين حقل **الأولوية** تلقائيا. وتمثل القيمة **1** اعلي اولويه. عند أضافه سطر جديد في صفحه **إعدادات ملف تعريف الشهادات** يتم تعيين الاولويه الخاصة به إلى رقم يكون واحدا أو أكثر من اولويه السطر السابق. لتغيير الاولويه لبند معين، حدد البند، ثم حدد اما **التحرك لاعلي** لزيادة الاولويه أو **التحرك لأسفل** لتقليل الاولويه.

1. عند إضافه بند جديد إلى صفحة **إعدادات ملف تعريف الشهادة** قم بتعيين الحقول التالية:

    - **نوع الموقع** – حدد الموقع الذي تم تخزين الشهادة فيه. يشتمل هذا الحقل علي قيمتين محتملتين: **الشهادة المحلية** **والمخزن الرئيسي**.
    - **شهادة المخزن الرئيسي** -هذا الحقل مطلوب إذا قمت بتعيين **حقل نوع الموقع** إلى **المخزن الرئيسي**. يتم استخدام ذلك لتعيين كلمه سر لشهادة المخزن الرئيسي.
    - **اسم المتجر** – هذا الحقل اختياري ولا يتوفر الا إذا قمت بتعيين حقل **نوع الموقع** إلى **شهادة محليه**. يتم استخدام ذلك لتحديد اسم المتجر الافتراضي الذي يجب استخدامه للبحث في الشهادات المحلية.
    - **موقع المتجر** – هذا الحقل اختياري ولا يتوفر الا إذا قمت بتعيين حقل **نوع الموقع** إلى **شهادة محليه**. يتم استخدام ذلك لتحديد موقع المتجر الافتراضي الذي يجب استخدامه للبحث في الشهادات المحلية.

        > [!NOTE]
        > تتم أضافه اسم المتجر وموقع التخزين الافتراضيين لتبسيط عمليه البحث عن الشهادات المحلية في Commerce Runtime. يتضمن X509StoreProvider قائمه بالمجلدات التي يتم تخزين الشهادات بها. إذا لم يتم تحديد اسم المتجر الافتراضي وموقع المتجر الافتراضي، فإن X509StoreProvider يحاول العثور علي شهادة في المجلدات الأخرى في القائمة الخاصة به. لمزيد من المعلومات حول القيم المتوفرة لاسم المتجر وموقع المتجر، راجع [StoreName Enum](/dotnet/api/system.security.cryptography.x509certificates.storename) و [StoreLocation Enum](//dotnet/api/system.security.cryptography.x509certificates.storelocation)

    - **بصمة الإبهام** – هذا الحقل مطلوب ولا يتوفر إلا إذا قمت بتعيين حقل **نوع الموقع** على **شهادة محليه**. استخدمه لتحديد بصمه إبهام الشهادة.

        > [!IMPORTANT]
        > يجب عليك التأكد من أن المستخدم الذي يقوم بتشغيل التطبيق الذي يجب أن يستخدم الشهادة المحلية (على سبيل المثال، نقطة البيع الحديثة في الوضع غير المتصل) لديه حق الوصول للقراءة فقط على الأقل إلى المفتاح الخاص للشهادة.

    - **التعليقات** – هذا الحقل اختياري ويتيح للمستخدمين إدخال الملاحظات.

## <a name="workflow-searching-certificates-in-the-commerce-runtime"></a>سير العمل: البحث في الشهادات في Commerce Runtime

وفيما يلي سير العمل الأساسي الذي يستخدم للبحث عن أحدي الشهادات عند استدعاء ملف تعريف الشهادة في Commerce Runtime.

1. يحدد النظام ما إذا كان ملف تعريف الشهادة يحتوي علي إعدادات خاصه بالشركة للكيان القانوني الحالي.
1. ويحاول النظام العثور علي الشهادة باستخدام القيم الموجودة في صفحة **إعدادات ملف تعريف الشهادة** للبند حيث تم تعيين الحقل **الأولولية** إلى **1**.

    - إذا تم تعيين حقل **نوع الموقع** إلى **مخزن رئيسي**، سيتم استخدام قيمه الحقل **سر شهادة المخزن الرئيسي** للبحث عن الشهادة في الصفحة **معلمات المخزن الرئيسي**. يتم بعد ذلك البحث عن الشهادة في مساحة تخزين المخزن الرئيسي.
    - إذا تم تعيين الحقل **نوع الموقع** إلى **الشهادة المحلية**، يقوم X509StoreProvider أولا بالبحث عن الشهادة باستخدام اسم المتجر وموقع المتجر الافتراضي، في حاله تحديد هذه المعلمات. ثم يبحث في كافة المجلدات الأخرى الموجودة علي قائمه المجلدات الخاصة به.

1. في حاله عدم العثور علي الشهادة، يتم تكرار العملية للسطر حيث تم إعداد الحقل **الأولولية** على **2**، وهكذا.

> [!NOTE]
> إذا لم يكن لملف تعريف الشهادة إعدادات للكيان القانوني الحالي ، أو في حاله عدم نجاح البحث عن الشهادات لكافة السطور في صفحه **إعدادات ملف تعريف الشهادة** لا يتم العثور علي الشهادة.

### <a name="caching-the-results-of-certificate-searches"></a>التخزين المؤقت لنتائج عمليات البحث في الشهادات

تم التخزين المؤقت لنتائج عمليات البحث في الشهادات. يكون وقت انتهاء الصلاحية الافتراضي لذاكره التخزين المؤقت ساعة واحده. ومع ذلك، يمكن تخصيص هذا الوقت وتعيينه إلى الحد الأقصى لقيمه 24 ساعة.

## <a name="gradual-update"></a>تحديث تدريجي

في حاله تقديم إصدار جديد من الشهادة، وعدم امكانيه تحديثها في كافة المتاجر في نفس الوقت، تقوم وظيفة ملفات تعريف الشهادات بتمكين تحديث الشهادة تدريجيا.

1. البحث عن ملف تعريف الشهادة والبند الذي يجب تحديثه ، ثم تحديد **الإعدادات**.
1. قم باضافه بند، وحدد الإعدادات المرتبطة بأحدث إصدار من الشهادة.
1. قم بزيادة قيمه **الاولويه** للسطر الجديد. استخدم الزر **تحريك لاعلي** لتحريك الخط بحيث يكون فوق السطر الخاص بالإصدار السابق لنفس الشهادة.
> [!NOTE]
> في Commerce Runtime، يتم استدعاء الإصدار الجديد من الشهادة أولا. إذا لم يتم تحديث الشهادة بعد ذلك في متجر معين أو في وحده طرفيه معينه، سيتم استدعاء الإصدار السابق.


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
