---
title: عرض بيانات الكيان وتحديثها باستخدام Excel
description: يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel, ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics لوظيفة Excel الإضافية.
author: jasongre
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: a39dbdcae29df5e838673dc1fe77ae7e76ebfc86
ms.sourcegitcommit: 34b478f175348d99df4f2f0c2f6c0c21b6b2660a
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/16/2021
ms.locfileid: "5908331"
---
# <a name="view-and-update-entity-data-with-excel"></a>عرض بيانات الكيان وتحديثها باستخدام Excel 

[!include [applies to](../includes/applies-to-commerce-finance-scm.md)]

[!include [banner](../includes/banner.md)]


يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel, ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics لوظيفة Excel الإضافية. لفتح كيان البيانات، يمكنك البدء إما من Excel أو من تطبيقات Finance and Operations.

من خلال فتح بيانات الكيان في Excel، يمكنك أن تقوم بسرعة وسهولة بعرض وتحرير البيانات باستخدام وظيفة Excel الإضافية. هذه الوظيفة الإضافية برنامج Microsoft Excel 2016 أو أحدث.

> [!NOTE]
> إذا تم تكوين مستأجر Microsoft Azure Active Directory (Azure AD) لاستخدام خدمات الأمان المشترك لـ Active Directory‬ (أو AD FS)، فيجب التأكد من تطبيق تحديث مايو 2016 لـ Office، لتمكين وظيفة Excel الإضافية من تسجيل دخولك بشكل صحيح.

لمزيد من المعلومات حول استخدام وظيفة Excel الإضافية، شاهد الفيديو القصير [إنشاء قالب Excel لأنماط الرؤوس والبنود](https://youtu.be/RTicLb-6dbI) .

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من تطبيق Finance and Operations
1. في صفحة في تطبيق Finance and Operations، حدد **فتح في Microsoft Office**.

    إذا كان مصدر البيانات الجذر (الجدول) للصفحة هو نفسه مصدر البيانات الجذر لأي كيانات، فسيتم إنشاء خيارات **فتح في Excel** الافتراضية للصفحة. يمكن العثور على خيارات **فتح في Excel** على الصفحات المستخدمة بشكل متكرر، مثل **كافة الموردين** و **كافة العملاء**.
 
2. حدد أحد خيارات **فتح في Excel**، وافتح المصنف الذي يتم إنشاؤه. يحتوي هذا المصنف على معلومات ربط للكيان ومؤشر إلى بيئتك ومؤشر إلى وظيفة Excel الإضافية.
3. في Excel، حدد **تمكين التحرير** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4. إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية**.
5. في حالة مطالبتك بتسجيل الدخول، حدد **تسجيل الدخول**، وبعد ذلك سجّل الدخول باستخدام نفس بيانات الاعتماد التي استخدمتها لتسجيل الدخول إلى تطبيق Finance and Operations. سوف تستخدم وظيفة Excel الإضافية سياق تسجيل الدخول السابق من المستعرض وتسجّل دخولك تلقائيًا إليها، إذا أمكنها ذلك. (للحصول علي معلومات حول المستعرض الذي يتم استخدامه استنادا إلى نظام التشغيل، راجع [المستعرضات التي تستخدمها وظائف Office الإضافية](/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.)للتاكد من نجاح تسجيل الدخول، تحقق من اسم المستخدم في الركن الأيسر العلوي لوظيفة Excel الإضافية. 

تقرأ وظيفة Excel الإضافية بشكل تلقائي البيانات للكيان الذي قمت بتحديده. لاحظ أن المصنف لن يتضمن أي بيانات إلى أن تقوم وظيفة Excel الإضافية بقراءتها فيه.

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من Excel
1. في Excel، على علامة التبويب **إدراج**، في مجموعة **الوظائف الإضافية**، حدد **متجر** لفتح متجر Office.
2. في متجر Office، ابحث عن الكلمة الأساسية **Dynamics**، ثم حدد **إضافة‏‎** إلى جانب **وظيفة Microsoft Dynamics Office الإضافية** (وظيفة Excel الإضافية).
3. إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4. حدد **إضافة معلومات الخادم** لفتح الجزء **خيارات**.
5. في المستعرض، انسخ عنوان URL لمثيل تطبيق Finance and Operations الهدف، والصقه في حقل **عنوان URL للخادم**، ثم احذف كل شيء بعد اسم المضيف. يجب أن يتضمن عنوان URL الناتج فقط اسم المضيف.

    على سبيل المثال، إذا كان عنوان URL `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`، فاحذف كل شيء باستثناء `https://xxx.dynamics.com`.

6. حدد **موافق**، ثم حدد **نعم** لتأكيد التغيير. يبدأ تشغيل وظيفة Excel الإضافية من جديد وتقوم بتحميل بيانات التعريف.

    يتوفر الآن الزر **تصميم**. إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬**، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لمزيد من المعلومات، راجع "ظهور زر تحميل البرامج" في قسم [استكشاف الأخطاء وإصلاحها](../office-integration/use-excel-add-in.md#troubleshooting) في هذا الموضوع.

7. حدد **تصميم**. تقوم وظيفة Excel الإضافية باسترداد بيانات تعريف الكيان.
8. حدد **إضافة جدول**. تظهر قائمة بالكيانات. تكون الكيانات مدرجة بصيغة "الاسم - التسمية".
9. حدد كيانًا في القائمة، مثل **العميل-العملاء**، ثم حدد **التالي**.
10. لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**. بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.
11. بعد أن تنتهي من إضافة الحقول المطلوبة إلى قائمة **الحقول المحددة**، تأكد من وجود المؤشر في المكان الصحيح في ورقة العمل (على سبيل المثال، الخلية A1)، ثم حدد **تم**. بعد ذلك، حدد **تم** لإغلاق المصمم.
12. حدد **تحديث** لسحب مجموعة من البيانات.

## <a name="view-and-update-entity-data-in-excel"></a>عرض بيانات الكيان وتحديثها في Excel
بعد أن تقوم وظيفة Excel الإضافية بقراءة بيانات الكيان في المصنف، يمكنك تحديث البيانات في أي وقت بتحديد **تحديث** في وظيفة Excel الإضافية.

## <a name="edit-entity-data-in-excel"></a>تحرير بيانات الكيان في Excel
يمكنك تغيير بيانات الكيان وفق احتياجاتك، ثم إعادة نشرها في تطبيقات Finance and Operations بتحديد **نشر** في وظيفة Excel الإضافية. لتحرير سجل، حدد خلية في ورقة العمل ثم قم بتغيير قيمة الخلية. لإضافة سجل جديد، اتبع إحدى الخطوات التالية:

- انقر في أي مكان في جدول مصادر البيانات، ثم حدد **جديد** في وظيفة Excel الإضافية.
- انقر بأي مكان في الصف الأخير من جدول مصادر البيانات، ثم اضغط المفتاح Tab حتى خروج المؤشر من العمود الأخير لذلك الصف وإنشاء صف جديد.
- انقر بأي مكان في الصف مباشرة أسفل جدول مصادر البيانات، وابدأ إدخال بيانات في خلية. عند نقل التركيز من هذه الخلية، يتوسع الجدول لتضمين الصف الجديد.
- فيما يتعلق بروابط الحقول لسجلات الرأس، حدد أحد الحقول، ثم حدد **جديد** في وظيفة Excel الإضافية.

لاحظ أنه يمكن إنشاء سجل جديد فقط إذا كانت كافة الحقول الأساسية والإلزامي مرتبطة في ورقة العمل، أو إذا تم إدخال القيم الافتراضية باستخدام شرط عامل التصفية.

لحذف سجل، اتبع إحدى الخطوات التالية:

- انقر بزر الماوس الأيمن فوق رقم الصف الموجود بجانب صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف**.
- انقر بزر الماوس الأيمن في أي مكان في صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف** &gt; **صفوف الجدول**.

إذا تمت إضافة مصادر البيانات على أنها مصادر بيانات مرتبطة، فسيتم نشر الرأس قبل البنود. في حال وجود تبعيات بين مصادر بيانات الأخرى، قد تحتاج إلى تغيير أمر النشر الافتراضي. ‏‫لتغيير أمر النشر، في وظيفة Excel الإضافية، حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة **موصل البيانات**، حدد **تكوين أمر نشر‬**.

## <a name="add-or-remove-columns"></a>إضافة الأعمدة أو إزالتها
يمكنك استخدام المصمم لضبط الأعمدة التي تُضاف تلقائيًا إلى ورقة العمل.

> [!NOTE]
> إذا كان زر **التصميم** لا يظهر أسفل زر **عامل التصفية** في وظيفة Excel الإضافية، يجب تمكين مصمم مصدر البيانات. حدد الزر **خيارات** (رمز الترس)، ثم حدد خانة الاختيار **تمكين التصميم**.

1. في وظيفة Excel الإضافية، حدد **تصميم**. يتم سرد كافة مصادر البيانات.
2. إلى جانب مصدر البيانات، حدد الزر **تحرير** (رمز القلم).
3. في قائمة **الحقول المحددة**، اضبط قائمة الحقول وفق احتياجاتك:

    - لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**. بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.
    - لإزالة حقل من قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إزالة**. أو انقر نقرًا مزدوجًا فوق الحقل.
    - لتغيير ترتيب الحقول في قائمة **الحقول المحددة**، حدد حقل، ثم حدد **أعلى** أو **أسفل**.

4. لتطبيق التغييرات على مصدر البيانات، حدد **تحديث**. بعد ذلك، حدد **تم** لإغلاق المصمم.
5. إذا قمت بإضافة حقل (عمود)، فحدد **تحديث** لسحب مجموعة محدّثة من البيانات.

## <a name="change-the-publish-batch-size"></a>تغيير حجم دفعه النشر
عند قيام المستخدمين بنشر التغييرات علي سجلات البيانات باستخدام وظيفة Excel الإضافية، يتم إرسال التحديثات في مجموعات. يكون حجم دفعه النشر الافتراضي 100 صفا. في الإصدار 10.0.17 والإصدارات الأحدث، توفر لك ميزة **السماح بتكوين حجم الدفعة الإضافية للنشر في وظيفة Excel الإضافية** تحكما مرنا في حجم دفعه النشر.

يمكن لمسؤولي النظام تحديد حد واسع النظام علي المصنف "فتح في Excel" وذلك بإعداد الحقل **الحد من مجموعه الدفعات** في قسم **معلمات التطبيق** في الصفحة **معلمات تطبيق Office**.

يمكن أيضا تغيير حجم دفعه النشر لمصنف فردي باستخدام وظيفة Excel الإضافية.

1. افتح المصنف في Excel.
2. حدد زر **الإعدادات** (أيقونة الترس) في الركن العلوي الأيسر من وظيفة Excel الإضافية.
3. قم بتعيين حقل **حجم دفعه النشر** حسب الرغبة. يجب ان تكون القيمة التي قمت بتعيينها اقل من حد مجموعه النشر علي مستوي النظام.
4. حدد **موافق**.
5. احفظ المصنف. إذا لم تقم بحفظ المصنف بعد اجراء تغييرات علي إعدادات الوظيفة الإضافية، لن تستمر هذه التغييرات عند أعاده فتح المصنف.

يمكن لمؤلفي قوالب مصنف Excel استخدام نفس الاجراء لتعيين حجم مجموعه النشر للقوالب قبل قيامهم بتحميلها إلى النظام.

## <a name="copy-environment-data"></a>نسخ بيانات البيئة

يمكن نسخ البيانات التي تتم قراءتها في المصنف من بيئة إلى بيئة أخرى. مع ذلك، لا يمكنك تغيير عنوان URL الاتصال فحسب، نظرًا لأن ذاكرة التخزين المؤقت للبيانات في المصنف ستستمر في التعامل مع البيانات كبيانات موجودة. بدلاً من ذلك، يجب استخدام وظيفة نسخ بيانات البيئة‬ لنشر البيانات إلى بيئة جديدة كبيانات جديدة.

1. حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة‬ **‏‫موصل البيانات‬**، حدد **نسخ بيانات البيئة‬**. 
2. أدخل عنوان URL للخادم لبيئة جديدة. 
3. حدد **موافق**، ثم حدد **نعم** لتأكيد الإجراء. ‏‫يبدأ تشغيل وظيفة Excel الإضافية من جديد وتتصل بالبيئة الجديدة. يتم التعامل مع أية بيانات موجودة في المصنف كبيانات جديدة.

    بعد إعادة تشغيل وظيفة Excel الإضافية، يظهر مربع رسالة يفيد بأن المصنف موجود في وضع نسخة البيئة.

4. لنسخ البيانات إلى البيئة الجديدة كبيانات جديدة، حدد **نشر**. لإلغاء عملية نسخ البيئة ومراجعة البيانات الموجودة في البيئة الجديدة، حدد **تحديث**.

## <a name="troubleshooting"></a>استكشاف الأخطاء وإصلاحها
هناك بعض المشاكل التي يمكن حلها من خلال بعض الخطوات السهلة.

- **‬‏‫ظهور زر تحميل البرامج** - إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬** بعد تسجيل الدخول، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.
- **‬‏‫تلقيت رسالة "ممنوع"** – إذا تلقيت رسالة "ممنوع" أثناء قيام وظيفة Excel الإضافية بتحميل بيانات التعريف، فهذا يعني أن الحساب الذي سجل دخوله إلى وظيفة Excel الإضافية لا يملك الأذونات الكافية لاستخدام الخدمة أو المثيل أو قاعدة البيانات المستهدفة. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.
- **‬‏‫ظهور صفحة ويب فارغة على Excel** – إذا تم فتح صفحة ويب فارغة أثناء عملية تسجيل الدخول، فهذا يعني أن الحساب يحتاج إلى AD FS، ولكن إصدار وظيفة Excel الإضافية الذي يقوم بتشغيل الوظيفة الإضافية ليس حديثًا بشكل كافٍ لكي يتمكن من تحميل مربع حوار تسجيل الدخول. لحل هذه المشكلة، قم بتحديث إصدار Excel الذي تستخدمه. لتحديث إصدار Excel عندما تكون في مؤسسة موجودة على القناة المؤجلة، استخدم [أداة نشر Office](/deployoffice/overview-office-deployment-tool) من أجل [الانتقال من القناة المؤجلة إلى القناة الحالية](/deployoffice/overview-update-channels).
- **تتلقي مهله اثناء نشر تغييرات البيانات** – إذا تلقيت رسائل المهلة اثناء محاولة نشر تغييرات البيانات إلى أحد الكيانات، خذ بعين الاعتبار تقليل حجم الدفعة النشر للمصنف المتاثر. قد تتطلب الكيانات التي تقوم بتشغيل قدر أكبر من المنطق في تغييرات السجلات إرسال تحديثات في مجموعات أصغر للمساعدة علي منع المهلات.


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
