---
title: إضافه حقول جديده إلى قالب مستند عمل في Microsoft Excel
description: يوفر هذا الموضوع معلومات حول كيفيه أضافه حقول جديده إلى قالب مستند عمل في Microsoft Excel باستخدام ميزه أداره مستندات العمل.
author: NickSelin
ms.date: 11/15/2019
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERBDWorkspace, ERBDParameters, ERBDTemplateEditor
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2019-10-01
ms.dyn365.ops.version: 10.0.7
ms.openlocfilehash: 991fe4ea56a2726c5df835cfc90a390cef2d5df5
ms.sourcegitcommit: 074b6e212d19dd5d84881d1cdd096611a18c207f
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 03/31/2021
ms.locfileid: "5751120"
---
# <a name="add-new-fields-to-a-business-document-template-in-microsoft-excel"></a>إضافه حقول جديده إلى قالب مستند عمل في Microsoft Excel

[!include[banner](../includes/banner.md)]

يمكنك أضافه حقول جديده إلى قالب يستخدم لإنشاء مستندات الاعمال بتنسيق Microsoft Excel. يمكن أضافه هذه الحقول كعناصر نائبه يتم استخدامها لملء المستندات التي تم إنشاؤها بالمعلومات المطلوبة من التطبيق. بالنسبة لكل حقل تقوم بإضافته ، يمكنك أيضا تحديد ربط لمصادر البيانات ، لتحديد بيانات التطبيق التي سيتم إدخالها في الحقل عند استخدام القالب لإنشاء مستندات الاعمال.

لمعرفة المزيد حول هذه الميزة، أكمل المثال في هذا الموضوع. يوضح هذا المثال كيفيه تحديث قالب لملء الحقول في نماذج فواتير النص الحر التي يتم إنشاؤها.

## <a name="configure-business-document-management-to-edit-templates"></a>تكوين إدارة مستندات الأعمال لتحرير القوالب

نظرا لان أداره مستندات العمل (BDM) مبنيه على اطار عمل [النظرة العامة على التقارير الكترونيه (ER)](general-electronic-reporting.md) ، يجب ان تقوم بتكوين معلمات التقاريرالإللكترونية ومعلمات BDM المطلوبة قبل ان تتمكن من البدء في العمل باستخدام BDM.

1.  سجل الدخول إلى مثيل Microsoft Dynamics 365 Finance كمسؤول النظام.
2.  أكمل الخطوات التالية للمثال الموجود في الموضوع [نظره عامه على أداره مستندات الاعمال](er-business-document-management.md):

    1.  قم بتكوين معلمات التقارير الإلكترونية.
    2.  قم بتشغيل BDM.

يمكنك الآن بدء استخدام BDM لتحرير قوالب مستندات العمل.

## <a name="import-er-solutions-that-contain-a-template"></a>استيراد حلول التقارير الإلكترونية التي تحتوي على قالب

يستخدم المثال في هذا الإجراء حل التقارير الإلكترونية الذي تم نشره رسميا. يجب استيراد تكوينات التقارير الإلكترونية الخاصة بهذا الحل إلى المثيل الحالي لـ Finance.

يحتوي تكوين تنسيق التقارير الإلكترونية **فاتورة النص الحر (Excel)** لهذا الحل على قالب مستند العمل الموجود في تنسيق Excel الذي يمكن تحريره باستخدام BDM. قم باستيراد أحدث إصدار من تكوين تنسيق التقارير الإلكترونية هذا من Microsoft Dynamics Lifecycle Service (LCS). سيتم استيراد نموذج بيانات التقارير الإلكترونية المقابل وتكوينات تعيينات نماذج التقارير الإلكترونية تلقائيا.

لمزيد من المعلومات حول كيفية استيراد تكوينات التقارير الإلكترونية، راجع [إدارة دورة حياة تكوينات التقارير الإلكترونية](general-electronic-reporting-manage-configuration-lifecycle.md).

![صفحة مكتبة الأصول المشتركة لـ LCS](./media/BDM-AddFldExcel-LCS.png)

### <a name="edit-the-er-solution-template"></a>تحرير قالب حل التقارير الإلكترونية

1.  سجل دخولك كمستخدم لديه حق الوصول إلى مساحة عمل **إدارة مستندات الأعمال**.
2.  افتح مساحة عمل **إدارة مستندات الأعمال**.

    ![مساحة عمل إدارة مستندات الأعمال](./media/BDM-AddFldExcel-Workspace.png)

3.  في الشبكة، حدد قالب **فاتورة النص الحر (Excel)**.
4.  في الجزء الأيسر، حدد **قالب جديد** لإنشاء قالب جديد يستند إلى القالب المحدد.
5.  في حقل **العنوان**، أدخل **فاتورة النص الحر (Excel) لـ Contoso** كعنوان للقالب الجديد.
6.  حدد **موافق** لتأكيد بدء عملية التحرير.

تظهر صفحة محرر قالب BDM. يمكنك استخدام Microsoft 365 لتحرير القالب المحدد عبر الإنترنت في عنصر التحكم المضمن.

![صفحة محرر قالب BDM](./media/BDM-AddFldExcel-EditableTemplate.png)

### <a name="add-the-label-for-a-new-field-to-the-template"></a>إضافه التسمية لحقل جديد إلى القالب

1.  في صفحة "محرر قالب BDM"، ضمن شريط Excel، في علامة التبويب **طريقة العرض**، حدد خانات الاختيار **العناوين وخطوط الشبكات** لقالب Excel القابل للتحرير.

    ![خانات اختيار العناوين وخطوط الشبكة المحددة](./media/BDM-AddFldExcel-EditableTemplate2.png)

2.  حدد الخلايا **E8:F8**.
3.  على شريط Excel، في علامة التبويب **الصفحة الرئيسية**، حدد **الدمج والمركز** لدمج الخلايا المحددة في خلية **E8:F8** مدمجة جديدة.
4.  في الخلية المدمجة **E8:F8**، أدخل **URL**.
5.  حدد الخلية المدمجة **E7:F7**، حدد **رسام التنسيق**، ثم حدد الخلية المدمجة **E8:F8** لتنسيقها بنفس الطريقة مثل الخلية المدمجة **E7:F7**.

    ![إضافه تسمية الحقل الجديد إلى القالب](./media/BDM-AddFldExcel-EditableTemplate3.png)

### <a name="format-the-template-to-reserve-space-for-a-new-field"></a>تنسيق القالب لحجز مساحة لحقل جديد

1.  في صفحة محرر قالب BDM، حدد الخلية المدمجة **G8:H8**.
2.  على شريط Excel، في علامة التبويب **الصفحة الرئيسية**، حدد **الدمج والمركز** لدمج الخلايا المحددة في خلية **G8:H8** مدمجة جديدة.
3.  حدد الخلية المدمجة **G7:H7**، حدد **رسام التنسيق**، ثم حدد الخلية المدمجة **G8:H8** لتنسيقها بنفس الطريقة مثل الخلية المدمجة **G7:H7**.

    ![المساحة المحجوزة للحقل الجديد](./media/BDM-AddFldExcel-EditableTemplate4.png)

4.  في حقل مربع **الاسم**، حدد **CompanyInfo**.

    يحتفظ نطاق **CompanyInfo** الخاص بقالب Excel الحالي بكافة الحقول المستخدمة لملء راس التقرير الذي تم إنشاؤه بتفاصيل الشركة الحالية كطرف البائع.

    ![نطاق CompanyInfo المحدد](./media/BDM-AddFldExcel-SelectCompanyInfoRange.png)

### <a name="add-a-new-field-to-the-template"></a>إضافة حقل جديد إلى القالب

1.  في صفحة **محرر قالب BDM**، ضمن جزء الإجراء، حدد **إظهار التنسيق**.
2.  في جزء **بنية القالب**، حدد **إضافة**.

    > [!NOTE]
    > يجب عليك تعديل القسم من القالب الذي تريد استخدامه كحقل جديد. لقد قمت بالفعل بهذا التعديل عن طريق تنسيق الخلية المدمجة **G8:H8**.

    ![إضافة حقل جديد إلى القالب](./media/BDM-AddFldExcel-AddCell.png)

3.  حدد **Excel/خلية** لأضافه حقل جديد كخليه في القالب.

    يمكنك تحديد **Excel/نطاق** إذا كنت ترغب في أضافه نطاق جديد إلى القالب. يمكن ان يحتوي النطاق الذي يتم إدخاله على خلايا متعددة. يمكنك أضافة هذه الخلايا لاحقا.
    
    ولاحظ أن مكون قالب **CompanyInfo** يتم تحديده تلقائيا في جزء **بنية القالب**، نظرا لأنه المكون الأصلي الأكثر ملائمة في بنيه القالب الحالي للحقل الذي تقوم بإضافته.
    
4.  في حقل **نطاق Excel**، أدخل **CompanyURL_Value**.
5.  حدد **موافق**.

    ![إضافة حقل CompanyURL_Value إلى بنية القالب](./media/BDM-AddFldExcel-EditableTemplate5.png)

6.  في جزء **بنية القالب**، حدد زر علامة الحذف (...)، ثم حدد **إظهار الروابط**.

    ![إظهار الروابط المحددة](./media/BDM-AddFldExcel-ShowBindings.png)

    يعرض جزء **بنيه القالب** الآن مصادر البيانات المتوفرة في التنسيق الأساسي للتقارير الإلكترونية.

7.  حدد **CompanyInfo_Value** كالحقل الذي تخطط لربطه بمصدر بيانات بتنسيق التقارير الإلكترونية الأساسي.
8.  في قسم **مصادر البيانات** في جزء **بنية القالب**، قم بتوسيع **النموذج \> InvoiceBase \> CompanyInfo**.
9.  ضمن **CompanyInfo**، حدد عنصر **WebsiteURI**.

    ![عنصر WebsiteURI المحدد](./media/BDM-AddFldExcel-BindURL.png)

10. حدد **ربط**.
11. في جزء **بنيه القالب**، حدد **حفظ**، ثم اغلق صفحة محرر قالب BDM.

في مساحة عمل **إدارة مستندات الأعمال**، تعرض علامة التبويب **القالب** في الجزء الأيسر القالب المحدث. في الشبكة، لاحظ أن حقل **الحالة** للقالب المحرر تم تغييره إلى إلى **مسودة**، ولم يُعد حقل **المراجعة** فارغًا. تشير هذه التغييرات إلى أن عملية تحرير هذا القالب قد بدأت.

![القالب المحرر في مساحة عمل إدارة مستندات العمل](./media/BDM-AddFldExcel-Workspace2.png)

## <a name="review-company-settings"></a>مراجعة إعدادات الشركة

1.  انتقل إلى **إدارة المؤسسة \> المؤسسات \> الكيانات القانونية**.
2.  في علامة التبويب السريع **معلومات جهة الاتصال**، تحقق من إدخال عنوان URL الخاص بالشركة.

![عنوان URL للشركة الذي تم إدخاله في صفحة الكيانات القانونية](./media/BDM-AddFldExcel-CompanyInfo.png)

## <a name="generate-business-documents-to-test-the-updated-template"></a>إنشاء مستندات الأعمال لاختبار القالب المحدث

1.  في التطبيق، قم بتغيير الشركة إلى **USMF**، وانتقل إلى **الحسابات المدينة \> الفواتير\> كل فواتير النص الحر**.
2.  حدد الفاتورة **FTI-00000002**، ثم حدد **إدارة الطباعة**.
3.  في الجزء الأيمن، قم بتوسيع **الوحدة - الحسابات المدينة\> المستندات\> فاتورة النص الحر**.
4.  ضمن **فاتورة النص الحر**، حدد مستوى **النص الأصلي** لتحديد نطاق الفواتير للمعالجة.
5.  في الجزء الأيسر، في حقل **تنسيق التقرير**، حدد **فاتورة النص الحر (Excel) لـ Contoso** لمستوى المستند المحدد.

    ![قالب فاتورة النص الحر (Excel) لشركة Contoso المحدد](./media/BDM-AddFldExcel-PrintMngtSetting.png)

6.  اضغط **Esc** لإغلاق الصفحة الحالية.
7.  حدد **طباعة \> تم التحديد**.
8.  قم بتنزيل المستند الذي تم إنشاؤه، ثم قم بفتحه في Excel.

    ![فاتورة النص الحر بتنسيق Excel](./media/BDM-AddFldExcel-PreviewReport.png)

يتم استخدام القالب المعدل لإنشاء تقرير فاتورة النص الحر للصنف المحدد. لتحليل كيفية تأثر هذا التقرير بالتغييرات التي قمت بإدخالها على القالب، يمكنك تشغيل هذا التقرير في جلسة عمل تطبيق واحدة مباشرة بعد تغيير القالب في جلسة عمل تطبيق أخرى.

## <a name="related-links"></a>الارتباطات‬ ذات الصلة

[نظرة عامة حول التقارير الإلكترونية](general-electronic-reporting.md)

[نظرة عامة على إدارة مستندات الأعمال](er-business-document-management.md)

[تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](tasks/er-design-reports-openxml-2016-11.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]