---
title: تضمين الصور والأشكال في المستندات التي تقوم بإنشائها باستخدام التقارير الإلكترونية
description: يوضح هذا الموضوع كيفية استخدام أداة إعداد التقارير الكترونية لإنشاء مستندات أعمال تحتوي على صور وأشكال مضمنة.
author: NickSelin
ms.date: 04/23/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 27621
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: July 2017 update
ms.openlocfilehash: bfa8137de7b782ba80a0d80c987a96c37b3a7d86
ms.sourcegitcommit: c08a9d19eed1df03f32442ddb65a2adf1473d3b6
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 07/06/2021
ms.locfileid: "6361366"
---
# <a name="embed-images-and-shapes-in-documents-that-you-generate-by-using-er"></a>تضمين الصور والأشكال في المستندات التي تقوم بإنشائها باستخدام التقارير الإلكترونية

[!include [banner](../includes/banner.md)]

يمكنك استخدام أداة إعداد التقارير الإلكترونية (ER) لتصميم التقارير التي يمكنك تشغيلها لإنشاء المستندات الإلكترونية المطلوبة. يمكنك استخدام مستندات Microsoft Excel أو Microsoft Word لتحديد تخطيط التقرير. يتيح مصمم عمليات ER إرفاق مستند Excel أو Word كقالب للتقرير. يتم إقتران العناصر المسماة في القالب المرفق بعناصر التنسيق لتقرير ER. يتم ربط عناصر التنسيق للتقرير بمصادر البيانات. وتحدد هذه العناصر البيانات التي سيتم إدخالها، وقت التشغيل، في المستندات التي تم إنشاؤها.

تتجاوز هذه الوظيفة الجديدة إمكانات ER الموجودة لإنشاء المستندات بتنسيقات Microsoft Office. لمزيد من المعلومات، قم تشغيل أدلة المهام التالية. يمكنك العثور على أدله المهام هذه ضمن عملية الأعمال 7.5.4.3 Acquire/Develop IT service/solution components (10677)

- يعمل تصميم التقارير الإلكترونية على تصميم تكوين لإنشاء التقارير بتنسيق OPENXML
- ER تصميم تكوين لإنشاء التقارير بتنسيق Microsoft WORD

## <a name="embed-an-image-in-an-excel-document"></a>تضمين صورة في مستند Excel

### <a name="embed-an-image-in-an-excel-worksheet"></a>تضمين صورة في ورقة عمل Excel

أولاً، يجب إضافة عنصر نائب للصورة في مستند Excel. فتح مصنف Excel وأضف صورة كعنصر نائب للصورة التي ستقوم بإضافتها فيما بعد. ثم استخدم أداة ER لإضافة تكوين ل تنسيق ER جديد لتضمين التقرير الذي تقوم بتصميمه. قم بإرفاق مصنف Excel كقالب لتنسيق التقرير، ثم قم باستيراد محتوى المصنف إلى تنسيق ER. سيتم إنشاء تعريف التنسيق تلقائيًا. سيتم تضمين العنصر النائب الخاص بالصورة الذي قمت بإضافته في تعريف تنسيق ER كعنصر **CELL**.

> [!NOTE]
> يمكنك تحديد تعريف التنسيق يدويًا بدلاً من استيراده. وعند حفظ التغييرات، سيتم التحقق من صحة التنسيق.

بعد ذلك، قم بربط عنصر **CELL** بتنسيق ER بالحقل من مصدر البيانات الخاص بالتنسيق الذي يوفر بيانات الصورة بالتنسيق الثنائي في وقت التشغيل. عند استخدام نموذج بيانات ER كمصدر بيانات للتنسيق، يجب أن يكون نوع بيانات الحقل [حاوية](er-formula-supported-data-types-composite.md#container). في الوقت الحالي، يمكن ربط حقل نموذج بيانات ER الذي يحتوي على نوع البيانات [حاوية](er-formula-supported-data-types-composite.md#container) بعدة أنواع من مصادر البيانات التي تقوم بإرجاع الصور بتنسيق ثنائي. يمكنك الوصول إلى حقل في جدول بيانات وملف مرفق بسجل جدول البيانات باستخدام إطار عمل إدارة المستندات.

> [!IMPORTANT]
> - إذا كنت ترغب في تعبئة العنصر النائب الخاص بالصورة في المستند الذي تقوم بإنشائه باستخدام قالب Excel ، فيجب أن يحتوي تنسيق ER على عنصر **CELL** الذي يشير إلى عنصر الصورة المسماة في قالب Excel. وبخلاف ذلك، لن يظهر أي عنصر نائب للصورة في إخراج التقرير. إذا لم يرجع ربط العنصر **CELL** أي بيانات في وقت التشغيل، فسيعرض المستند الذي تم إنشاؤه العنصر النائب للصورة من القالب. لإخفاء صورة في المستند الذي تقوم بإنشائه، قم بتعريف عنصر **CELL**، وحدد أن تعبير **التمكين** يجب أن يرجع القيمة **خطأ**.
> - في قالب Excel، استخدم اسمًا فريدًا لكل عنصر. تتضمن هذه العناصر الصور والخلايا. إذا قمت بتكرار اسم عنصر، سيكون محتوى التقرير الذي تم إنشاؤه غامضًا ومحيرًا.

### <a name="embed-images-in-the-header-and-footer-of-an-excel-worksheet"></a>تضمين الصور في رأس وتذييل الصفحة في ورقة عمل Excel

يستخدم مستند مصنف Excel كقالب لتحديد تخطيط التقرير. يمكن أن يحتوي المصنف على أوراق عمل متعددة، ويمكن تصميم كل منها بحيث يكون لها رأس وتذييل. يدعم Excel ثلاثة صور كحد أقصى في رأس وتذييل الصفحة لكل ورقة عمل. يمكن محاذاة الصور إلى اليسار أو اليمين أو الوسط.

في الإصدار 10.0.21 من Finance، يمكنك إدارة صور رأس وتذييل الصفحة التي يتم إنشاؤها بواسطة حل ER الذي يحتوي على قالب Excel.

إذا أردت أن تظهر صورة افتراضية في رأس أو تذييل المستند الذي تم إنشاؤه، يمكنك إضافة صورة إلى رأس أو تذييل ورقة العمل الخاصة بقالب ER. للوصول إلى هذه الصورة بتنسيق ER، يجب إضافة مكون **الصورة** الموجود ضمن [الرأس](er-fillable-excel.md#header-component) أو [التذييل](er-fillable-excel.md#footer-component) الخاص بالتنسيق. قم بتكوين محاذاة مكون **الصورة** بالشكل المناسب. 

يمكنك أيضًا استخدام مكون **الصورة** لوضع صورة في رأس أو تذييل المستند الذي تم إنشاؤه في وقت التشغيل، حتى إذا لم يكن القالب يحتوي على صورة افتراضية. لتحديد محتوي الوسائط الذي يجب وضعه في رأس أو تذييل المستند الذي تم إنشاؤه أما كصورة جديدة أو كبديل لصورة افتراضيه، يجب ربط مكون **الصورة** بمصدر بيانات من نوع [حاوية](er-formula-supported-data-types-composite.md#container) والتي تمثل صورة بتنسيق ثنائي.

يمكن أن يحتوي كل مكون **رأس** أو **تذييل** على مكون **صورة** واحد لكل محاذاة مدعومة: **اليسار** و **الوسط** و **اليمين**.

تتيح لك خاصية **تغيير حجم الارتفاع** لكون **الصورة** استخدام الربط المكون للتحكم في حجم الصورة:

- حدد **الأصل** للاحتفاظ بالحجم الأولي للصورة.
- حدد **نسبي** لتغيير حجم ارتفاع الصورة بالنسبة لارتفاع الرأس أو التذييل الذي يحتفظ بهذه الصورة.

    - في هذه الحالة، يجب تعريف ارتفاع الصورة كنسبة مئوية من رأس أو تذييل الصفحة الأصل.
    - إذا تجاوزت قيمه القياس 100 بالمائة، فقد تتداخل الصورة مع منطقة البيانات الخاصة بورقة العمل المناظرة.
    - إذا تم تغيير ارتفاع الصورة عند تطبيق القياس، فإن العرض يتغير أيضًا للحفاظ على نسبة العرض إلى الارتفاع الاصلية للصورة.

- حدد **مطلق** لتغيير حجم الصورة وفقًا لقيم الطول والعرض (بالبكسل) التي يتم توفيرها في وقت التصميم.

    - إذا كان الارتفاع المحدد يتجاوز ارتفاع رأس أو تذييل الصفحة الأصل، فقد تتداخل الصورة مع منطقة البيانات الخاصة بورقة العمل المطابقة.

يمكنك أيضا استخدام الخاصية **قيد التمكين** لمكون **الصورة** للتحكم في رؤية الصورة التي يتم وضعها في المستند الذي تم إنشاؤه باستخدام هذا المكون.

> [!NOTE]
> يجب استخدام مصمم تنسيق ER لإضافة مكون **الصورة** إلى تنسيق ER القابل للتحرير. لا يمكن إضافة المكون عند استخدام مساحة عمل [إدارة مستندات الأعمال](er-business-document-management.md) لتحرير قالب مستند عمل.

لمعرفة المزيد حول هذه الوظيفة، اتبع الخطوات الموجودة في [تصميم تنسيق ER لإنشاء تقرير بتنسيق Excel باستخدام الصور المضمنة في رؤوس أو تزييلات الصفحات](er-embed-images-header-footer-excel-reports.md).

## <a name="embed-a-shape-in-an-excel-document"></a>تضمين شكل في مستند Excel

أولاً، يجب إضافة عنصر نائب للشكل في مستند Excel. قم بفتح مصنف Excel، وحدد **شكل** أو **مربع نص** أو **WordArt** كعنصر نائب للشكل. ثم استخدم أداة ER لإضافة تكوين ل تنسيق ER جديد لتضمين التقرير الذي تقوم بتصميمه. قم بإرفاق مصنف Excel كقالب لتنسيق التقرير، ثم قم باستيراد محتوى المصنف إلى تنسيق ER. سيتم إنشاء تعريف التنسيق تلقائيًا. سيتم تضمين العنصر النائب للشكل الذي قمت بإضافته في تعريف تنسيق ER كنصر **CELL** يشير إلى عنصر شكل مسمى في Excel.

> [!NOTE]
> يمكنك تحديد تعريف التنسيق يدويًا بدلاً من استيراده. وعند حفظ التغييرات، سيتم التحقق من صحة التنسيق.

بعد ذلك، قم بربط عنصر **CELL** بتنسيق ER بالحقل من مصدر البيانات الخاص بالتنسيق الذي يوفر البيانات في وقت التشغيل. يمكن تحويل هذه البيانات إلى سلسلة نصية. عندما يشير عنصر **CELL** بتنسيق ER إلى عنصر شكل في قالب Excel يدعم النص، سيظهر النص الذي تم توفيره عبر هذا الربط في وقت التشغيل على هيئة شكل في المستند الذي يتم إنشاؤه.

> [!IMPORTANT]
> - إذا كنت تريد استخدام قالب Excel الذي يتضمن العنصر النائب للشكل لإنشاء مستند جديد، فيجب أن يحتوي تنسيق ER على عنصر **CELL** يشير إلى عنصر شكل Excel. وبخلاف ذلك، لن يظهر أي عنصر نائب للشكل في إخراج التقرير. إذا كان ربط عنصر **CELL** الذي يشير إلى عنصر شكل Excel المسمى لا يقوم بإرجاع أي بيانات في وقت التشغيل، فسيُظهر المستند الذي تم إنشاؤه نص العنصر النائب للشكل من قالب Excel. لإخفاء شكل في المستند الذي تقوم بإنشائه، قم بتعريف عنصر **CELL** الذي يشير إلى عنصر شكل Excel المسمى، وحدد أن تعبير **التمكين** يجب أن يرجع القيمة **خطأ**.
> - في قالب Excel، استخدم اسمًا فريدًا لكل عنصر. تتضمن هذه العناصر الأشكال والخلايا. إذا قمت بتكرار اسم عنصر، سيكون محتوى التقرير الذي تم إنشاؤه غامضًا ومحيرًا.

## <a name="embed-an-image-in-a-word-document"></a>تضمين صورة في مستند Word
> [!IMPORTANT]
> يمكنك إعادة استخدام تنسيق ER والذي يستخدم قالب Excel لإنشاء مستندات تتضمن صورًا مضمنة. في تنسيق ER، تأكد من تحديد اسم لعنصر **CELL** الذي يشير إلى عنصر الصورة المسماة في Excel، والذي يرتبط بمصدر البيانات الذي يقوم بإرجاع صورة في وقت التشغيل.

أولا ، يجب عليك تكوين تخطيط مستند Word. استخدم عنصر التحكم **محتوى الصورة** لإنشاء عنصر نائب للصورة المضمنة. للوصول إلى عنصر التحكم هذا، يجب أولا جعل علامة تبويب **المطور** مرئية على شريط Word.

بعد ذلك، قم بحذف قالب Excel من تنسيق ER، ثم قم بإرفاقه بمستند قالب Word. قم بتحديث المرجع إلى القالب، وقم بحفظ التغييرات التي أجريتها. يتم حفظ بنية تنسيق ER الحالي إلى قالب Word المرفق كجزء XML مخصص جديد باسم **التقرير**.

بعد ذلك، قم بحفظ قالب Word لتنسيق ER الحالي على جهاز الكمبيوتر المحلي الخاص بك. افتح القالب، وافتح جزء **تعيين XML**. ابحث عن جزء XML المخصص الذي يسمي **التقرير**، ثم قم بالإشاره إلى عنصر **CELL** في تقرير ER المرتبط بمصدر بيانات الذي يقوم بإرجاع صورة بتنسيق ثنائي. قم بتعيين عنصر جزء XML هذا إلى عنصر تحكم **محتوى الصورة** المحدد، واحفظ التغييرات التي أجريتها.

[![الصور المضمنة.](./media/embed-images-shapes-01.png)](./media/embed-images-shapes-01.png)

في النهاية، قم بحذف قالب Word من تنسيق ER، وقم بإرفاق مستند Word الذي يتضمن أجزاء XML المخصصة المعينة. قم بتحديث مرجع التنسيق إلى القالب، وقم بحفظ التغييرات التي أجريتها على تنسيق ER هذا.

## <a name="more-information"></a>معلومات إضافية
لكي تصبح على دراية بتفاصيل هذه الميزة، قم بتشغيل مجموعة دلائل المهام، **لتقارير الإلكترونية - إنشاء تقارير بتنسيقات MS Office مع صور مضمنة**. تظهر إرشادات المهام هذه كيفية تضمين صور شعار الشركة وتوقيع شخص معتمد في شيكات الدفع التي يتم إنشاؤها باستخدام أداة ER في مستندات Excel وWord.

يسرد الجدول التالي الملفات المطلوبة لكي يتم إكمال دلائل المهام **لتقارير الإلكترونية - إنشاء تقارير بتنسيقات MS Office مع صور مضمنة**. قم بتنزيل الملفات إلى الكمبيوتر المحلي وقم بحفظها.

| الوصف                                          | اسم الملف                   |
|------------------------------------------------------|-----------------------------|
| تكوين نموذج بيانات التقارير الإلكترونية                          | [Model for cheques.xml](https://download.microsoft.com/download/6/e/a/6ea166fd-1382-4fdb-8dcb-0f13379f9c8e/Modelforcheques.xml)       |
| تنسيق تكوين ER                              | [Cheques printing format.xml](https://download.microsoft.com/download/1/7/c/17c301e3-c4ee-4886-ae75-440fcc002c8c/Chequesprintingformat.xml) |
| صورة شعار الشركة                                   | [Company logo.png](https://download.microsoft.com/download/8/2/e/82e6bd81-caac-4e9a-bfce-1392ce7c8616/Companylogo.png)            |
| صورة التوقيع                                      | [Signature image.png](https://download.microsoft.com/download/5/0/9/509151b3-06fc-4870-9408-7c9a43b72771/Signatureimage.png)         |
| صورة توقيع بديل                          | [Signature image 2.png](https://download.microsoft.com/download/3/0/0/30045bf1-0ff6-4215-9162-b77c2f5dcc7c/Signatureimage2.png)       |
| قالب Microsoft Word لطباعة شيكات الدفع  | [Cheque template Word.docx](https://download.microsoft.com/download/4/4/d/44d9d255-9ad1-42fe-87db-23f319fd8e89/ChequetemplateWord.docx)   |
| قالب Microsoft Excel لطباعة شيكات الدفع | [Cheque template.xlsx](https://download.microsoft.com/download/1/f/6/1f671963-73aa-48d5-ae69-45f21fe7dfb4/Cheque%20template.xlsx)        |

يوفر الرسم التالي مثالاً لنسخة مطبوعة لشيك دفع تم إنشاؤه من قالب Excel.

[![نسخة مطبوعة لاختبار شيكات الدفع.](./media/embed-images-shapes-02.png)](./media/embed-images-shapes-02.png)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
