---
title: منع عناصر تحكم محتوى Word في التقارير التي تم إنشاؤها
description: تشرح هذه المقالة كيفية تكوين تنسيق التقارير الإلكترونية (ER) لإنشاء التقارير كملفات Microsoft Word حيث يتم منع عناصر تحكم المحتويات.
author: NickSelin
ms.date: 02/11/2021
ms.topic: business-process
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, EROperationDesigner,  LedgerJournalTable, LedgerJournalTransVendPaym
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2020-01-01
ms.dyn365.ops.version: Version 10.0.6
ms.openlocfilehash: e11b697b78c89a1758fa9e81c901bd29fe281539
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 06/03/2022
ms.locfileid: "8882102"
---
# <a name="suppress-word-content-controls-in-generated-reports"></a>منع عناصر تحكم محتوى Word في التقارير التي تم إنشاؤها

[!include [banner](../includes/banner.md)]

لإنشاء تقارير كمستندات Microsoft Word، يجب تصميم قالب للتقارير كمستند Word. يجب أن يحتوي هذا القالب على عناصر تحكم محتوى Word كعناصر نائبة للبيانات التي سيتم ملؤها في وقت التشغيل. لاستخدام مستند Word الذي تم إنشائه كقالب لتقاريرك، يمكنك [تكوين](er-design-configuration-word.md) حل [تقارير إلكترونية (ER)](general-electronic-reporting.md) [جديد](er-quick-start1-new-solution.md). يجب أن يتضمن الحل [تكوين](general-electronic-reporting.md#Configuration) إعداد التقارير الإلكترونية (ER) الذي يحتوي على مكون تنسيق ER. يجب تكوين تنسيق ER هذا لاستخدام القالب الذي تم تصميمه لإنشاء التقارير.

في الإصدار 10.0.6 والإصدارات الأحدث من Dynamics 365 Finance، يمكنك تكوين الصيغ في تنسيق ER لمنع بعض عناصر تحكم محتوى Word في المستندات التي تم إنشاؤها.

توضح الخطوات التالية كيفية قيام المستخدم الذي تم تعيينه في دور مسؤول النظام أو مستشار وظيفي للتقارير الإلكترونية بتكوين تنسيق ER الذي يقوم بإنشاء تقارير كملفات Word ومنع بعض عناصر تحكم المحتوى في التقارير التي تم إنشاؤها والتي تم تكوينها باستخدام قالب Word.

يمكن تنفيذ هذه الخطوات في شركة GBSI.

## <a name="prerequisites"></a>المتطلبات الأساسية

لإكمال هذه الخطوات، يجب عليك أولاً إكمال الخطوط في دلائل المهام التالية:

- [تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](./tasks/er-design-reports-openxml-2016-11.md)
- [إعادة استخدام تكوينات ER باستخدام قوالب Excel لإنشاء التقارير بتنسيق Word](./tasks/er-design-configuration-word-2016-11.md)

عند إكمال الخطوات لدلائل المهام هذه، يتم إعداد العناصر التالية:

- تنسيق ER **لعينة تقرير ورقة عمل** الذي تم تكوينه لإنشاء مستند بتنسيق Word
- إصدار [مسودة](general-electronic-reporting.md#component-versioning) من تنسيق ER **لعينة تقرير ورقة العمل** الذي تم تعليمه كـ **قابل للتشغيل**
- طريقة دفع **إلكترونية** تم تكوينها لاستخدام تنسيق ER **لعينة تقرير ورقة العمل** لمعالجة مدفوعات المورد

يجب أيضًا تنزيل وحفظ القالب التالي لعينة التقرير:

- [القالب المرتبط 2 لتقرير الدفع (SampleVendPaymDocReportBounded2.docx)](https://download.microsoft.com/download/1/9/b/19b36e39-861a-414e-9150-9880d9d2487c/SampleVendPaymDocReportBounded2.docx)

## <a name="review-the-downloaded-word-template"></a><a id="tag-control"></a>مراجعه قالب Word الذي تم تنزيله

1. في تطبيق سطح مكتب Word، قم بفتح ملف القالب **SampleVendPaymDocReportBounded2.docx** الذي قمت بتنزيله سابقًا.
2. تحقق من احتواء ملف القالب على قسم ملخص يعرض إجمالي مبالغ الدفع الخاصة بكل كود عملة تم استيفاؤه في المدفوعات المعالجة.

    - يوجد قسم الملخص في جدول منفصل من مستند Word.
    - يحتوي الصف الأول من هذا الجدول على عناوين أعمدة الجدول كرأس للقسم.
    - يحتوي الصف الثاني من هذا الجدول على عنصر تحكم المحتوى المكرر كتفاصيل للقسم.
    - يتم تعيين عنصر تحكم المحتوى هذا إلى حقل **SummaryLines** في جزء XML المخصص لـ **التقرير**.
    - واستنادًا إلى هذا التعيين، يتم ربط عنصر تحكم المحتوى بعنصر **SummaryLines** لتنسيق ER القابل للتحرير.

    > [!NOTE]
    > يتم وضع علامة على عنصر تحكم المحتوي المتكرر بواسطة مفتاح **SummaryLines** الذي يتطابق مع الحقل الخاص بجزء XML المخصص الذي تم تعيينه إليه.

    ![تخطيط قالب Word.](./media/er-design-configuration-word-suppress-controls-image1.gif)

## <a name="select-the-existing-er-report-configuration"></a>تحديد تكوين التقارير الإلكترونية الموجود

بالنسبة للخطوات التالية، ستقوم بإعادة استخدام تكوين ER الموجود الذي قمت بتكوينه عند إكمال الخطوات في دلائل المهام المذكورة سابقًا.

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. حدد **تكوينات إعداد التقارير‬**.
3. في صفحة **التكوينات**، في شجرة التكوينات، وسَّع **نموذج الدفع**، ثم حدد **عينة تقرير ورقة العمل**.
4. حدد **المصمم** لتحرير إصدار المسودة لتنسيق ER المحدد.

## <a name="replace-the-current-template-with-the-new-template"></a>استبدال القالب الحالي بالقالب الجديد

في الوقت الحالي، يتم استخدام ملف SampleVendPaymDocReportBounded.docx كقالب لإنشاء المخرجات بتنسيق Word. في الخطوات التالية، سوف تستبدل قالب Word هذا بقالب Word، SampleVendPaymDocReportBounded2.docx، الذي قمت بتنزيله في وقت سابق.

1. في صفحة **مصمم التنسيق**، حدد **المرفقات**.
2. في الصفحة **المرفقات**، حدد **حذف** لإزالة القالب الموجود.
3. حدد **نعم** لتأكيد الحذف.
4. حدد **جديد** \> **ملف**.
5. حدد **استعراض**، واستعرض بحثا عن الملف **SampleVendPaymDocReportBounded2.docx** الذي قمت بتنزيله سابقًا وحدده.
6. حدد **موافق**.
7. أغلق صفحة **المرفقات**.
8. في صفحة **مصمم التنسيق**، في حقل **القالب**، أدخل أو حدد الملف **SampleVendPaymDocReportBounded2.docx**.

## <a name="run-the-format-to-create-word-output"></a>تشغيل التنسيق لإنشاء مخرجات Word

1. انتقل إلى **الحسابات الدائنة** \> **المدفوعات‬** \> **دفتر يومية المدفوعات‬**.
2. في صفحة **مدفوعات المورد**، من علامة تبويب **القائمة**، حدد كافة المدفوعات.
3. تحديد **حاله الدفع**\>**بلا**.
4. حدد **إنشاء المدفوعات**.
5. في حقل **طريقة الدفع** حدد **إلكتروني**.
6. في الحقل **حساب البنك** حدد **GBSI OPER**.
7. حدد **موافق**.
8. في مربع الحوار **معلمات التقرير الإلكتروني** ، حدد **موافق**، وقم بتحليل المخرجات التي تم إنشاؤها.

    ![المدفوعات للمعالجة في صفحة مدفوعات المورد.](./media/er-design-configuration-word-suppress-controls-image2.gif)

    يتم تقديم الإخراج بتنسيق Word ويحتوي على قسم الملخص.

## <a name="configure-the-editable-format-to-suppress-the-summary-section"></a><a id="configure-to-suppress-control"></a>تكوين التنسيق القابل للتحرير لمنع قسم الملخص

إذا أردت منع قسم الملخص في مستند تم إنشاؤه، استنادا إلى طلب المستخدم الذي يقوم بتشغيل تنسيق ER هذا، فيجب تعديل تنسيق ER القابل للتحرير.

1. انتقل إلى **إدارة المؤسسات**\> **مساحات العمل** \> **التقارير الإلكترونية**، وافتح إصدار المسودة لتنسيق ER للتحرير.
2. حدد **تكوينات إعداد التقارير‬**. 
3. في صفحة **التكوينات**، في شجرة التكوينات، قم بتوسيع **نموذج الدفع** \> **عينة تقرير ورقة العمل**.
4. حدد **المصمم**.
5. في صفحة **مصمم التنسيق** ، قم بتوسيع **Word**، وحدد **SummaryLines**.
6. في علامة التبويب **التعيين**، قم بإضافة مصدر بيانات جديد لسؤال المستخدم، في وقت التشغيل، عن ما إذا كان يجب منع قسم الملخص أم لا:

    1. حدد **إضافة جذر**.
    2. في مربع الحوار **إضافة مصدر بيانات**، حدد **معلمة إدخال عام/إدخال المستخدم** لفتح مربع الحوار **خصائص مصدر البيانات 'معلمة إدخال المستخدم'**.
    3. في الحقل **الاسم** ، أدخل **‏uipSuppress**.
    4. في حقل **التسمية**، أدخل **منح قسم الملخص**.
    5. في حقل **اسم نوع بيانات العمليات** ، حدد أو أدخل **NoYes**.
    6. حدد **موافق**.

7. أضف مصدر بيانات جديد لنوع تكرار التطبيق **NoYes**.

    1. حدد **إضافة جذر**.
    2. في مربع الحوار **إضافة مصدر بيانات** حدد **Dynamics 365 for Operations\تعداد** لفتح مربع الحوار **خصائص مصدر البيانات 'تعداد'**.
    3. في الحقل **الاسم**، أدخل **‏enumNoYes**.
    4. في حقل **التسمية**، أدخل **خيارات المنع**.
    5. في حقل **اسم نوع بيانات العمليات** ، حدد أو أدخل **NoYes**.
    6. حدد **موافق**.

8. بالنسبة لعنصر التنسيق **SummaryLines** المحدد، قم بتكوين المعادلة لتحديد متى يتم منع عنصر تحكم محتوى Word المقترن بعنصر التنسيق المحدد:

    1. ضمن علامة التبويب **تعيين**، في قسم **تمت الإزالة**، حدد **تحرير** لفتح صفحة **[مصمم المعادلة](general-electronic-reporting-formula-designer.md)**.
    2. في حقل **المعادلة**، أدخل المعادلة `uipSuppress = enumNoYes.Yes`.
    3. حدد **حفظ** وأغلق صفحة **مصمم المعادلة**.

        > [!NOTE]
        > سيتم تطبيق هذه المعادلة على مستند تم إنشاؤه **بعد تشغيل كافة عناصر التنسيق الأخرى**. لتطبيق هذه المعادلة، يوجد عنصر تحكم محتوى Word الذي تم تعليمه كعنصر تنسيق تم تكوين الصيغة لـ (**SummaryLines** في هذه الحالة) في المستند الذي تم إنشاؤه. يتم بعد ذلك إزالة عنصر تحكم المحتوى هذا بشكل كامل، مع الصف الموجود في جدول Word الذي يحمل هذا العنصر. وتتم إزالة صف التفاصيل الخاص بقسم الملخص من المستند الذي تم إنشاؤه.
        >
        > في وقت التصميم، قد تقوم بتكوين المعادلة **تمت الإزالة** لعنصر التنسيق، بالرغم من عدم وجود عنصر تحكم محتويات في قالب Word الذي تستخدمه يحتوي على علامة تطابق اسم عنصر التنسيق الذي تم تكوين خاصية **تمت الإزالة** له. عند التحقق من صحة التنسيق في وقت التصميم، فإنك تتلقي [تحذيرا](er-components-inspections.md#i14) حول عدم التوافق هذا.
        >
        > في وقت التشغيل، يتم عرض استثناء في حالة عدم وجود عنصر تحكم المحتوى في قالب Word الذي تستخدمه يحتوي على علامة تطابق اسم عنصر التنسيق الذي تم تكوين خاصية **تمت الإزالة** له.

    4. ضمن علامة التبويب **تعيين** في قسم **تمت الإزالة**، قم بتعيين خيار **مع الأصل** إلى **نعم**.

        > [!NOTE]
        > يجب تعيين هذا الخيار على **نعم** لإزالة جدول Word بأكمله مثل الكائن الأصلي للصف الذي يحتوي على تفاصيل قسم الملخص. إذا قمت بتعيين هذا الخيار إلى **لا**، سيبقي صف رأس القسم في المستند الذي تم إنشاؤه.

9. حدد **حفظ** لحفظ تغييراتك على التنسيق القابل للتحرير.

    ![الإخراج الناتج بتنسيق Word.](./media/er-design-configuration-word-suppress-controls-image3.gif)

## <a name="run-the-modified-format-to-create-word-output"></a>تشغيل التنسيق المعدل لإنشاء مخرجات Word

1. انتقل إلى **الحسابات الدائنة** \> **المدفوعات‬** \> **دفتر يومية المدفوعات‬**.
2. حدد دفترة يومية الدفع الذي أنشأته، ثم حدد **السطور**.
3. في صفحة **مدفوعات المورد**، حدد كافة الصفوف، ثم حدد **حالة الدفع** \> **بلا**.
4. حدد **إنشاء المدفوعات**.
5. في حقل **طريقة الدفع** حدد **إلكتروني**.
6. في الحقل **حساب البنك** حدد **GBSI OPER**.
7. حدد **موافق**.
8. في مربع الحوار **معلمات التقارير الإلكترونية**، في حقل **منع قسم الملخص**، حدد **نعم**.
9. حدد **موافق**، وقم بتحليل المخرجات التي تم إنشاؤها.

    ![الإخراج الناتج بتنسيق Word.](./media/er-design-configuration-word-suppress-controls-image4.gif)

    لاحظ أن الإخراج لا يحتوي على قسم الملخص، لأنه تم منعه.

## <a name="additional-resources"></a>الموارد الإضافية

- [تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](./tasks/er-design-reports-openxml-2016-11.md)
- [تصميم تكوين ER جديد لإنشاء التقارير بتنسيق Word](er-design-configuration-word.md)
- [إعادة استخدام تكوينات ER باستخدام قوالب Excel لإنشاء التقارير بتنسيق Word](./tasks/er-design-configuration-word-2016-11.md)
- [فحص مكون التقارير الإلكترونية الذي تم تكوينه لمنع مشكلات وقت التشغيل](er-components-inspections.md#i14)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
