---
title: تصميم حل جديد لإعداد التقارير الإلكترونية لطباعة تقرير مخصص
description: يشرح هذا الموضوع كيفية تصميم حل لإعداد التقارير الإلكترونية لطباعة تقرير مخصص.
author: NickSelin
ms.date: 08/10/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace, ERSolutionTable, ERParameters, ERDataModelDesigner, ERModelMappingTable, ERModelMappingDesigner, EROperationDesigner, ERVendorTable
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom:
- "220314"
- intro-internal
ms.assetid: ''
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 36998d299e166709778bfaa7bfd0d8980890d4fe
ms.sourcegitcommit: d5d6b81bd8b08de20cc018c2251436065982489e
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 02/17/2022
ms.locfileid: "8323832"
---
# <a name="design-a-new-er-solution-to-print-a-custom-report"></a>تصميم حل جديد لإعداد التقارير الإلكترونية لطباعة تقرير مخصص

[!include[banner](../includes/banner.md)]

توضح الخطوات التالية كيف يمكن لمستخدم يؤدي دور مسؤول النظام أو مطور إعداد التقارير الإلكترونية أو مستشار وظيفي لإعداد التقارير الإلكترونية تكوين معلمات لاطار عمل إعداد التقارير الإلكترونية وتصميم تكوينات التقارير الإلكترونية المطلوبة الخاصة بحل جديد لإعداد التقارير الإلكترونية للوصول إلى بيانات مجال عمل معين وإنشاء تقرير مخصص بتنسيق Microsoft Office. يمكن تنفيذ هذه الخطوات في شركة **USMF**.

- [تكوين إطار عمل ER](#ConfigureFramework)

    - [تكوين معلمات التقارير الإلكترونية](#ConfigureParameters)
    - [تنشيط موفر تكوين ER](#ActivateProvider)

        - [مراجعة قائمة موفري تكوين ER](#ReviewProvidersList)
        - [إضافة موفر تكوين ER جديد](#AddProvider)
        - [تنشيط موفر تكوين ER](#ActivateAddedProvider)

- [تصميم نموذج بيانات خاص بالمجال](#DesignModel)

    - [استيراد تكوين نموذج بيانات جديد](#ImportDataModel)
    - [إنشاء تكوين نموذج بيانات جديد](#DesignDataModel)

        - [تسمية نموذج البيانات](#NameDataModel)
        - [إضافة حقول نموذج البيانات](#FieldsEntry)
        - [إكمال تصميم نموذج البيانات](#CompleteDataModel)

- [تصميم تعيين نموذج لنموذج البيانات المكوّن](#DesignMapping)

    - [استيراد تكوين تعيين نموذج جديد](#ImportModelMapping)
    - [إنشاء تكوين تعيين نموذج جديد](#CreateModelMapping)

        - [تصميم مكون تعيين نموذج جديد](#DesignMappingComponent)
        - [إضافة مصادر بيانات للوصول إلى جداول التطبيق](#AddMmDataSource1)
        - [إضافة مصادر بيانات للوصول إلى عمليات تعداد التطبيقات](#AddMmDataSource2)
        - [إضافة تسميات التقارير الإلكترونية لإنشاء تقرير بلغة محددة](#AddMmLabels)
        - [إضافة مصدر بيانات لتحويل نتائج مقارنة قيم التعداد بقيمة نصية](#AddMmDataSource3)
        - [ربط مصادر البيانات بحقول نموذج البيانات](#AddMmBindings1)
        - [إكمال تصميم تعيين النموذج](#CompleteModelMapping)

- [تصميم قالب لتقرير مخصص](#DesignReportTemplate)
- [تصميم تنسيق](#DesignFormat)

    - [استيراد تكوين تنسيق مصمّم](#FormatImport)
    - [قم بإنشاء تكوين تنسيق جديد](#FormatCreate)

        - [استيراد قالب تقرير](#ImportReportTemplate)
        - [تكوين تنسيق](#ConfigureFormat)
        - [تعريف ربط البيانات لعنوان التقرير](#DefineFormatBindings)
        - [مراجعة مصدر بيانات النموذج](#ReviewModelDataSource)
        - [ربط عناصر التنسيق بحقول مصدر البيانات](#BindFormatElements)

    - [تشغيل تنسيق مصمّم من التقارير الإلكترونية](#RunFormatFromER)

- [ضبط تنسيق مصمّم](#TuneFormat)

    - [تعديل تنسيق لتغيير اسم مستند تم إنشاؤه](#ModifyToChangeName)
    - [تعديل تنسيق لتغيير ترتيب الأسئلة](#ModifyToOrder)
    - [تشغيل تنسيق معدّل من التقارير الإلكترونية](#RunFormatFromER2)
    - [إكمال تصميم التنسيق](#CompleteFormat)

- [تطوير بيانات اصطناعية للتطبيق لاستدعاء التقرير المصمّم](#DevelopCustomCode)

    - [تعديل التعليمات البرمجية المصدر](#ModifySourceCode)

        - [إضافة فئة عقد بيانات](#DataContractClass)
        - [إضافة فئة منشئ واجهة المستخدم](#UIBuilderClass)
        - [إضافة فئة موفر بيانات](#DataProviderClass)
        - [إضافة ملف تسميات](#LabelsFile)
        - [إضافة فئة خدمة تقرير](#ServiceClass)
        - [إضافة فئة مراقب التقارير](#ControllerClass)
        - [إضافة عنصر قائمة](#MenuItem)
        - [إضافة عنصر قائمة إلى قائمة](#Menu)
        - [إنشاء مشروع Visual Studio](#BuildVSProject)

    - [تشغيل تنسيق من التطبيق](#RunFormatFromApp)

- [ضبط حل إعداد التقارير الإلكترونية المصمّم](#TuneSolution)

    - [تعديل تعيين النموذج](#ModifyModelMapping)

        - [إضافة مصادر بيانات للوصول إلى كائن عقد البيانات](#AddDataSource1)
        - [إضافة مصدر بيانات للوصول إلى سجلات تعيين تنسيق التقارير الإلكترونية](#AddDataSource2)
        - [إضافة مصدر بيانات للوصول إلى سجل تعيين التنسيق لتنسيق تقارير إلكترونية قيد التشغيل](#AddDataSource3)
        - [إدخال اسم تنسيق تقارير إلكترونية قيد التشغيل في نموذج البيانات](#AddBinding)
        - [إكمال تصميم تعيين النموذج](#CompleteModelMapping2)

    - [تعديل تنسيق](#ModifyFormat)

        - [إضافة عنصر تنسيق جديد](#AddFormatElement)
        - [ربط عنصر التنسيق المضاف](#BindAddedFormatElement)
        - [إكمال تصميم التنسيق](#CompleteFormat2)

    - [تشغيل تنسيق من التطبيق](#RunFormatFromApp2)
    - [تشغيل تنسيق من التقارير الإلكترونية](#RunFormatFromER3)
    - [تكوين وجهة التنسيق للمعاينة على الشاشة](#ConfigureDestination)
    - [تشغيل تنسيق من التطبيق لمعاينته كمستند PDF](#RunFormatFromApp3)

- [الموارد الإضافية](#References)

في هذا المثال، ستقوم بإنشاء حل جديد لإعداد التقارير الإلكترونية للوحدة النمطية [الاستبيان](../../../human-resources/hr-learning-questionnaires.md). يتيح لك هذا الحل الجديد لإعداد التقارير الإلكترونية بتصميم تقرير باستخدام ورقه عمل Microsoft Excel كقالب. يمكنك بعد ذلك إنشاء تقرير **الاستبيان** بتنسيق Excel أو PDF، بالإضافة إلى إنشاء تقرير SQL Server Reporting Services (SSRS) الموجود. يمكنك أيضًا تعديل التقرير الجديد لاحقًا، عند الطلب. الترميز غير مطلوب.

1. لتشغيل التقرير الموجود، انتقل إلى **الاستبيان** \> **تصميم** \> **تقرير الاستبيانات**.

    ![تحديد عنصر قائمة تقرير الاستبيانات في الوحدة النمطية للاستبيان لتشغيل تقرير SSRS الموجود.](./media/er-quick-start1-application-menu-origin.png)

2. في مربع الحوار **تقرير الاستبيانات**، حدد معايير التحديد. طبّق عامل تصفية بحيث يتضمن التقرير الاستبيان **SBCCrsExam** فقط.

    ![تحديد معايير التحديد. في مربع الحوار "تقرير الاستبيانات".](./media/er-quick-start1-ssrs-report-dialog.png)

يبين الرسم التوضيحي التالي الإصدار الذي تم إنشاؤه من تقرير SSRS للاستبيان ‎**SBCCrsExam**

![تقرير SSRS المُنشأ.](./media/er-quick-start1-ssrs-report.png)

## <a name="configure-the-er-framework"></a><a name="ConfigureFramework"></a>تكوين إطار عمل ER

كمستخدم يؤدي دور مطور إعداد التقارير الإلكترونية، يجب عليك تكوين مجموعة صغيرة من معلمات التقارير الإلكترونية قبل بدء استخدام إطار عمل إعداد التقارير الإلكترونية لتصميم الحل الجديد لإعداد التقارير الإلكترونية..

### <a name="configure-er-parameters"></a><a name="ConfigureParameters"></a>تكوين معلمات التقارير الإلكترونية

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد **معلمات ‏‫إعداد التقارير الإلكترونية‬**.
3. في صفحة **معلمات التقارير الإلكترونية**، على علامة التبويب **عام**، عيّن الخيار **تمكين وضع التصميم** إلى **نعم**.
4. في علامة التبويب **المرفقات**، عيّن المعلمات التالية:

    - قم بتعيين حقل **التكوينات** إلى **الملف** لشركة **USMF**.
    - قم بتعيين حقول **أرشيف الوظيفة** و **المؤقت** و **الأساس** و **أخرى** إلى **الملف**.

لمزيد من المعلومات حول معلمات ER، راجع [تكوين إطار عمل ER](electronic-reporting-er-configure-parameters.md).

### <a name="activate-an-er-configuration-provider"></a><a name="ActivateProvider"></a>تنشيط موفر تكوين ER

يتم تمييز كل تكوين لإعداد التقارير الإلكترونية كمملوك من موفر تكوين التقارير الإلكترونية. بالتالي، يجب عليك تنشيط موفر تكوين التقارير الإلكترونية في مساحة عمل **إعداد التقارير الإلكترونية** قبل البدء في إضافة تكوينات التقارير الإلكترونية وتحريرها.

> [!NOTE]
> يمكن لمالك تكوين ER فقط تحريره. بالتالي، قبل تحرير تكوين ER، يجب تنشيط موفر تكوين ER المناسب في مساحة عمل **التقارير الإلكترونية**.

#### <a name="review-the-list-of-er-configuration-providers"></a><a name="ReviewProvidersList"></a>مراجعة قائمة موفري تكوين ER

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في مساحة عمل **إعداد التقارير الإلكترونية**، في قسم **الارتباطات‬ ذات الصلة**، حدد **موفرو التكوين**.
3. في صفحة **موفرو التكوين**، يتضمن كل سجل موفر تكوين اسمًا وعنوان URL فريدين. راجع محتويات هذه الصفحة. في حالة وجود سجل لـ **Litware, Inc.** (`https://www.litware.com`) بالفعل، فتخطي الإجراء التالي، [إضافة موفر تكوين ER جديد](#ActivateProvider).

#### <a name="add-a-new-er-configuration-provider"></a><a name="AddProvider"></a>إضافة موفر تكوين ER جديد

1. في صفحة **موفري التكوين**، حدد **جديد**.
2. في حقل **الاسم**، أدخل **Litware, Inc**.
3. في الحقل **عنوان الإنترنت**، أدخل `https://www.litware.com`.
4. حدد **حفظ**.

#### <a name="activate-an-er-configuration-provider"></a><a name="ActivateAddedProvider"></a>تنشيط موفر تكوين ER

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد موفر التكوين **Litware, Inc.**.
3. حدد **تعيين كنشط**.

لمزيد من المعلومات حول موفري تكوين ER، راجع [إنشاء موفري التكوين ووضع علامة عليهم كنشطين](tasks/er-configuration-provider-mark-it-active-2016-11.md).

## <a name="design-a-domain-specific-data-model"></a><a name="DesignModel"></a>تصميم نموذج بيانات خاص بالمجال

يجب إنشاء تكوين جديد للتقارير الإلكترونية يحتوي على مكون نموذج بيانات لمجال عمل **الاستبيان**. سيتم استخدام نموذج البيانات هذا لاحقًا كمصدر بيانات عند تصميم تنسيق التقارير الإلكترونية لإنشاء تقرير **الاستبيان**.

ومن خلال إكمال الخطوات الواردة في القسم [استيراد تكوين نموذج بيانات جديد](#ImportDataModel)، يمكنك استيراد نموذج البيانات المطلوب من ملف XML الذي تم توفيره. أو يمكنك إكمال الخطوات الواردة في القسم [إنشاء تكوين نموذج بيانات جديد](#DesignDataModel) لتصميم نموذج البيانات هذا من البداية.

### <a name="import-a-new-data-model-configuration"></a><a name="ImportDataModel"></a>استيراد تكوين نموذج بيانات جديد

1. قم بتنزيل الملف [Questionnaires model.version.1.xml](https://download.microsoft.com/download/b/6/3/b633bd34-d200-4422-96d9-8f62eb5218f8/Questionnaires_model.version.1.xml) واحفظه في جهاز الكمبيوتر المحلي.
2. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
3. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد **تكوينات إعداد التقارير**.
4. في جزء الإجراءات، حدد **التبادل** \> **تحميل من ملف XML**.
5. حدد **استعراض** ثم ابحث عن الملف **Questionnaires model.version.1.xml** وحدده.
6. حدد **موافق** لاستيراد التكوين.

للمتابعة، انتقل إلى الاجراء التالي، [إنشاء تكوين نموذج بيانات جديد](#DesignDataModel).

### <a name="create-a-new-data-model-configuration"></a><a name="DesignDataModel"></a>إنشاء تكوين نموذج بيانات جديد

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد **تكوينات إعداد التقارير**.
3. حدد **إنشاء التكوين**.
4. في مربع الحوار المنسدل، في الحقل **الاسم**، أدخل **نموذج الاستبيان**.
5. حدد **إنشاء تكوين** لإنشاء التكوين.

#### <a name="name-the-data-model"></a><a name="NameDataModel"></a>تسمية نموذج البيانات

1. في صفحة **التكوينات**، في شجرة التكوين، حدد **نموذج الاستبيان**.
2. حدد **المصمم**.
3. في الصفحة **مصمم نموذج البيانات**، على علامة التبويب السريعة **عام**، في حقل **الاسم**، أدخل <a name="DataModeName"></a>**الاستبيانات**.

#### <a name="add-new-data-model-fields"></a><a name="FieldsEntry"></a>إضافة حقول نموذج بيانات جديد

1. في صفحة **مصمم نموذج البيانات**، حدد **جديد**.
2. في مربع الحوار المنسدل لإضافة عقدة نموذج بيانات، اتبع الخطوات التالية:

    1. حدد **جذر النموذج** لنوع العقدة الجديدة.
    2. في الحقل **الاسم**، أدخل <a name="RootDefinitionName"></a>**جذر**.
    3. حدد **إضافة** لإضافة عقدة جديدة.

    سيتم استخدام واصف الجذر هذا لتوفير بيانات لتقرير **الاستبيان**. يمكن وجود واصفات متعددة لنموذج بيانات واحد. يمكن تحديد كل واصف لتنسيق تقارير إلكترونية واحد، لتعريف البيانات المطلوبة لإنشاء التقرير.

3. حدد **جديد** مرة أخرى، ثم في مربع الحوار المنسدل لإضافة عقدة نموذج بيانات، اتبع الخطوات التالية:

    1. حدد **تابع لعقدة نشطة** كنوع العقدة الجديدة.
    2. في الحقل **الاسم**، أدخل **‏‫CompanyName‬**.
    3. في الحقل **نوع الصنف**، حدد **سلسلة**.
    4. حدد **إضافة** لإضافة الحقل الجديد.

    هذا الحقل مطلوب لتمرير اسم الشركة الحالية إلى تقرير إعداد التقارير الإلكترونية الذي يستهلك نموذج البيانات هذا كمصدر بيانات.

4. حدد **جديد** مرة أخرى، ثم في مربع الحوار المنسدل لإضافة عقدة نموذج بيانات، اتبع الخطوات التالية:

    1. حدد **تابع لعقدة نشطة** كنوع العقدة الجديدة.
    2. في الحقل **الاسم**، أدخل **‏‫الاستبيان‬**.
    3. في حقل **نوع الصنف**، حدد **قائمة سجلات**.
    4. حدد **إضافة** لإضافة الحقل الجديد.

    سيتم استخدام هذا الحقل لتمرير قائمة الاستبيانات لتقرير إعداد التقارير الإلكترونية الذي يستهلك نموذج البيانات هذا كمصدر بيانات.

5. حدد عقدة **الاستبيان**.
6. تابع إضافة الحقول المطلوبة لنموذج البيانات القابل للتحرير بنفس الطريقة حتى إكمال بنية نموذج البيانات التالية.

    | مسار حقل                                                    | نوع البيانات   | تعيين الحقل/القيمة المرتجعة |
    |---------------------------------------------------------------|-------------|----------------------------------|
    | Root                                                          |             | النقطة المرجعية لطلب بيانات الاستبيان. |
    | Root\\CompanyName                                             | السلسلة      | اسم الشركة الحالية. |
    | Root\\ExecutionContext                                        | تسجيل      | تفاصيل تنفيذ التنسيق. |
    | Root\\ExecutionContext\\FormatName                            | السلسلة      | اسم تنسيق التقارير الإلكترونية الذي يجري تشغيله. |
    | Root\\Questionnaire                                           | قائمة السجلات | قائمة الاستبيانات |
    | Root\\Questionnaire\\Active                                   | السلسلة      | حالة الاستبيان الحالي. |
    | Root\\Questionnaire\\Code                                     | السلسلة      | كود الاستبيان الحالي. |
    | Root\\Questionnaire\\Description                              | السلسلة      | وصف الاستبيان الحالي. |
    | Root\\Questionnaire\\QuestionnaireType                        | السلسلة      | نوع الاستبيان الحالي. |
    | Root\\Questionnaire\\QuestionOrder                            | السلسلة      | الترتيب الرقمي للاستبيان الحالي. |
    | Root\\Questionnaire\\ResultsGroup                             | تسجيل      | معلمات نتيجة الاستبيان الحالي. |
    | Root\\Questionnaire\\ResultsGroup\\Code                       | السلسلة      | كود تعريف مجموعة النتائج الحالية. |
    | Root\\Questionnaire\\ResultsGroup\\Description                | السلسلة      | وصف مجموعة النتائج الحالية. |
    | Root\\Questionnaire\\ResultsGroup\\MaxNumberOfPoints          | حقيقي        | الحد الأقصى لعدد النقاط التي يمكن كسبها. |
    | Root\\Questionnaire\\Question                                 | قائمة السجلات | قائمة الأسئلة الخاصة بالاستبيان الحالي. |
    | Root\\Questionnaire\\Question\\CollectionSequenceNumber       | عدد صحيح     | الرقم التسلسلي لمجموعة الإجابات الحالية. |
    | Root\\Questionnaire\\Question\\Id                             | السلسلة      | كود تعريف السؤال الحالي. |
    | Root\\Questionnaire\\Question\\MustBeCompleted                | السلسلة      | علامة تشير إلى ما إذا كان يجب الإجابة على السؤال الحالي. |
    | Root\\Questionnaire\\Question\\PrimaryQuestion                | السلسلة      | علامة تشير إلى ما إذا كان السؤال الحالي عبارة عن سؤال أساسي. |
    | Root\\Questionnaire\\Question\\SequenceNumber                 | عدد صحيح     | الرقم التسلسلي للسؤال الحالي. |
    | Root\\Questionnaire\\Question\\Text                           | السلسلة      | نص السؤال الحالي. |
    | Root\\Questionnaire\\Question\\Answer                         | قائمة السجلات | قائمة الإجابات على السؤال الحالي. |
    | Root\\Questionnaire\\Question\\Answer\\CorrectAnswer          | السلسلة      | علامة تشير إلى ما إذا كانت الإجابة الحالية صحيحة. |
    | Root\\Questionnaire\\Question\\Answer\\Points                 | حقيقي        | النقاط التي تم اكتسابها عند تحديد الإجابة الحالية. |
    | Root\\Questionnaire\\Question\\Answer\\SequenceNumber         | عدد صحيح     | الرقم التسلسلي للإجابة الحالية. |
    | Root\\Questionnaire\\Question\\Answer\\Text                   | السلسلة      | نص الإجابة الحالية. |

    يبين الرسم التوضيحي التالي نموذج البيانات المكتمل القابل للتحرير في صفحة **مصمم نموذج البيانات**.

    ![نموذج بيانات مكوّن في مصمم نموذج بيانات إعداد التقارير الإلكترونية.](./media/er-quick-start1-model2.png)

7. ‏‏قم بحفظ التغييرات التي قمت بإجرائها.
8. أغلق صفحة **مصمم نموذج البيانات**.

#### <a name="complete-the-design-of-the-data-model"></a><a name="CompleteDataModel"></a>إكمال تصميم نموذج البيانات

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، حدد **نموذج الاستبيان**.
3. في علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
4. حدد **تغيير الحالة** \> **مكتمل‏‎**.

تم تغيير حالة الإصدار 1 من هذا التكوين من **مسودة** إلى **مكتمل**. لم يعد من الممكن تغيير الإصدار 1. يحتوي هذا الإصدار على نموذج البيانات الذي تم تكوينه ويمكن استخدامه كأساس لتكوينات إعداد التقارير الإلكترونية الأخرى. تم إنشاء الإصدار 2 من هذا التكوين وهو بالحالة **مسودة**. يمكنك تحرير هذا الإصدار لتعديل نموذج بيانات **الاستبيان**.

![إصدارات التكوين القابل للتعديل في صفحة التكوينات.](./media/er-quick-start1-model-configuration.png)

لمزيد من المعلومات حول تعيين إصدار تكوينات إعداد التقارير الإلكترونية، راجع [نظرة عامة حول إعداد التقارير الإلكترونية](general-electronic-reporting.md#component-versioning).

> [!NOTE]
> يعتبر نموذج البيانات الذي تم تكوينه التمثيل المجرد لمجال عمل **الاستبيان** ولا يحتوي على أي علاقات بالبيانات الاصطناعية الخاصة بتطبيق Microsoft Dynamics 365 Finance.

## <a name="design-a-model-mapping-for-the-configured-data-model"></a><a name="DesignMapping"></a>تصميم تعيين نموذج لنموذج البيانات المكوّن

كمستخدم يؤدي دور مطور إعداد التقارير الإلكترونية، يجب عليك إنشاء تكوين جديد لإعداد التقارير الإلكترونية يحتوي على مكون تعيين نموذج لنموذج بيانات **الاستبيان**. لأن هذا المكون يقوم بتطبيق نموذج البيانات الذي تم تكوينه لتطبيق Finance، فهو خاص بتطبيق Finance. يجب تكوين مكون تعيين النموذج لتحديد كائنات التطبيق التي يجب استخدامها لتعبئة نموذج البيانات الذي تم تكوينه بواسطة بيانات التطبيق في وقت التشغيل. لإكمال هذه المهمة، يجب أن تكون على علم بتفاصيل التنفيذ لبنية البيانات لمجال عمل **الاستبيان** في Finance.

ومن خلال إكمال الخطوات الواردة في القسم [استيراد تكوين تعيين نموذج جديد](#ImportModelMapping)، يمكنك استيراد تكوين تعيين النموذج من ملف XML الذي تم توفيره. أو يمكنك إكمال الخطوات الواردة في القسم [إنشاء تكوين تعيين نموذج جديد](#CreateModelMapping) لتصميم تعيين النموذج هذا من البداية.

### <a name="import-a-new-model-mapping-configuration"></a><a name="ImportModelMapping"></a>استيراد تكوين تعيين نموذج جديد

1. قم بتنزيل الملف [Questionnaires mapping.version.1.xml](https://download.microsoft.com/download/7/b/2/7b258e4e-4bd5-46a4-8114-27419ae4acd8/Questionnaires_mapping.version.1.1.xml) واحفظه في جهاز الكمبيوتر المحلي.
2. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
3. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد **تكوينات إعداد التقارير**.
4. في جزء الإجراءات، حدد **التبادل** \> **تحميل من ملف XML**.
5. حدد **استعراض** ثم ابحث عن الملف **Questionnaires mapping.version.1.xml** وحدده.
6. حدد **موافق** لاستيراد التكوين.

للمتابعة، انتقل إلى الاجراء التالي، [إنشاء تكوين تعيين نموذج جديد](#CreateModelMapping).

### <a name="create-a-new-model-mapping-configuration"></a><a name="CreateModelMapping"></a>إنشاء تكوين تعيين نموذج جديد

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، حدد **نموذج الاستبيان**.
3. حدد **إنشاء التكوين**.
4. في مربع الحوار المنسدل، اتبع الخطوات التالية:

    1. في الحقل **جديد**، حدد **تعيين النموذج استنادًا إلى استبيانات نموذج بيانات**.
    2. في حقل **الاسم**، أدخل **تعيين الاستبيان**.
    3. في الحقل **تعريف نموذج البيانات**، حدد تعريف **الجذر**.
    4. حدد **إنشاء تكوين** لإنشاء التكوين.

#### <a name="design-a-new-model-mapping-component"></a><a name="DesignMappingComponent"></a>تصميم مكون تعيين نموذج جديد

1. في صفحة **التكوينات**، في شجرة التكوين، حدد **تعيين الاستبيان**.
2. حدد **المصمم** لفتح قائمة التعيينات.
3. حدد التعيين **تعيين الاستبيان** المضاف تلقائيًا لتعريف **الجذر**
4. حدد **المصمم** لبدء تكوين التعيين المحدد.

يُضاف تعيين جديد بشكل تلقائي لتعريف **الجذر**. اتجاه هذا التعيين هو **إلى النموذج**. وبالتالي، يمكن استخدام هذا التعيين لتعبئة نموذج بيانات يحتوي على البيانات المطلوبة.

#### <a name="add-data-sources-to-access-application-tables"></a><a name="AddMmDataSource1"></a>إضافة مصادر بيانات للوصول إلى جداول التطبيق

يجب تكوين مصادر البيانات للوصول إلى جداول التطبيق التي تحتوي على تفاصيل الاستبيان.

1. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\Table records**.
2. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى الجدول KMCollection، حيث يمثل كل سجل استبيانًا واحدًا:

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في الحقل **الاسم**، أدخل **الاستبيان**.
    3. في حقل **الجدول**، أدخل **KMCollection‎**.
    4. عيّن الخيار **طلب الاستعلام** إلى **نعم**. ستتمكن عندئذٍ من تحديد خيارات [التصفية](../../fin-ops/get-started/advanced-filtering-query-options.md) لهذا الجدول في مربع حوار استعلام النظام في وقت التشغيل.
    5. حدد **موافق** لإضافة مصدر البيانات الجديد.

3. في الجزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\Table records**.
4. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى الجدول KMQuestion، حيث يمثل كل سجل سؤالاً واحدًا في استبيان:

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في الحقل **الاسم**، أدخل **السؤال**.
    3. في حقل **الجدول**، أدخل **KMQuestion‎**.
    4. حدد **موافق** لإضافة مصدر البيانات الجديد.

5. في الجزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\Table records**.
6. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى الجدول KMAnswer، حيث يمثل كل سجل إجابة واحدة على سؤال في استبيان:

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في الحقل **الاسم**، أدخل **الإجابة**.
    3. في حقل **الجدول**، أدخل **KMAnswer‎**.
    4. حدد **موافق** لإضافة مصدر البيانات الجديد.

7. في الجزء **أنواع مصادر البيانات**، حدد **الدالات\\الحقل المحسوب**.
8. أضف حقلاً محسوبًا جديدًا سيتم استخدامه للوصول إلى سجل من الجدول KMQuestionResultGroup من كل سجل لجدول KMCollection الأصل:

    1. حدد **الاستبيان** في جزء **مصادر البيانات** .
    2. حدد **إضافة**.
    3. في مربع الحوار، في الحقل **الاسم‏‎**، أدخل **\$ResultGroup**.
    4. حدد **تحرير المعادلة**.
    5. في [محرر معادلات إعداد التقارير الإلكترونية](general-electronic-reporting-formula-designer.md)، في حقل **المعادلة**، أدخل **FIRSTORNULL(\@.'\<Relations'.KMQuestionResultGroup)** لاستخدام [المسار](er-formula-language.md#Paths) لعلاقة واحد إلى واحد بين الجدولين KMCollection وKMQuestionResultGroup.
    6. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
    7. حدد **موافق** لإضافة الحقل المحسوب الجديد.

9. في الجزء **أنواع مصادر البيانات**، حدد **الدالات\\الحقل المحسوب**.
10. أضف حقلاً محسوبًا جديدًا سيتم استخدامه للوصول إلى سجلات السؤال من الجدول KMQuestion من كل سجل لجدول KMCollectionQuestion الأصل:

    1. حدد **الاستبيان** في جزء **مصادر البيانات** .
    2. قم بتوسيع عقدة **\<العلاقات** التي تحتوي على علاقات واحد إلى متعدد لجدول KMCollection.
    3. حدد الجدول ذا الصلة **KMCollectionQuestion** ثم حدد **إضافة**.
    4. في مربع الحوار، في الحقل **الاسم‏‎**، أدخل **\$Question**.
    5. حدد **تحرير المعادلة**.
    6. في محرر المعادلات، في حقل **المعادلة**، أدخل **FIRSTORNULL (FILTER(Question, Question.kmQuestionId = \@.kmQuestionId))** لإرجاع سجلات السؤال المناسب من جدول KMQuestion.
    7. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
    8. حدد **موافق** لإضافة الحقل المحسوب الجديد.

11. في الجزء **أنواع مصادر البيانات**، حدد **الدالات\\الحقل المحسوب**.
12. أضف حقلاً محسوبًا جديدًا سيتم استخدامه للوصول إلى سجلات الإجابة من الجدول KMAnswer من كل سجل لجدول KMAnswer الأصل:

    1. في جزء **مصادر البيانات**، حدد **Questionnaire.\<Relations.KMCollectionQuestion.\$Question**، ثم حدد **إضافة**.
    2. في مربع الحوار، في الحقل **الاسم‏‎‏‎**، أدخل **\$Answer**.
    3. حدد **تحرير المعادلة**.
    4. في محرر المعادلات، في حقل **المعادلة‏‎**، أدخل **FILTER (Answer, Answer.kmAnswerCollectionId = \@.kmAnswerCollectionId)** لإرجاع سجلات السؤال المناسب من جدول KMAnswer.
    5. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
    6. حدد **موافق** لإضافة الحقل المحسوب الجديد.

13. في الجزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\الجدول**.
14. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى أساليب الجدول معلومات الشركة. لاحظ أن أسلوب **find()** الخاص بهذا الجدول يرجع سجلاً يمثل شركة من مثيل Finance الحالي الذي تم استدعاء هذا التعيين في سياقه.

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في الحقل **الاسم**، أدخل **معلومات الشركة‎**.
    3. في حقل **الجدول**، أدخل **معلومات الشركة‎‎**.
    4. حدد **موافق** لإضافة مصدر البيانات الجديد.

#### <a name="add-data-sources-to-access-application-enumerations"></a><a name="AddMmDataSource2"></a>إضافة مصادر بيانات للوصول إلى عمليات تعداد التطبيقات

يجب عليك تكوين مصادر البيانات للوصول إلى تعدادات التطبيقات ومقارنة قيمها مع قيم حقول من نوع **التعداد** في جداول التطبيق. يجب استخدام نتيجة المقارنة لملء الحقول المناسبة لنموذج البيانات.

1. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\تعداد‎**.
2. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى قيم التعداد **EnumAppNoYes‎**.

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في الحقل **الاسم**، أدخل **EnumAppNoYes‎‎**.
    3. في الحقل **التعداد**، أدخل **NoYes**.
    4. حدد **موافق** لإضافة مصدر البيانات الجديد.

3. في الجزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\Enumeration‎**.
4. أضف مصدر بيانات جديدًا سيتم استخدامه للوصول إلى قيم التعداد **KMCollectionQuestionMode‎‎**.

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في حقل **الاسم**، أدخل **EnumAppQuestionOrder**.
    3. في الحقل **التعداد**، أدخل **KMCollectionQuestionMode**.
    4. حدد **موافق** لإضافة مصدر البيانات الجديد.

#### <a name="add-er-labels-to-generate-a-report-in-a-specified-language"></a><a name="AddMmLabels"></a>إضافة تسميات التقارير الإلكترونية لإنشاء تقرير بلغة محددة

يمكنك إضافة تسميات التقارير الإلكترونية لتكوين بعض مصادر البيانات لإرجاع القيم التي تعتمد على اللغة التي تم تعريفها في سياق استدعاء تعيين النموذج.

1. في صفحة **مصمم تعيين النموذج**، في جزء **مصادر البيانات**، حدد **إجابة**، ثم حدد **تحرير**.
2. قم بتنشيط حقل **التسمية**.
3. حدد **ترجمة**.
4. في مربع الحوار **نص الترجمة**، اتبع الخطوات التالية:

    1. في حقل **معرف التسمية**، أدخل **PositiveAnswer**.
    2. في حقل **النص باللغة الافتراضية**، أدخل **نعم**.
    3. حدد **ترجمة**.
    4. في حقل **معرف التسمية**، أدخل **NegativeAnswer**.
    5. في حقل **النص باللغة الافتراضية**، أدخل **لا**.
    6. حدد **ترجمة**.

5. قم بإغلاق مربع الحوار **ترجمة النص**.
6. حدد **إلغاء الأمر**.

![إضافة تسميات التقارير الإلكترونية لتعيين النموذج القابل للتحرير.](./media/er-quick-start1-adding-labels.png)

لقد قمت بإدخال تسميات التقارير الإلكترونية للغة الافتراضية فقط. لمزيد من المعلومات حول كيفية ترجمة تسميات التقارير الإلكترونية إلى لغات أخرى، راجع [تصميم تقارير متعددة اللغات](er-design-multilingual-reports.md).

#### <a name="add-a-data-source-to-transform-the-results-of-comparing-enumeration-values-to-a-text-value"></a><a name="AddMmDataSource3"></a>إضافة مصدر بيانات لتحويل نتائج مقارنة قيم التعداد بقيمة نصية

لأنه يجب عليك تحويل نتائج المقارنة بين قيم التعداد والقيم النصية عدة مرات بسبب اختلاف المصادر، من المستحسن تكوين هذا المنطق كمصدر بيانات واحد. ومع ذلك، ولجعل مصدر البيانات هذا قابلاً لإعادة الاستخدام، يجب عليك عندئذٍ تكوينه كمصدر بيانات يتضمن معلمات. لمزيد من المعلومات، راجع [اعتماد استدعاءات ذات معلمات لمصادر بيانات التقارير الإلكترونية لنوع الحقل المحسوب](er-calculated-field-type.md).

1. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **General\\Empty container**.
2. إضافة مصدر بيانات حاوية جديد:

    1. حدد **إضافة جذر** في جزء **مصادر البيانات** .
    2. في مربع الحوار، في الحقل **الاسم**، أدخل **المساعد**.
    3. حدد **موافق** لإضافة مصدر البيانات الحاوية الجديد.

3. في الجزء **أنواع مصادر البيانات**، حدد **الدالات\\الحقل المحسوب**.
4. إضافة مصدر بيانات جديد:

    1. في جزء **مصادر البيانات**، حدد **المساعد** .
    2. حدد **إضافة**.
    3. في مربع الحوار، في حقل **الاسم**، أدخل **NoYesEnumToString**.
    4. حدد **تحرير المعادلة**.
    5. في محرر الصيغة، حدد **المعلمات**.
    6. اتبع الخطوات التالية لتحديد معلمات للتعبير المكوّن:

        1. حدد **جديد**.
        2. في مربع الحوار، في الحقل **الاسم**، أدخل **الوسيطة**.
        3. في الحقل **النوع**، حدد نوع البيانات **منطقي**.
        4. حدد **موافق**.

    7. في حقل **المعادلة**، أدخل **IF (Argument = true, \@"GER\_LABEL:PositiveAnswer", \@"GER\_LABEL:NegativeAnswer")** لإرجاع نص تسمية التقارير الإلكترونية المناسبة، بحسب لغة سياق التنفيذ وقيمة المعلمة المحددة.
    8. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
    9. حدد **موافق** لإضافة مصدر البيانات الجديد.

![تعيين نموذج مكوّن في مصمم تعيين نموذج إعداد التقارير الإلكترونية.](./media/er-quick-start1-added-data-sources.png)

#### <a name="bind-data-sources-to-data-model-fields"></a><a name="AddMmBindings1"></a>ربط مصادر البيانات بحقول نموذج البيانات

يجب ربط مصادر البيانات التي تم تكوينها بحقول نموذج البيانات لتحديد كيف سيتم ملء نموذج البيانات ببيانات التطبيق في وقت التشغيل.

1. في صفحة **مصمم تعيين النموذج**، في جزء **نموذج البيانات**، حدد **اسم الشركة**.
2. في جزء **مصادر البيانات**، قم بتوسيع **معلومات الشركة**، ثم اتبع الخطوات التالية:

    1. قم بتوسيع العقدة **CompanyInfo.find()** التي تمثل الأسلوب **find()** في جدول معلومات الشركة.
    2. حدد **CompanyInfo.find().Name**.
    3. حدد **ربط** لملء اسم الشركة الذي يتم استدعاء تعيين النموذج المكوّن لها في سياق وقت التشغيل.

3. حدد **الاستبيان** في جزء **نموذج البيانات** .
4. في جزء **مصادر البيانات**، حدد **الاستبيان**، ثم حدد **ربط** لملء سجلات الاستبيان.
5. في جزء **نموذج البيانات**، قم بتوسيع **الاستبيان**، ثم اتبع الخطوات التالية:

    1. حدد **نشط** في جزء **نموذج البيانات** .
    2. حدد **تحرير** في جزء **نموذج البيانات** .
    3. في حقل **المعادلة**، أدخل **Helper.NoYesEnumToString (\@.Active = EnumAppNoYes.Yes)** لملء النتيجة التي تعتمد على النص وعلى اللغة للمقارنة بين قيم التعداد.

6. تابع لربط مصادر البيانات بحقول نموذج البيانات بنفس الطريقة حتى تحقق النتيجة التالية.

    | مسار حقل                                              | نوع البيانات   | الإجراء | تعبير الربط |
    |---------------------------------------------------------|-------------|--------|--------------------|
    | اسم الشركة                                             | السلسلة      | ربط   | CompanyInfo.'find()'.Name |
    | الاستبيان                                           | قائمة السجلات | ربط   | الاستبيان |
    | Questionnaire\\Active                                   | السلسلة      | تحرير   | Helper.NoYesEnumToString(\@.active = EnumAppNoYes.Yes) |
    | Questionnaire\\Code                                     | السلسلة      | ربط   | \@.kmCollectionId |
    | Questionnaire\\Description                              | السلسلة      | ربط   | \@.Description |
    | Questionnaire\\QuestionnaireType                        | السلسلة      | ربط   | \@.'&gt;Relations'.kmCollectionTypeId.Description |
    | Questionnaire\\QuestionOrder                            | السلسلة      | تحرير   | CASE (\@.questionMode,<br>EnumAppQuestionOrder.Conditional, "Conditional",<br>EnumAppQuestionOrder.Random، "عشوائي (النسبة المئوية في الاستبيان)"،<br>EnumAppQuestionOrder.RandomGroup، "عشوائي (النسبة المئوية في مجموعات النتائج)"،<br>EnumAppQuestionOrder.Sequence، "تسلسلي"،<br>"") |
    | Questionnaire\\ResultsGroup                             | تسجيل      |        | |
    | Questionnaire\\ResultsGroup\\Code                       | السلسلة      | ربط   | \@.'\$ResultGroup'.kmQuestionResultGroupId |
    | Questionnaire\\ResultsGroup\\Description                | السلسلة      | ربط   | \@.'\$ResultGroup'.description |
    | Questionnaire\\ResultsGroup\\MaxNumberOfPoints          | حقيقي        | ربط   | \@.'\$ResultGroup'.maxPoint |
    | Questionnaire\\Question                                 | قائمة السجلات | ربط   | \@.'&lt;Relations'.KMCollectionQuestion |
    | Questionnaire\\Question\\CollectionSequenceNumber       | عدد صحيح     | ربط   | \@.answerCollectionSequenceNumber |
    | Questionnaire\\Question\\Id                             | السلسلة      | ربط   | \@.kmQuestionId |
    | Questionnaire\\Question\\MustBeCompleted                | السلسلة      | تحرير   | Helper.NoYesEnumToString(\@.mandatory = EnumAppNoYes.Yes) |
    | Questionnaire\\Question\\PrimaryQuestion                | السلسلة      | ربط   | \@.parentQuestionId |
    | Questionnaire\\Question\\SequenceNumber                 | عدد صحيح     | ربط   | \@.SequenceNumber |
    | Questionnaire\\Question\\Text                           | السلسلة      | ربط   | \@.'\$Question'.text |
    | Questionnaire\\Question\\Answer                         | قائمة السجلات | ربط   | \@.'\$Question'.'\$Answer' |
    | Questionnaire\\Question\\Answer\\CorrectAnswer          | السلسلة      | تحرير   | Helper.NoYesEnumToString(\@.correctAnswer = EnumAppNoYes.Yes) |
    | Questionnaire\\Question\\Answer\\Points                 | حقيقي        | ربط   | \@.point |
    | Questionnaire\\Question\\Answer\\SequenceNumber         | عدد صحيح     | ربط   | \@.sequenceNumber |
    | Questionnaire\\Question\\Answer\\Text                   | السلسلة      | ربط   | \@.text |

    يبين الرسم التوضيحي التالي الحالة النهائية لتعيين النموذج الذي تم تكوينه على صفحة **مصمم تعيين النموذج**.

    ![تعيين نموذج مكوّن بشكل كامل في مصمم تعيين نموذج إعداد التقارير الإلكترونية.](./media/er-quick-start1-mapping2.png)

7. ‏‏قم بحفظ التغييرات التي قمت بإجرائها.
8. أغلق صفحة **مصمم تعيين النموذج**.

#### <a name="complete-the-design-of-the-model-mapping"></a><a name="CompleteModelMapping"></a>إكمال تصميم تعيين النموذج

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، حدد **تعيين الاستبيان**.
3. في علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
4. حدد **تغيير الحالة** \> **مكتمل‏‎**.

تم تغيير حالة الإصدار 1.1 من هذا التكوين من **مسودة** إلى **مكتمل**. لم يعد من الممكن تغيير الإصدار 1.1. يحتوي هذا الإصدار على تعيين النموذج الذي تم تكوينه ويمكن استخدامه كأساس لتكوينات إعداد التقارير الإلكترونية الأخرى. تم إنشاء الإصدار 1.2 من هذا التكوين وهو بالحالة **مسودة**. يمكنك تحرير هذا الإصدار لتعديل تكوين **تعيين الاستبيان**.

![إصدارات تكوين تنسيق إعداد التقارير الإلكترونية في صفحة التكوينات.](./media/er-quick-start1-mapping-configuration.png)

> [!NOTE]
> يعد تعيين النموذج الذي تم تكوينه بمثابة تنفيذ خاص بتطبيق Finance لنموذج البيانات المجرد الذي يمثل مجال عمل **الاستبيان**.

## <a name="design-a-template-for-a-custom-report"></a><a name="DesignReportTemplate"></a>تصميم قالب لتقرير مخصص

يستخدم إطار عمل إعداد التقارير الإلكترونية قوالب معرّفة مسبقًا لإنشاء تقارير بتنسيقات Microsoft Office (مصنفات Excel أو مستندات Word). بينما يتم إنشاء التقرير المطلوب، يتم ملء القالب بالبيانات المطلوبة وفقًا لتدفق البيانات الذي تم تكوينه. وبالتالي، يجب أولاً تصميم قالب للتقرير المخصص. يجب تصميم هذا القالب كمصنف Excel، ويمثل البنية التي تمثل تخطيط تقرير مخصص. يجب عليك تسمية كل عنصر من عناصر Excel التي تخطط لتعبئتها بالبيانات المطلوبة.

1. قم بتنزيل الملف [Questionnaires report template.xlsx](https://download.microsoft.com/download/3/8/2/382c3cf0-87bb-473f-b7bb-3015b4facb74/Questionnaires_report_template.xlsx)، واحفظه في جهاز الكمبيوتر المحلي.
2. افتح الملف في Excel، وراجع بنية المصنف.

كما يوضح الرسم التوضيحي التالي، تم تصميم القالب الذي تم تنزيله لطباعة الاستبيانات المحددة التي تقدم أسئلة الاستبيان مع الإجابات المناسبة.

![قالب Excel لطباعة الاستبيانات المحددة.](./media/er-quick-start1-template-layout.png)

تمت إضافة أسماء Excel إلى هذا القالب لملء تفاصيل الاستبيان. يمكنك استخدام إدارة الأسماء لمراجعه أسماء Excel.

![استخدام إدارة الأسماء لمراجعة أسماء Excel في قالب Excel المتوفر.](./media/er-quick-start1-template-names.png)

تمت إضافة تسميات التقارير كنص ثابت باللغة الإنجليزية. يمكنك استبدال تسميات التقارير بأسماء Excel جديدة تقوم بملء التسميات بواسط نص يعتمد على اللغة باستخدام [تسميات](#AddMmLabels) تنسيقات التقارير الإلكتروني، كما فعلت بالتعبيرات التي تعتمد على اللغة في تعيين النموذج الذي تم تكوينه. في هذه الحالة، يجب إضافة تسميات التقارير الإلكترونية في تنسيق التقارير الإلكترونية القابل للتحرير.

كما يبين الشكل التوضيحي التالي، تم تعيين رأس التقرير المخصص لتمكين Excel من إجراء ترحيل الصفحات.

![رأس التقرير المخصص في قالب Excel المتوفر.](./media/er-quick-start1-template-header.png)

## <a name="design-a-format"></a><a name="DesignFormat"></a>تصميم تنسيق

كمستخدم في دور المستشار الوظيفي للتقارير الإلكترونية، يجب عليك إنشاء تكوين تقارير إلكترونية جديد يحتوي على مكون التنسيق. يجب تكوين مكون التنسيق لتحديد كيفية ملء قالب التقرير بالبيانات المطلوبة في وقت التشغيل.

ومن خلال إكمال الخطوات الواردة في القسم [استيراد تكوين تنسيق مصمّم](#FormatImport)، يمكنك استيراد التنسيق المطلوب من ملف XML الذي تم توفيره. أو يمكنك إكمال الخطوات الواردة في القسم [إنشاء تكوين تنسيق جديد](#FormatCreate) لتصميم هذا التنسيق من البداية.

### <a name="import-a-designed-format-configuration"></a><a name="FormatImport"></a>استيراد تكوين تنسيق مصمّم

1. قم بتنزيل الملف [Questionnaires format.version.1.xml](https://download.microsoft.com/download/1/b/a/1ba39ec2-257a-44d8-972f-25bf7d18fb41/Questionnaires_format.version.1.1.xml) واحفظه في جهاز الكمبيوتر المحلي.
2. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
3. في مساحة عمل **إعداد التقارير الإلكترونية**، حدد **تكوينات إعداد التقارير**.
4. في جزء الإجراءات، حدد **التبادل** \> **تحميل من ملف XML**.
5. حدد **استعراض** ثم ابحث عن الملف **Questionnaires format.version.1.xml** وحدده.
6. حدد **موافق** لاستيراد التكوين.

للمتابعة، انتقل إلى الاجراء التالي، [إنشاء تكوين تنسيق جديد](#FormatCreate).

### <a name="create-a-new-format-configuration"></a><a name="FormatCreate"></a>قم بإنشاء تكوين تنسيق جديد
 
1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، حدد **نموذج الاستبيان**.
3. حدد **إنشاء التكوين**.
4. في مربع الحوار المنسدل، اتبع الخطوات التالية:

    1. في الحقل **جديد**، حدد **تنسيق يستند إلى استبيانات نموذج بيانات**.
    2. في حقل **الاسم**، أدخل **تقرير الاستبيان**.
    3. في الحقل **إصدار نموذج البيانات**، حدد **1**.

        > [!NOTE]
        > - إذا قمت بتحديد إصدار محدد من نموذج البيانات الأساسي، فستُقدم لك بنية الإصدار المقابل لنموذج البيانات كبنية مصدر بيانات **النموذج** بالتنسيق الذي يتم إنشاؤه.
        > - يمكنك ترك هذا الحقل فارغًا. في هذه الحالة، ستُقدم لك بنية إصدار **المسودة** لنموذج البيانات كبنية مصدر بيانات ‬‏‫**النموذج** بالتنسيق الذي يتم إنشاؤه.‬ يمكنك بعد ذلك تعديل النموذج ورؤية هذه التعديلات في التنسيق على الفور. وقد يؤدي هذا الأسلوب إلى تحسين فعالية تصميم حل إعداد التقارير الإلكترونية عند تكوين نموذج البيانات وتعيين النموذج والتنسيق في نفس الوقت.
        > - إذا قمت بتحديد إصدار محدد من نموذج البيانات الأساسي، يمكنك التبديل إلى استخدام إصدار **المسودة** لاحقًا، عند بدء تحرير تنسيق.

    4. في الحقل **تعريف نموذج البيانات**، حدد تعريف **الجذر**.

5. حدد **إنشاء تكوين** لإنشاء التكوين.

#### <a name="import-a-report-template"></a><a name="ImportReportTemplate"></a>استيراد قالب تقرير

1. في صفحة **التكوينات**، في شجرة التكوين، حدد **تقرير الاستبيان**.
2. حدد **المصمم** لبدء تكوين تنسيق مخصص.
3. في صفحة **مصمم التنسيق** في جزء الإجراءات، حدد **استيراد** \> **استيراد من Excel**.
4. في مربع الحوار، اتبع الخطوات التالية:

    1. حدد **إضافة قالب**.
    2. ابحث عن الملف المحفوظ محليًا **Questionnaires report template.xslx** وحدده، ثم حدد **فتح**.
    3. حدد **موافق** لاستيراد القالب.

    ![استيراد قالب تقرير.](./media/er-quick-start1-template-import.png)

يُضاف عنصر التنسيق **Excel\\File** بشكل تلقائي إلى التنسيق القابل للتحرير كعنصر جذر. علاوةً على ذلك، يُضاف عنصر تنسيق **Excel\\نطاق** أو عنصر تنسيق **Excel\\خلية** بشكل تلقائي لكل اسم Excel للقالب المستورد يتم التعرّف عليه. يُضاف تنسيق **Excel\\الرأس** الذي يتضمن عنصر **السلسلة** المتداخل بشكل تلقائي لعكس إعدادات الرأس للقالب المستورد.

![تنسيق البنية الذي يتضمن العناصر المضافة تلقائيًا في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-template-import2.png)

#### <a name="configure-a-format"></a><a name="ConfigureFormat"></a>تكوين تنسيق

1. في الصفحة **مصمم التنسيق**، في شجرة التنسيق، حدد عنصر الجذر **Excel‎**.
2. على علامة التبويب **تنسيق** على الجانب الأيسر من الصفحة، في حقل **الاسم**، أدخل <a name="AddFormatRootElement"></a>**تقرير**.
3. في الحقل **تفضيلات اللغة**، حدد **تفضيلات المستخدم** لتشغيل التقرير بلغة المستخدم المفضلة.
4. في الحقل **تفضيلات الثقافة**، حدد **تفضيلات المستخدم** لتشغيل التقرير بثقافة المستخدم المفضلة.

    للحصول على معلومات حول كيفية تحديد سياقات اللغة والثقافة لعملية التقارير الإلكترونية، راجع [تصميم تقارير متعددة اللغات](er-design-multilingual-reports.md).

    ![تكوين إعدادات اللغة والثقافة للتقرير المصمم في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-template-format-structure1.png)

5. في شجرة التنسيق، قم بتوسيع العقدة الجذر، ثم حدد **ResultsGroup**.
6. ضمن علامة التبويب **تنسيق**، في حقل **اتجاه النسخ المتماثل**، حدد **بلا نسخ متماثل**، لأنك لا تتوقع أن يكون لديك مجموعات نتائج متعددة لاستبيان واحد.

    ![تعريف اتجاه النسخ المتماثل لعناصر تنسيق النطاق في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-template-format-structure2.png)

7. حدد **حفظ**.

#### <a name="define-the-data-binding-for-a-report-title"></a><a name="DefineFormatBindings"></a>تعريف ربط البيانات لعنوان التقرير

يجب تحديد ربط بيانات لعنصر التنسيق المستخدم لملء عنوان التقرير الذي تم إنشاؤه.

1. في صفحة **مصمم التنسيق**، على علامة تبويب **التعيين** إلى اليسار، حدد العنصر **التقرير\\عنوان التقرير**.
2. حدد **تحرير المعادلة**.
3. في محرر المعادلة، حدد **ترجمة**.
4. في مربع الحوار **نص الترجمة**، اتبع الخطوات التالية:

    1. في حقل **معرف التسمية**، أدخل **عنوان التقرير**.
    2. في حقل **النص باللغة الافتراضية**، أدخل **تقرير الاستبيان**.
    3. حدد **ترجمة**، ثم حدد **حفظ**.
    4. حدد **ترجمة** لإغلاق مربع الحوار **ترجمة النص**.

5. أغلق محرر المعادلة.

    ![تكوين الربط لملء العنوان في تقرير منشأ.](./media/er-quick-start1-add-report-title-label.png)

يمكنك استخدام هذا الأسلوب لجعل كافة التسميات الأخرى للقالب الحالي تعتمد على اللغة. لمزيد من المعلومات حول كيفية ترجمة التسميات المضافة لتكوين تقارير إلكترونية واحد إلى كافة اللغات المدعومة، راجع [تصميم تقارير متعددة اللغات](er-design-multilingual-reports.md).

#### <a name="review-model-data-source"></a><a name="ReviewModelDataSource"></a>مراجعة مصدر بيانات النموذج

1. في صفحة **مصمم التنسيق**، على علامة تبويب **التعيين**، حدد مصدر بيانات <a name="ModelDSName"></a>**النموذج** الذي يمثل نموذج البيانات الأساسي لتنسيق التقارير الإلكترونية هذا.
2. حدد **تحرير**.
3. راجع المعلومات الموجودة في مربع الحوار **خصائص مصدر البيانات**. ويمثل مصدر البيانات هذا الإصدار 1 من مكون نموذج البيانات **الاستبيانات** في تكوين التقارير الإلكترونية **نموذج الاستبيانات**.

![خصائص مصدر بيانات النموذج في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-model-data-source.png)

#### <a name="bind-format-elements-to-data-source-fields"></a><a name="BindFormatElements"></a>ربط عناصر التنسيق بحقول مصدر البيانات

لتحديد كيفية ملء قالب في وقت التشغيل، يجب أن تقوم بربط كل عنصر تنسيق مقترن باسم Excel مناسب بحقل واحد في مصدر بيانات التنسيق هذا.

1. في الصفحة **مصمم التنسيق** في شجرة التنسيق، حدد عنصر التنسيق **التقرير\\اسم الشركة**.
2. على علامة تبويب **التعيين**، حدد حقل مصدر البيانات **model.CompanyName** لنوع **السلسلة**.
3. حدد **ربط** لإدخال اسم شركة في قالب.
4. في شجرة التنسيق، حدد العنصر **التقرير\\الاستبيان**.
5. على علامة تبويب **التنسيق**، حدد حقل مصدر البيانات **model.Questionnaire** لنوع **قائمة السجلات**.
6. حدد **ربط**.
7. حدد **إظهار التفاصيل** لعرض مزيد من التفاصيل لتنسيق العناصر.

    يتم تكوين تنسيق نطاق **الاستبيان‏‎** كمنسوخ عموديًا. عند ربطه بمصدر بيانات من النوع **قائمة السجلات**، يتم تكرار نطاق **الاستبيان** المناسب لقالب Excel لكل سجل من سجلات مصدر البيانات المرتبط.
 
    ![ربط عنصر تنسيق نطاق الاستبيان إلى مصادر بيانات قائمة السجلات المناسبة في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-bindings1.png)

    بسبب تحديد نطاق **الاستبيان** لقالب Excel بين الصفوف من 5 إلى 14، يتم تكرار هذه الصفوف لكل استبيان تم الإبلاغ عنه.

    ![صفوف في قالب Excel سيتم تكرارها في تقرير يتم إنشاؤه لكل سجل من مصادر بيانات قائمة السجلات.](./media/er-quick-start1-template-questionnaire-range.png)

8. قم بتكوين روابط مماثلة لعناصر التنسيق المتبقية، كما هو موضح في الجدول التالي.

    > [!NOTE]
    > في هذا الجدول، تفترض المعلومات الموجودة في العمود "مسار مصدر البيانات" أن ميزة [المسار النسبي](relative-path-data-bindings-er-models-format.md)لإعداد التقارير الإلكترونية هي قيد التشغيل.

    | مسار عنصر التنسيق                                      | مسار مصدر البيانات |
    |----------------------------------------------------------|------------------|
    | Excel\\عنوان التقرير                                       | **\@"GER\_LABEL:ReportTitle"** |
    | Excel\\اسم الشركة                                       | **model.CompanyName** |
    | Excel\\Questionnaire                                     | **model.Questionnaire** |
    | Excel\\Questionnaire\\Active                             | **\@.Active**، حيث **\@** هو **model.Questionnaire** |
    | Excel\\Questionnaire\\Code                               | **\@.Code** |
    | Excel\\Questionnaire\\Description                        | **\@.Description** |
    | Excel\\Questionnaire\\QuestionnaireType                  | **\@.QuestionnaireType** |
    | Excel\\Questionnaire\\QuestionOrder                      | **\@.QuestionOrder** |
    | Excel\\Questionnaire\\ResultsGroup\\Code\_               | **\@.ResultsGroup.Code** |
    | Excel\\Questionnaire\\ResultsGroup\\Description\_        | **\@.ResultsGroup.Description** |
    | Excel\\Questionnaire\\ResultsGroup\\MaxNumberOfPoints    | **\@.ResultsGroup.MaxNumberOfPoint** |
    | Excel\\Questionnaire\\Question                           | **\@.Question** |
    | Excel\\Questionnaire\\Question\\CollectionSequenceNumber | **\@.CollectionSequenceNumber**، حيث **\@** هو **model.Questionnaire.Question** |
    | Excel\\Questionnaire\\Question\\Id                       | **\@.Id** |
    | Excel\\Questionnaire\\Question\\MustBeCompleted          | **\@.MustBeCompleted** |
    | Excel\\Questionnaire\\Question\\PrimaryQuestion          | **\@.PrimaryQuestion** |
    | Excel\\Questionnaire\\Question\\SequenceNumber           | **\@.SequenceNumber** |
    | Excel\\Questionnaire\\Question\\Text                     | **\@.Text** |
    | Excel\\Questionnaire\\Question\\Answer                   | **\@.Answer** |
    | Excel\\Questionnaire\\Question\\Answer\\CorrectAnswer    | **\@.CorrectAnswer**، حيث **\@** هو **model.Questionnaire.Answer** |
    | Excel\\Questionnaire\\Question\\Answer\\Points           | **\@.Points** |
    | Excel\\Questionnaire\\Question\\Answer\\Text             | **\@.Text** |

9. عند الانتهاء، حدد **حفظ**.

يبين الرسم التوضيحي التالي الحالة النهائية لروابط البيانات المكوّنة في صفحة **مصمم التنسيق**.

![روابط البيانات المكوّنة في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-bindings2.png)

> [!IMPORTANT]
> تمثل المجموعة الكاملة من مصادر البيانات والروابط المحدد مكون تعيين التنسيق للتنسيق المكوّن. يتم استدعاء تعيين التنسيق هذا عند تشغيل التنسيق المكوّن لإنشاء التقارير.

### <a name="run-a-designed-format-from-er"></a><a name="RunFormatFromER"></a>تشغيل تنسيق مصمّم من التقارير الإلكترونية

يمكنك الآن تشغيل تنسيق مصمّم لأغراض الاختبار من صفحة **التكوينات**.

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوين**، في شجرة التكوين، وسَّع **نموذج الاستبيان**، ثم حدد **تقرير الاستبيان**.
3. حدد **المصمم** لإصدار التنسيق بحالة **المسودة**.
4. في صفحة **مصمم التنسيق**، حدد **تشغيل**.
5. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
6. حدد **موافق** لتأكيد خيار التصفية.
7. حدد **موافق** لتشغيل التقرير.
8. راجع التقرير المُنشأ.

بشكل [افتراضي](electronic-reporting-destinations.md#default-behavior)، يتم تسليم تقرير مُنشأ كملف Excel يمكنك تنزيله. تظهر الأشكال التوضيحية التالية صفحتين للتقرير الذي تم إنشاؤه بتنسيق Excel.

![مثال لتقرير تم إنشاؤه بتنسيق Excel، الصفحة رقم 1.](./media/er-quick-start1-report1a.png)

![مثال لتقرير تم إنشاؤه بتنسيق Excel، الصفحة رقم 2.](./media/er-quick-start1-report1b.png)

## <a name="tune-a-designed-format"></a><a name="TuneFormat"></a>ضبط تنسيق مصمّم

### <a name="modify-a-format-to-change-the-name-of-a-generated-document"></a><a name="ModifyToChangeName"></a>تعديل تنسيق لتغيير اسم مستند تم إنشاؤه

بشكل افتراضي، تتم تسمية مستند تم إنشاؤه باستخدام الاسم المستعار للمستخدم الحالي. ومن خلال تعديل التنسيق، يمكنك تغيير هذا السلوك بحيث تتم تسمية مستند تم إنشاؤه استنادًا إلى المنطق المخصص. على سبيل المثال، يمكنك إسناد مستند مُنشـأ إلى تاريخ ووقت جلسة العمل الحالية وإلى عنوان التقرير.

1. في الصفحة **مصمم التنسيق**، حدد عنصر الجذر **التقرير**.
2. في علامة التبويب **التعيين**، حدد **تحرير اسم الملف**.
3. في حقل **المعادلة**، أدخل **CONCATENATE (\@"GER\_LABEL:ReportTitle", " - ", DATETIMEFORMAT(SESSIONNOW(), "yyyy-MM-dd hh-mm-ss"))**.
4. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
5. حدد **حفظ**.

### <a name="modify-a-format-to-change-the-order-of-questions"></a><a name="ModifyToOrder"></a>تعديل تنسيق لتغيير ترتيب الأسئلة

لا يتم ترتيب الأسئلة بشكل صحيح في تقرير تم إنشاؤه. يمكنك تغيير الترتيب عن طريق تعديل التنسيق.

1. في الصفحة **مصمم التنسيق**، حدد عنصر الجذر **التقرير**.
2. على علامة التبويب **التعيين** في شجرة التنسيق، وسّع **التقرير\\الاستبيان\\السؤال**.

    ![عنصر تنسيق السؤال لنوع النطاق في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-bindings3.png)

3. في علامة التبويب **التعيين**، حدد **model.Questionnaire**.
4. حدد **إضافة** \> **Functions\\Calculated field**، ثم في حقل **الاسم**، أدخل **OrderedQuestions**.
5. حدد **تحرير المعادلة**.
6. في محرر المعادلات، في حقل **المعادلة**، أدخل **ORDERBY (model.Questionnaire.Question, model.Questionnaire.Question.SequenceNumber)** لترتيب قائمة أسئلة الاستبيان الحالي بواسطة رقم ترتيب التسلسل.
7. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
8. حدد **موافق** لإكمال إدخال حقل محسوب جديد.
9. في علامة التبويب **التعيين**، حدد **model.Questionnaire.OrderedQuestions**.
10. في شجرة التنسيق، حدد **Excel\\Questionnaire\\Question**.
11. حدد **ربط**، ثم أكد أن مسار **model.Questionnaire.Questions** الحالي تم استبداله بمسار **model.Questionnaire.OrderedQuestions** الجديد في جميع روابط العناصر المتداخلة.
12. حدد **حفظ**.

![ربط عنصر تنسيق السؤال بمصدر بيانات OrderedQuestions الذي تم تكوينه في مصمم عمليات التقارير الإلكترونية.](./media/er-quick-start1-bindings4.png)

### <a name="run-a-modified-format-from-er"></a><a name="RunFormatFromER2"></a>تشغيل تنسيق معدّل من التقارير الإلكترونية

يمكنك الآن تشغيل تنسيق معدل لأغراض الاختبار من إطار عمل إعداد التقارير الإلكترونية.

1. في صفحة **مصمم التنسيق**، حدد **تشغيل**.
2. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
3. حدد **موافق** لتأكيد خيار التصفية.
4. حدد **موافق** لتشغيل التقرير.
5. راجع التقرير المُنشأ.

يوضح الرسم التوضيحي التالي التقرير الذي تم إنشاؤه بتنسيق Excel حيث يتم ترتيب الأسئلة بشكل صحيح.

![تقرير مُنشأ بتنسيق Excel يحتوي على أسئلة تم ترتيبها بشكل صحيح.](./media/er-quick-start1-report2.png)

### <a name="complete-the-format-design"></a><a name="CompleteFormat"></a>إكمال تصميم التنسيق

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، وسَّع **نموذج الاستبيان**، ثم حدد **تقرير الاستبيان**.
3. في علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
4. حدد **تغيير الحالة** \> **مكتمل‏‎**.

تم تغيير حالة الإصدار 1.1 من هذا التكوين من **مسودة** إلى **مكتمل**. لم يعد من الممكن تغيير الإصدار 1.1. يحتوي هذا الإصدار على التنسيق المكوّن ويمكن استخدامه لطباعة التقرير المخصص. تم إنشاء الإصدار 1.2 من هذا التكوين وهو بالحالة **مسودة**. يمكنك تحرير هذا الإصدار لتعديل تنسيق تقرير **الاستبيان**.

![تكوين إعداد التقارير الإلكترونية القابلة للتعديل في صفحة التكوينات.](./media/er-quick-start1-format-configuration.png)

> [!NOTE]
> التنسيق المكوّن هو تصميم تقرير **الاستبيان** ولا يحتوي علي أي علاقات ببيانات اصطناعية خاصة بـ Finance.

## <a name="develop-application-artefacts-to-call-the-designed-report"></a><a name="DevelopCustomCode"></a>تطوير بيانات اصطناعية للتطبيق لاستدعاء التقرير المصمّم

كمستخدم لديه دور مسؤول النظام، يجب تطوير منطق جديد بحيث يمكن استدعاء التنسيق المكوّن للتقارير الإلكترونية من واجهة مستخدم التطبيق (UI) لإنشاء التقرير المخصص. في الوقت الحالي، لا تقدم التقارير الإلكترونية أي إمكانية لتكوين نوع المنطق هذا. وبالتالي، هناك بعض الأعمال الهندسية المطلوبة. 

لتطوير المنطق الجديد، يجب نشر مخطط يدعم البناء المستمر. لمزيد من المعلومات ، راجع [نشر مخططات تدعم البناء المستمر والتنفيذ التلقائي للاختبار‬ات](../perf-test/continuous-build-test-automation.md). يجب أن يكون لديك أيضًأ حق الوصول إلى بيئة التطوير لهذا المخطط. لمزيد من المعلومات حول واجهة API للتقارير الإلكترونية، راجع [واجهة API لإطار عمل إعداد التقارير الإلكترونية](er-apis-app73.md).

### <a name="modify-source-code"></a><a name="ModifySourceCode"></a>تعديل التعليمات البرمجية المصدر

#### <a name="add-a-data-contract-class"></a><a name="DataContractClass"></a>إضافة فئة عقد بيانات

أضف الفئة الجديدة **QuestionnairesErReportContract** إلى مشروع Microsoft Visual Studio، واكتب التعليمات البرمجية التي تحدد عقد البيانات الذي يجب استخدامه لتشغيل تنسيق التقارير الإلكترونية المكوّن.

```xpp
/// <summary>
///     This class is the data contract class for the <c>QuestionnairesErReportDP</c> class.
/// </summary>
/// <remarks>
///    This is the data contract class for the Questionnaires ER report.
/// </remarks>
[
    DataContractAttribute,
    SysOperationContractProcessingAttribute(classStr(QuestionnairesErReportUIBuilder))
    ]
    public class QuestionnairesErReportContract extends ERFormatMappingRunBaseContract implements SysOperationValidatable
{
    ERFormatMappingId formatMapping;

    /// <summary>
    ///    Validates the report parameters.
    /// </summary>
    /// <returns>
    ///    true if no errors; otherwise, false.
    /// </returns>
    public boolean validate()
    {
        boolean ret = true;
        if (!formatMapping)
        {
            ret = checkFailed(strFmt("@SYS26332", new SysDictType(extendedTypeNum(ERFormatMappingId)).label()));
        }
        return ret;
    }
    [
        DataMemberAttribute('FormatMapping'),
        SysOperationLabelAttribute(literalstr("@ElectronicReporting:FormatMapping")),
        SysOperationHelpTextAttribute(literalstr("@ElectronicReporting:FormatMapping"))
    ]
    public ERFormatMappingId parmFormatMapping(ERFormatMappingId _formatMapping = formatMapping)
    {
        formatMapping = _formatMapping;
        return formatMapping;
    }
}
```

#### <a name="add-a-ui-builder-class"></a><a name="UIBuilderClass"></a>إضافة فئة منشئ واجهة المستخدم

أضف الفئة الجديدة **QuestionnairesErReportUIBuilder** إلى مشروع Visual Studio، واكتب التعليمات البرمجية لإنشاء مربع حوار وقت التشغيل الذي سيتم استخدامه للبحث عن معرف تعين التنسيق لتنسيق التقارير الإلكترونية الذي يجب تشغيله. التعليمات البرمجية المتوفرة تبحث فقط عن تنسيقات التقارير الإلكترونية التي تحتوي على مصدر بيانات من النوع **نموذج البيانات** الذي يشير إلى نموذج البيانات **[الاستبيانات](#DataModeName)** باستخدام تعريف **[الجذر](#RootDefinitionName)**.

> [!NOTE]
> بدلاً من ذلك، يمكنك استخدام نقاط تكامل التقارير الإلكترونية لتصفية تنسيقات التقارير الإلكترونية. لمزيد من المعلومات، راجع [واجهة API لإظهار بحث تعيين التنسيق](er-apis-app10-0-11.md#api-to-show-a-format-mapping-lookup).

```xpp
/// <summary>
/// The UIBuilder class for Questionnaires ER report
/// </summary>
class QuestionnairesErReportUIBuilder extends SysOperationAutomaticUIBuilder
{
    public const str ERQuestionnairesModel = 'Questionnaires';
    public const str ERQuestionnairesDataContainer = 'Root';

    /// <summary>
    /// Action after build of the dialog UI.
    /// </summary>
    public void postBuild()
    {
        DialogField formatMapping;
        super();
        formatMapping = this.bindInfo().getDialogField(this.dataContractObject(),
            methodStr(QuestionnairesErReportContract, parmFormatMapping));
        formatMapping.registerOverrideMethod(
            methodStr(FormReferenceControl, lookupReference),
            methodStr(QuestionnairesErReportUIBuilder, formatMappingLookup),
            this);
    }

    /// <summary>
    /// Performs the lookup form for format mapping.
    /// </summary>
    /// <param name="_referenceGroupControl">
    /// The control to perform lookup form.
    /// </param>
    public void formatMappingLookup(FormReferenceControl _referenceGroupControl)
    {
        ERObjectsFactory::createFormatMappingTableLookupForControlAndModel(
            _referenceGroupControl,
            ERQuestionnairesModel,
            ERQuestionnairesDataContainer).performFormLookup();
    }
}
```

#### <a name="add-a-data-provider-class"></a><a name="DataProviderClass"></a>إضافة فئة موفر بيانات

أضف الفئة الجديدة **QuestionnairesErReportDP** إلى مشروع Visual Studio، واكتب التعليمات البرمجية التي تقدم موفر البيانات الذي يجب استخدامه لتشغيل تنسيق التقارير الإلكترونية المكوّن. تشتمل التعليمات البرمجية المتوفرة علي عقد البيانات الخاص بموفر البيانات هذا فقط.

```xpp
/// <summary>
/// Data provider class for Questionnaires ER report.
/// </summary>
public class QuestionnairesErReportDP
{
    QuestionnairesErReportContract contract;
    public static QuestionnairesErReportDP construct()
    {
        QuestionnairesErReportDP  dataProvider;
        dataProvider = new QuestionnairesErReportDP();
        return dataProvider;
    }
}
```

#### <a name="add-a-labels-file"></a><a name="LabelsFile"></a>إضافة ملف تسميات

أضف ملف التسميات الجديد **QuestionnairesErReportLabels\_en-US** إلى مشروع Visual Studio، وحدد التسميات التالية لموارد واجهة المستخدم التالية:

- أضف تسمية **\@QuestionnairesReport** لعنصر قائمة جديد يحتوي على النص التالي باللغة US English (en-US): **تقرير الاستبيانات (مشغّل بواسطة التقارير الإلكترونية)**
- التسمية **\@QuestionnairesReportBatchJobDescription** لعنوان وظيفة دُفعية إذا تمت جدولة تنسيق التقارير الإلكترونية لتنفيذه كوظيفة دُفعية.

#### <a name="add-a-report-service-class"></a><a name="ServiceClass"></a>إضافة فئة خدمة تقرير

أضف الفئة الجديدة **QuestionnairesErReportService** إلى مشروع Visual Studio واكتب تعليمات برمجية تستدعي تنسيق تقارير إلكترونية، ويحدده بواسطة معرف تعيين التنسيق، ويوفر عقد بيانات كمعلمة.

```xpp
using Microsoft.Dynamics365.LocalizationFramework;
/// <summary>
/// The electronic reporting service class for Questionnaires ER report
/// </summary>
class QuestionnairesErReportService extends SysOperationServiceBase
{
    public const str ERModelDataSourceName = 'model';
    public const str DefaultExportedFileName = 'Questionnaires report';
    public const str ParametersDataSourceName = 'RunTimeParameters';

    /// <summary>
    /// Generates report by using Electronic reporting framework
    /// </summary>
    /// <param name = "_contract">The Questionnaires report contract</param>
    public void generateReportByGER(QuestionnairesErReportContract _contract)
    {
        ERFormatMappingId formatMappingId;
        QuestionnairesErReportDP  dataProvider;
        dataProvider = QuestionnairesErReportDP::construct();
        formatMappingId = _contract.parmFormatMapping();
        if (formatMappingId)
        {
            try
            {
                ERIModelDefinitionParamsAction parameters = new ERModelDefinitionParamsUIActionComposite()
                    .add(new ERModelDefinitionObjectParameterAction(ERModelDataSourceName, ParametersDataSourceName, _contract, true));

                // Call ER to generate the report.
                ERIFormatMappingRun formatMappingRun = ERObjectsFactory::createFormatMappingRunByFormatMappingId(formatMappingId, DefaultExportedFileName);
                if (formatMappingRun.parmShowPromptDialog(true))
                {
                    formatMappingRun.withParameter(parameters);
                    formatMappingRun.withFileDestination(_contract.getFileDestination());
                    formatMappingRun.run();
                }
            }
            catch
            {
                // An error occurred while exporting data.
                error("@SYP4861341");
            }
        }
        else
        {
            // There is no data available.
            info("@SYS300117");
        }
    }
}
```

عندما يجب استخدام تنسيق التقارير الإلكترونية الذي يقوم بتشغيل بيانات التطبيق، يجب عليك تكوين مصدر بيانات من النوع **نموذج بيانات** في تعيين التنسيق. يشير مصدر البيانات هذا إلى جزء معين من نموذج البيانات المحدد باستخدام تعريف جذر مفرد. يستدعي تنسيق التقارير الإلكترونية، عند تشغيله، مصدر البيانات هذا للوصول إلى تعيين تنسيق التقارير الإلكترونية المناسب الذي تم تكوينه لنموذج محدد وتعريف جذر.

يمكن تمرير كافة المعلومات التي قد تعمل على تحضيرها في التعليمات البرمجية المصدر وتخزينها كجزء من عقد البيانات إلى تنسيق التقارير الإلكترونية قيد التشغيل باستخدام تعيين نموذج تقارير إلكترونية من هذا النوع. في تعيين نموذج التقارير الإلكترونية، يجب تكوين مصدر بيانات من نوع **الكائن** يشير إلى فئة **[QuestionnairesErReportContract](#DataContractClass)**. لتحديد تعيين نموذج، يجب تحديد مصدر بيانات يستدعي تعيين النموذج هذا. في التعليمات البرمجية المتوفرة، يتم تحديد مصدر البيانات هذا بواسطة الثابت **ERModelDataSourceName** الذي لديه قيمة **[النموذج](#ModelDSName)**. لتحديد مصدر البيانات المستخدم لعرض عقد البيانات في تعيين النموذج، يجب تحديد اسم مصدر البيانات. في التعليمات البرمجية المتوفرة، يتم تحديد هذا الاسم بواسطة الثابت **ParametersDataSourceName** الذي لديه قيمة <a name="DataContractDSName"></a>**RunTimeParameters**.

> [!NOTE]
> في بيئة جديدة، قد يلزم تحديث بيانات تعريف التقارير الإلكترونية بحيث يتوفر هذا النوع من الفئات في مصمم تعيين نموذج التقارير الإلكترونية. لمزيد من المعلومات، راجع [تكوين إطار عمل إعداد التقارير الإلكترونية](electronic-reporting-er-configure-parameters.md#frequently-asked-questions).

#### <a name="add-a-report-controller-class"></a><a name="ControllerClass"></a>إضافة فئة مراقب التقارير

أضف الفئة **QuestionnairesErReportController** إلى مشروع Visual Studio واكتب التعليمات البرمجية التي يتم تشغيلها على تنسيق التقارير الإلكترونية في الوضع المتزامن أو وضع الدُفعة، كما تفضل، في مربع الحوار المبني بالاستناد إلى منطق فئة **QuestionnairesErReportUIBuilder** المتوفرة.

```xpp
/// <summary>
/// The controller for Questionnaires ER report
/// </summary>
class QuestionnairesErReportController extends ERFormatMappingRunBaseController
{
    /// <summary>
    /// The main entrance of the controller
    /// </summary>
    /// <param name = "args">The arguments</param>
    public static void main(Args args)
    {
        QuestionnairesErReportController operation;
        operation = new QuestionnairesErReportController(
            classStr(QuestionnairesErReportService),
            methodStr(QuestionnairesErReportService, generateReportByGER),
            SysOperationExecutionMode::Synchronous);
        operation.startOperation();
    }

    /// <summary>
    /// Gets caption of the dialog.
    /// </summary>
    /// <returns>Caption of the dialog</returns>
    public ClassDescription defaultCaption()
    {
        ClassDescription batchDescription;
        batchDescription = "Questionnaires report (powered by ER)";
        return batchDescription;
    }
}
```

#### <a name="add-a-menu-item"></a><a name="MenuItem"></a>إضافة عنصر قائمة

أضف عنصر قائمة **QuestionnairesErReport** الجديد إلى مشروع Visual Studio. في خاصية **الكائن**، يشير عنصر القائمة هذا إلى فئة **QuestionnairesErReportController**، ويتم استخدامه لتحديد إذن المستخدم لتحديده وتشغيل تنسيق تقارير إلكترونية. في خاصية **التسمية**، يشير عنصر القائمة هذا إلى تسمية **\@QuestionnairesReport** التي أنشأتها في وقت سابق، بحيث يتم تقديم النص الصحيح في واجهة برمجة تطبيقات التطبيق.

#### <a name="add-a-menu-item-to-a-menu"></a><a name="Menu"></a>إضافة عنصر قائمة إلى قائمة

أضف قائمة **KM** الموجودة إلى مشروع Visual Studio. يجب إضافة عنصر **QuestionnairesErReport** جديد من النوع **إخراج** إلى هذه القائمة. يجب أن يشير هذا العنصر إلى عنصر قائمة **QuestionnairesErReport** الذي ورد وصفه في القسم السابق.

#### <a name="build-a-visual-studio-project"></a><a name="BuildVSProject"></a>إنشاء مشروع Visual Studio

قم بإنشاء مشروع لجعل عنصر قائمة جديد متوفرًا للمستخدمين.

### <a name="run-a-format-from-the-application"></a><a name="RunFormatFromApp"></a>تشغيل تنسيق من التطبيق

1. انتقل إلى **الاستبيان** \> **تصميم** \> **تقرير الاستبيانات (مشغّل بواسطة التقارير الإلكترونية)‬**.

    ![تحديد عنصر قائمة الاستبيانات (مشغّل بواسطة التقارير الإلكترونية)‬‏‫ في الوحدة النمطية للاستبيان لتشغيل التقارير الإلكترونية المكوّن.](./media/er-quick-start1-application-menu-modified.png)

2. في مربع الحوار، في حقل **تعيين التنسيق**، حدد **تقرير الاستبيانات**.
3. حدد **موافق**.
4. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
5. حدد **موافق** لتأكيد خيار التصفية.
6. حدد **موافق** لتشغيل التقرير.

    ![تحديد معايير التحديد في مربع حوار التقارير الإلكترونية.](./media/er-quick-start1-report-run-dialog-page.png)

7. راجع التقرير المُنشأ.

## <a name="tune-a-designed-er-solution"></a><a name="TuneSolution"></a>ضبط حل إعداد التقارير الإلكترونية المصمّم

يمكنك تعديل حل التقارير الإلكترونية المكوّن بحيث يستخدم فئة موفر البيانات التي تم تطويرها للوصول إلى تفاصيل تنسيق تقارير إلكترونية قيد التشغيل، بحيث يدخل اسم تنسيق التقارير الإلكترونية هذا في تقرير بتم إنشاؤه.

### <a name="modify-a-model-mapping"></a><a name="ModifyModelMapping"></a>تعديل تعيين النموذج

#### <a name="add-data-sources-to-access-a-data-contract-object"></a><a name="AddDataSource1"></a>إضافة مصادر بيانات للوصول إلى كائن عقد البيانات

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، وسَّع **نموذج الاستبيان**، ثم حدد **تعيين الاستبيان**.
3. Select **الصمم** لفتح صحة **تعيين النموذج إلى مصدر البيانات**.
4. حدد **المصمم** لفتح التعيين المحدد في مصمم تعيين النموذج.
5. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\كائن‎**.
6. حدد **إضافة جذر** في جزء **مصادر البيانات** .
7. في مربع الحوار، في حقل **الاسم**، أدخل **[RunTimeParameters](#DataContractDSName)**، كما هو محدد في التعليمات البرمجية المصدر في الفئة **QuestionnairesErReportService**.
8. في حقل **الفئة**، أدخل **[QuestionnairesErReportContract](#DataContractClass)**، الذي تم ترميزه في وقت سابق.
9. حدد **موافق**.
10. قم بتوسيع **RunTimeParameters**.

يوفر مصدر البيانات المضاف معلومات حول معرف السجل الخاص بتعيين تنسيق التقارير الإلكترونية قيد التشغيل.

![مصدر بيانات مضاف في مصمم تعيين نموذج التقارير الإلكترونية.](./media/er-quick-start1-mapping3.png)

#### <a name="add-a-data-source-to-access-er-format-mapping-records"></a><a name="AddDataSource2"></a>إضافة مصدر بيانات للوصول إلى سجلات تعيين تنسيق التقارير الإلكترونية

تابع تحرير تعيين النموذج المحدد عن طريق إضافة مصدر بيانات للوصول إلى سجلات تعيين تنسيق التقارير الإلكترونية.

1. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **Dynamics 365 for Operations\\Table records**.
2. حدد **إضافة جذر** في جزء **مصادر البيانات** .
3. في مربع الحوار، في الحقل **الاسم**، أدخل **ER1**.
4. في حقل **الجدول**، أدخل **ERFormatMappingTable‎**.
5. حدد **موافق**.

#### <a name="add-a-data-source-to-access-a-format-mapping-record-of-a-running-er-format"></a><a name="AddDataSource3"></a>إضافة مصدر بيانات للوصول إلى سجل تعيين التنسيق لتنسيق تقارير إلكترونية قيد التشغيل

تابع تحرير تعيين النموذج المحدد عن طريق إضافة مصدر بيانات للوصول إلى سجل تعيين تنسيق التقارير الإلكترونية قيد التشغيل.

1. في صفحة **مصمم تعيين النموذج**، في جزء **أنواع مصادر البيانات**، حدد **الدالات\\الحقل المحسوب**.
2. حدد **إضافة جذر** في جزء **مصادر البيانات** .
3. في مربع الحوار، في الحقل **الاسم**، أدخل **ER2**.
4. حدد **تحرير المعادلة**.
5. في محرر المعادلة، في حقل **المعادلة**، أدخل **FIRSTORNULL (FILTER(ER1, ER1.RecId = RunTimeParameters.parmFormatMapping))**.
6. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
7. حدد **موافق**.

#### <a name="enter-the-name-of-the-running-er-format-in-the-data-model"></a><a name="AddBinding"></a>إدخال اسم تنسيق تقارير إلكترونية قيد التشغيل في نموذج البيانات

تابع تحرير تعيين النموذج المحدد بحيث يتم إدخال اسم تنسيق التقارير الإلكترونية قيد التشغيل في نموذج البيانات.

1. في صفحة **مصمم تعيين النموذج**، في جزء **نموذج البيانات** قم بتوسيع **ExecutionContext**، ثم حدد **ExecutionContext\\FormatName**.
2. في جزء **نموذج البيانات**، حدد **تحرير** لتكوين ربط البيانات لحقل نموذج البيانات المحدد.
3. في محرر المعادلة، في حقل **المعادلة**، أدخل **FIRSTORNULL (ER2.'\>Relations'.Format).Name**.
4. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.

لأنك استخدمت الحقل **FormatName**، يقوم تعيين النموذج المكوّن الآن بكشف اسم تنسيق التقارير الإلكترونية الذي يستدعي تعيين هذا النموذج أثناء التنفيذ.

![ربط حقل نموذج البيانات بأسلوب مصدر البيانات المضاف في مصمم تعيين نموذج التقارير الإلكترونية.](./media/er-quick-start1-mapping4.png)

#### <a name="complete-the-design-of-the-model-mapping"></a><a name="CompleteModelMapping2"></a>إكمال تصميم تعيين النموذج

1. في صفحة **مصمم تعيين النموذج**، حدد **حفظ**.
2. قم بإغلاق الصفحة.
3. أغلق صفحة تعيينات النماذج.
4. في صفحة **التكوينات**، في شجرة التكوين، تأكد من استمرار تحديد تكوين **تعيين الاستبيان**. بعد ذلك، على علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
5. حدد **تغيير الحالة** \> **مكتمل‏‎**.

تم تغيير حالة الإصدار 1.2 من هذا التكوين من **مسودة** إلى **مكتمل**. لم يعد من الممكن تغيير الإصدار 1.2. يحتوي هذا الإصدار على تعيين النموذج الذي تم تكوينه ويمكن استخدامه كأساس لتكوينات إعداد التقارير الإلكترونية الأخرى. تم إنشاء الإصدار 1.3 من هذا التكوين وهو بالحالة **مسودة**. يمكنك تحرير هذا الإصدار لتعديل تعيين نموذج **الاستبيان**.

### <a name="modify-a-format"></a><a name="ModifyFormat"></a>تعديل تنسيق

يمكنك تعديل تنسيق التقارير الإلكترونية المكوّن بحيث يتم عرض اسمه في تذييل التقرير الذي يتم إنشاؤه عند تشغيل تنسيق التقارير الإلكترونية.

#### <a name="add-a-new-format-element"></a><a name="AddFormatElement"></a>إضافة عنصر تنسيق جديد

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، وسَّع **نموذج الاستبيان**، ثم حدد **تقرير الاستبيان**.
3. حدد **المصمم**.
4. في الصفحة **مصمم التنسيق**، حدد عنصر الجذر **التقرير**.
5. حدد **إضافة** لإضافة‏‎ عنصر تنسيق متداخل عنصر جذر **التقرير**.
6. حدد **Excel\\تذييل**.
7. في الحقل **الاسم**، أدخل **التذييل**.
8. حدد **التقرير\التذييل**، ثم حدد **إضافة**.
9. حدد **نص\\سلسلة**.

#### <a name="bind-the-added-format-element"></a><a name="BindAddedFormatElement"></a>ربط عنصر التنسيق المضاف

1. في صفحة **مصمم التنسيق**، على علامة التبويب **التعيين** في شجرة التنسيق، لعنصر **تذييل\\سلسلة** النشط، حدد **تحرير المعادلة**.
2. في محرر المعادلة، في حقل **المعادلة**، أدخل **CONCATENATE ("\&C\&10", FORMAT("Generated by'\%1' ER solution", model.ExecutionContext.FormatName))**.
3. حدد **حفظ** ثم قم بإغلاق محرر المعادلات.
4. حدد **حفظ**.

لقد تم الآن تعديل التنسيق المكوّن بحيث يتم إدخال اسمه في تذييل التقرير الذي تم إنشاؤه باستخدام العنصر **تذييل\\سلسلة**.

![ إضافة عنصر تنسيق التذييل إلى التنسيق الذي تم تكوينه في مصمم عمليات التقارير الإلكترونية‬.](./media/er-quick-start1-template-format-structure3.png)

#### <a name="complete-the-format-design"></a><a name="CompleteFormat2"></a>إكمال تصميم التنسيق

1. أغلق صفحة **مصمم المعادلة**.
2. في صفحة **التكوينات**، في شجرة التكوين، تأكد من استمرار تحديد تكوين **تقرير الاستبيان**. بعد ذلك، على علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
3. حدد **تغيير الحالة** \> **مكتمل‏‎**.

تم تغيير حالة الإصدار 1.2 من هذا التكوين من **مسودة** إلى **مكتمل**. لم يعد من الممكن تغيير الإصدار 1.2. يحتوي هذا الإصدار على التنسيق المكوّن ويمكن استخدامه كأساس لتكوينات إعداد التقارير الإلكترونية الأخرى. تم إنشاء الإصدار 1.3 من هذا التكوين وهو بالحالة **مسودة**. يمكنك تحرير هذا الإصدار لتعديل تقرير **الاستبيان**.

### <a name="run-a-format-from-the-application"></a><a name="RunFormatFromApp2"></a>تشغيل تنسيق من التطبيق

1. انتقل إلى **الاستبيان** \> **تصميم** \> **تقرير الاستبيانات (مشغّل بواسطة التقارير الإلكترونية)‬**.
2. في مربع الحوار، في حقل **تعيين التنسيق**، حدد **تقرير الاستبيانات**.
3. حدد **موافق**.
4. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
5. حدد **موافق** لتأكيد خيار التصفية.
6. حدد **موافق** لتشغيل التقرير.
7. راجع التقرير الذي تم إنشاؤه بتنسيق Excel.

لاحظ أن تذييل التقرير الذي تم إنشاؤه يحتوي على اسم تنسيق التقارير الإلكترونية الذي تم استخدامه لإنشائه.

![التقرير الذي تم إنشاؤه بتنسيق Excel.](./media/er-quick-start1-report4.png)

### <a name="run-a-format-from-er"></a><a name="RunFormatFromER3"></a>تشغيل تنسيق من التقارير الإلكترونية

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في شجرة التكوين، وسَّع **نموذج الاستبيان**، ثم حدد **تقرير الاستبيان**.
3. في جزء الإجراءات، حدد **تشغيل**.
4. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
5. حدد **موافق** لتأكيد خيار التصفية.
6. حدد **موافق** لتشغيل التقرير.
7. راجع التقرير الذي تم إنشاؤه بتنسيق Excel.

لاحظ أن تذييل التقرير الذي تم إنشاؤه لا يحتوي على اسم تنسيق التقارير الإلكترونية الذي تم استخدامه لإنشائها، بسبب عدم تمرير كائن عقد البيانات إلى تعيين النموذج قيد التشغيل عند استدعائه بواسطة تنسيق التقارير الإلكترونية لذي تم تشغيله من التقارير الإلكترونية.

### <a name="configure-a-format-destination-for-on-screen-preview"></a><a name="ConfigureDestination"></a>تكوين وجهة التنسيق للمعاينة على الشاشة

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **وجهة إعداد التقارير الإلكترونية**.
2. في صفحة **وجهة إعداد التقارير الإلكترونية**، أضف سجل وجهة لتنسيق التقارير الإلكترونية **تقرير الاستبيان** المكوّن.
3. على علامة التبويب **وجهة الملف**، قم بإعداد **وجهة** [الشاشة](er-destination-type-screen.md) لمكون تنسيق **التقرير** الذي تمت [إضافته](#AddFormatRootElement) كعنصر جذر لتنسيق التقارير الإلكترونية المكوّن **تقرير الاستبيان**.
4. على علامة التبويب السريعة **إعدادات تحويل PDF**، قم بتكوين الوجهة لتحويل تقرير إلى [تنسيق PDF](electronic-reporting-destinations.md#OutputConversionToPDF) يستخدم اتجاه الصفحة **أفقي**.

![تكوين وجهة الشاشة المخصصة لتنسيق التقارير الإلكترونية على صفحة وجهة التقارير الإلكترونية.](./media/er-quick-start1-destination.png)

### <a name="run-a-format-from-the-application-to-preview-it-as-a-pdf-document"></a><a name="RunFormatFromApp3"></a>تشغيل تنسيق من التطبيق لمعاينته كمستند PDF

1. انتقل إلى **الاستبيان** \> **تصميم** \> **تقرير الاستبيانات (مشغّل بواسطة التقارير الإلكترونية)‬**.
2. في مربع الحوار، في حقل **تعيين التنسيق**، حدد **تقرير الاستبيانات**.
3. حدد **موافق**.
4. في مربع الحوار **معلمات التقارير الإلكترونية‬**، على علامة التبويب السريعة **السجلات المطلوب تضمينها‬**، قم بتكوين خيار التصفية بحيث يتم تضمين الاستبيان **SBCCrsExam** فقط,
5. حدد **موافق** لتأكيد خيار التصفية.

    على علامة التبويب **الوجهات**، لاحظ تعيين حقل **الإخراج** إلى **الشاشة**. إذا كنت ترغب في تغيير الوجهة المكونة، حدد **تغيير**.

    ![مربع الحوار وقت تشغيل التقارير الإلكترونية حيث يمكنك تغيير الوجهة المكونة.](./media/er-quick-start1-run-settings.png)

6. حدد **موافق** لتشغيل التقرير.
7. راجع التقرير الذي تم إنشاؤه بتنسيق PDF.

    ![معاينة على الشاشة للتقرير الذي تم إنشاؤه بتنسيق PDF.](./media/er-quick-start1-preview-PDF.png)

## <a name="additional-resources"></a><a name="References"></a>الموارد الإضافية

- [نظرة عامة حول التقارير الإلكترونية](general-electronic-reporting.md)
- [لغة تركيبة التقارير الإلكترونية](er-formula-language.md)
- [تصميم تقارير متعددة اللغات](er-design-multilingual-reports.md)
- [API إطار عمل التقارير الإلكترونية](er-apis-app73.md)
- [الدالة CASE](er-functions-logical-case.md)
- [الدالة CONCATENATE](er-functions-text-concatenate.md)
- [الدالة DATETIMEFORMAT](er-functions-datetime-datetimeformat.md)
- [الدالة FILTER](er-functions-list-filter.md)
- [الدالة FIRSTORNULL](er-functions-list-firstornull.md)
- [الدالة FORMAT](er-functions-text-format.md)
- [الدالة IF](er-functions-logical-if.md)
- [الدالة ORDERBY](er-functions-list-orderby.md)
- [الدالة SESSIONNOW](er-functions-datetime-sessionnow.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
