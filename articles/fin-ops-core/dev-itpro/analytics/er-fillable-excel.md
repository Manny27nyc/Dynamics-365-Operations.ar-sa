---
title: تصميم تكوين لإنشاء مستندات بتنسيق Excel
description: يصف هذا الموضوع كيفية تصميم تنسيق التقارير الإلكترونية (ER) لملء قالب Excel، ثم إنشاء مستندات صادرة بتنسيق Excel.
author: NickSelin
ms.date: 12/15/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: 87d5929557e5120a5339ee46eac655fd399679d1
ms.sourcegitcommit: f51e74ee9162fe2b63c6ce236e514840795acfe1
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 12/21/2021
ms.locfileid: "7943602"
---
# <a name="design-a-configuration-for-generating-documents-in-excel-format"></a>تصميم تكوين لإنشاء المستندات بتنسيق Excel

[!include[banner](../includes/banner.md)]

يمكن تصميم تكوين تنسيق [إعداد التقارير الإلكترونية (ER)](general-electronic-reporting.md) الذي يحتوي على مكون تنسيق التقارير الإلكترونية الذي يمكنك تكوينه لإنشاء مستند صادر بتنسيق مصنف Microsoft Excel. يجب استخدام مكونات تنسيق ER المحددة لهذا الغرض.

لمعرفة المزيد حول هذه الميزة، اتبع الخطوات الواردة في موضوع، [تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](tasks/er-design-reports-openxml-2016-11.md).

## <a name="add-a-new-er-format"></a>إضافة تنسيق ER جديد

عند إضافة تكوين لتنسيق ER جديد لإنشاء مستند صادر بتنسيق مصنف Excel، يجب عليك إما تحديد قيمة **Excel** لسمة **نوع التنسيق** للتنسيق أو ترك سمة **نوع التنسيق** فارغة.

- إذا قمت بتحديد **Excel**، يمكنك تكوين التنسيق لإنشاء مستند صادر بتنسيق Excel فقط.
- إذا تركت السمة فارغة، يمكنك تكوين التنسيق لإنشاء مستند صادر بأي تنسيق يدعمه إطار عمل ER.

لتكوين مكون تنسيق ER للتكوين، حدد **المصمم** في جزء الإجراءات، وافتح مكون تنسيق ER للتحرير في مصمم تشغيل التقارير الإلكترونية‬.

![صفحة التكوينات.](./media/er-excel-format-add-format.png)

## <a name="excel-file-component"></a>مكون ملف Excel

### <a name="manual-entry"></a>إدخال يدوي

يجب إضافة مكون **ملف\\Excel** إلى تنسيق ER الذي تم تكوينه لإنشاء مستند صادر بتنسيق Excel.

![مكون ملف/ Excel.](./media/er-excel-format-add-file-component.png)

لتحديد مخطط المستند الصادر، قم بإرفاق مصنف Excel يتضمن الملحق .xlsx إلى مكون **ملف\\Excel** كقالب للمستندات الصادرة.

> [!NOTE]
> عندما تقوم بإرفاق قالب يدويًا، يجب عليك استخدام [نوع مستند](../../../fin-ops-core/fin-ops/organization-administration/configure-document-management.md#configure-document-types) تم تكوينه لهذا الغرض في [معلمات ER](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents).

![إضافة مرفق إلى مكون ملف/Excel.](./media/er-excel-format-add-file-component2.png)

لتحديد كيفية ملء القالب المرفق عند تشغيل تنسيق ER المكون، يجب إضافة مكونات **الورقة** و **النطاق** و **الخلية** المتداخلة إلى مكون **ملف\\Excel**. يجب أن يرتبط كل مكون متداخل بعنصر يسمى Excel.

### <a name="template-import"></a>استيراد القالب

يمكنك تحديد **استيراد من Excel** من علامة التبويب **استيراد** من جزء الإجراءات لاستيراد قالب جديد إلى تنسيق ER فارغ. في هذا المثال، سيتم إنشاء مكون **ملف\\Excel** تلقائيًا، وسيتم إرفاق القالب المستورد به. سيتم أيضًا إنشاء كافة مكونات ER المطلوبة تلقائيًا، وذلك استنادًا إلى قائمة العناصر المسماة Excel التي تم اكتشافها.

![تحديد استيراد من Excel.](./media/er-excel-format-import-template.png)

> [!NOTE]
> إذا كنت ترغب في إنشاء عنصر **ورقة** اختياري بتنسيق ER القابل للتحرير، قم بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم**.

## <a name="sheet-component"></a>مكون الورقة

يشير مكون **الورقة** إلى ورقة عمل من مصنف Excel المرفق الذي يجب تعبئته. يتم تعريف اسم ورقه العمل في قالب Excel في خاصية **الورقة** لهذا المكون.

> [!NOTE]
> هذا المكون اختياري لمصنفات Excel التي تحتوي على ورقة عمل واحدة.

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **الورقة** لتحديد ما إذا كان يجب وضع المكون في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم وضع ورقه العمل المناسبة في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، لن يحتوي المستند الذي تم إنشاؤه على أي ورقة عمل.

![مثال لمكون الورقة.](./media/er-excel-format-sheet-component.png)

## <a name="range-component"></a>مكون النطاق

يشير مكون **النطاق** إلى نطاق Excel الذي يجب أن يتم التحكم فيه بواسطة مكون ER هذا. يتم تعريف اسم النطاق في خاصية **نطاق Excel** لهذا المكون.

### <a name="replication"></a>نسخ متماثل

تحدد خاصية **اتجاه النسخ المتماثل** ما إذا كان سيتم تكرار النطاق في المستند المنشأ أم لا:

- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **عدم النسخ المتماثل**، لن يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه.
- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **رأسي**، فسيتم يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه. يتم وضع كل نطاق منسوخ نسخًا متماثلاً أسفل النطاق الأصلي في قالب Excel. يتم تحديد عدد التكرارات حسب عدد السجلات في مصدر بيانات من نوع **قائمة السجلات** المرتبط بمكون ER هذا.
- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **أفقي**، فسيتم يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه. يتم وضع كل نطاق منسوخ نسخًا متماثلاً على يمين النطاق الأصلي في قالب Excel. يتم تحديد عدد التكرارات حسب عدد السجلات في مصدر بيانات من نوع **قائمة السجلات** المرتبط بمكون ER هذا.

لمعرفة المزيد عن النسخ المتماثل الأفقي، اتبع الخطوات الموجودة في [استخدام نطاقات قابلة للتوسيع أفقيًا لإضافة أعمدة في تقارير Excel ديناميكيًا](tasks/er-horizontal-1.md).

### <a name="nested-components"></a>المكونات المتداخلة

يمكن أن يكون لمكون **النطاق** مكونات ER أخرى يتم استخدامها لإدخال القيم في النطاقات المناسبة المسماة Excel.

- في حالة استخدام أي مكون من المجموعة **النصية** لإدخال القيم، يتم إدخال القيمة في نطاق Excel كقيمة نصية.

    > [!NOTE]
    > استخدم هذا النمط لتنسيق القيم التي تم إدخالها استنادا إلى الإعدادات المحلية التي تم تحديدها في التطبيق.

- إذا تم استخدام مكون **الخلية** الخاص بمجموعة **Excel** لإدخال القيم، يتم إدخال القيمة في نطاق Excel كقيمة لنوع البيانات الذي تم تحديد بواسطة ربط مكون **الخلية** هذا (على سبيل المثال، **سلسة** أو **حقيقي** أو **عدد صحيح**).

    > [!NOTE]
    > استخدم هذا النمط لتمكين تطبيق Excel من تنسيق القيم المدخلة استنادا إلى الإعدادات المحلية للكمبيوتر المحلي الذي يقوم بفتح المستند الصادر.

### <a name="enabling"></a>تمكين

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **النطاق** لتحديد ما إذا كان يجب وضع المكون في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم ملء النطاق المناسب في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، وإذا كان هذا النطاق لا يمثل الصفوف أو الأعمدة بأكملها، لن يتم ملء النطاق المناسب في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، وكان هذا النطاق يمثل الصفوف أو الأعمدة بأكملها، فسوف يحتوي المستند الذي تم إنشاؤه على تكل الصفوف والأعمدة كصفوف وأعمدة مخفية.

### <a name="resizing"></a>تغيير

يمكنك تكوين قالب Excel الخاص بك لاستخدام الخلايا لتقديم البيانات النصية. للتأكد من أن النص بأكمله في خلية مرئي في مستند تم إنشاؤه، يمكنك تكوين هذه الخلية لتلتف النص بداخلها تلقائيًا. يمكنك أيضًا تكوين الصف الذي يحتوي على تلك الخلية لضبط ارتفاعه تلقائيًا إذا لم يكن النص الملتف مرئيًا بالكامل. لمزيد من المعلومات، راجع قسم "التفاف النص في خلية" في [إصلاح البيانات التي يتم قصها في الخلايا](https://support.microsoft.com/office/fix-data-that-is-cut-off-in-cells-e996e213-6514-49d8-b82a-2721cef6144e).

> [!NOTE]
> بسبب [قيد Excel](https://support.microsoft.com/topic/you-cannot-use-the-autofit-feature-for-rows-or-columns-that-contain-merged-cells-in-excel-34b54dd7-9bfc-6c8f-5ee3-2715d7db4353) غير معروف، حتى إذا قمت بتكوين الخلايا لالتفاف النص، وقمت بتكوين الصفوف التي تحتوي على تلك الخلايا لضبط ارتفاعها تلقائيًا لملاءمة النص الملتف، فقد لا تتمكن من استخدام ميزتي Excel **الاحتواء التلقائي** و **التفاف النص** للخلايا المدمجة والصفوف التي تحتوي عليها. 

اعتبارًا من الإصدار 10.0.23 من Dynamics 365 Finance، يمكنك إجبار التقارير الإلكترونية (ER) على حساب ارتفاع كل صف تم تكوينه ليلائم ارتفاعه تلقائيًا في مستند تم إنشاؤه الخلايا المتداخلة عندما يحتوي هذا الصف على خلية مدمجة واحدة على الأقل تم تكوينها لالتفاف النص بداخلها. يتم بعد ذلك استخدام الارتفاع المحسوب لتغيير حجم الصف للتأكد من أن جميع الخلايا الموجودة في الصف مرئية في المستند الذي تم إنشاؤه. لبدء استخدام هذه الوظيفة عند تشغيل أي تنسيقات تقارير إلكترونية تم تكوينها لاستخدام قوالب Excel لإنشاء مستندات صادرة، اتبع هذه الخطوات.

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في الصفحة **تكوينات الترجمة**، في قسم **الارتباطات المتعلقة**، حدد **معلمات التقارير الإلكترونية**.
3. في صفحة **معلمات التقارير الإلكترونية**، على علامة التبويب **وقت التشغيل**، قم بتعيين الخيار **الاحتواء التلقائي لارتفاع الصف** إلى **نعم**.

عندما تريد تغيير هذه القاعدة لتنسيق تقارير إلكترونية واحد، قم بتحديث إصدار المسودة لهذا التنسيق باتباع هذه الخطوات.

1. انتقل إلى **إدارة المؤسسة** \> **مساحات العمل** \> **التقارير الإلكترونية**.
2. في الصفحة **تكوينات الترجمة**، في قسم **التكوينات**، حدد **تكوينات إعداد التقارير** .
3. في صفحة **التكوينات**، في شجرة التكوينات في الجزء الأيمن، حدد تكوين إعداد التقارير الإلكترونية المصمم لاستخدام قالب Excel لإنشاء مستندات صادرة.
4. في علامة التبويب السريعة **الإصدارات**، حدد إصدار التكوين بحالة **مسودة**.
5. في جزء الإجراءات، حدد **المصمم**.
6. في صفحة **مصمم التنسيق**، في شجرة التنسيق في الجزء الأيمن، حدد مكون Excel المرتبط بـ قالب Excel.
7. في علامة التبويب **التنسيق**، في حقل **ضبط ارتفاع الصف**، حدد قيمة لتحديد ما إذا كان يجب إجبار التقارير الإلكترونية، في وقت التشغيل، على تغيير ارتفاع الصفوف في مستند صادر يتم إنشاؤه بواسطة تنسيق التقارير الإلكترونية المحرر:

    - **الإعداد الافتراضي** - استخدم الإعداد العام الذي تم تكوينه في حقل **الاحتواء التلقائي لارتفاع الصف** في صفحة **معلمات التقارير الإلكترونية**.
    - **نعم** – تجاوز الإعداد العام، وتغيير ارتفاع الصف في وقت التشغيل.
    - **لا** – تجاوز الإعداد العام، ولا تغير ارتفاع الصف في وقت التشغيل.

## <a name="cell-component"></a>مكون الخلية

يتم استخدام مكون **الخلية** لملء الخلايا والأشكال والصور المسماة Excel. للإشارة إلى كائن باسم Excel والذي يجب تعبئته بواسطة مكون ER **الخلية**، يجب تحديد اسم ذلك الكائن في خاصية **نطاق Excel** لمكون **الخلية**.

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **الخلية** لتحديد ما إذا كان يجب ملء الكائن في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم ملء الكائن المناسب في المستند الذي تم إنشاؤه. يحدد ربط مكون **الخلية** هذا قيمة يتم وضعها في الكائن المناسب.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، فلن يتم ملء الكائن المناسب في المستند الذي تم إنشاؤه.

عند تكوين المكون **خلية** لإدخال قيمة في خلية، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات أساسي (على سبيل المثال، **سلسلة** أو **حقيقي** أو **عدد صحيح**). في هذه الحالة، يتم إدخال القيمة في الخلية كقيمة من نفس نوع البيانات.

عند تكوين المكون **خلية** لإدخال قيمة في شكل Excel، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات أساسي (على سبيل المثال، **سلسلة** أو **حقيقي** أو **عدد صحيح**). في هذه الحالة، يتم إدخال القيمة في شكل Excel كنص لهذا الشكل. بالنسبة لقيم أنواع البيانات التي ليست **سلسلة**، يتم إجراء التحويل إلى نص تلقائيًا.

> [!NOTE]
> يمكنك تكوين المكون **خلية** لتعبئة الشكل فقط في الحالات التي تكون فيها خاصية نص الشكل مدعومة.

عند تكوين المكون **خلية** لإدخال قيمة في صورة Excel، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات **حاوية** والذي يمثل الصورة بتنسيق ثنائي. في هذه الحالة، يتم إدخال القيمة في صورة Excel كصورة.

> [!NOTE]
> يتم اعتبار كل صورة وشكل خاص بـ Excel مرتبطًا من الزاوية العلوية اليسرى له في خلية أو نطاق Excel معين. إذا أردت إجراء نسخ متماثل لصورة أو شكل خاص بـ Excel، فيجب عليك تكوين الخلية أو النطاق الذي يتم ربطه بالخلية أو النطاق المنسوخ.

لمعرفة المزيد حول كيفية تضمين الصور والأشكال، راجع [تضمين الصور والأشكال في المستندات التي تنشئها باستخدام ER](electronic-reporting-embed-images-shapes.md).

## <a name="page-break-component"></a>مكون فاصل الصفحات

يجبر مكون **PageBreak** Excel على بدء صفحة جديدة. لا يكون هذا المكون مطلوبًا عندما تريد استخدام ترحيل الصفحات الافتراضي في Excel، ولكن يجب عليك استخدامه عندما تريد أن يتبع Excel تنسيق ER لهيكلة الترحيل.

## <a name="page-component"></a><a name="page-component"></a>مكون الصفحة

### <a name="overview"></a>نظرة عامة

يمكنك استخدام مكون **الصفحة** عندما تريد اتباع تنسيق التقارير الإلكترونية وتنظيم فصل الصفحات في مستند خارجي مُنشأ. عندما يقوم تنسيق التقارير الإلكترونية بتشغيل مكونات موجودة ضمن مكون **الصفحة**، تُضاف فواصل الصفحات المطلوبة تلقائيًا. وأثناء هذه العملية،يتم التعامل مع حجم المحتوى الناشئ، واعداد الصفحة لقالب Excel، وحجم الورق المحدد في قالب Excel.

إذا كان يجب تقسيم المستند الذي تم إنشاؤه إلى أقسام مختلفة، يختلف فيها فصل الصفحات، فيمكنك تكوين مكونات **صفحة** متعددة في كل مكون [ورقة](er-fillable-excel.md#sheet-component).

### <a name="structure"></a><a name="page-component-structure"></a>البنية

إذا كان المكون الأول تحت مكون **الصفحة** عبارة عن مكون [نطاق](er-fillable-excel.md#range-component) حيث تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **بدون نسخ متماثل**، فسيتم اعتبار هذا النطاق راس الصفحة لفصل الصفحات الذي يستند إلى إعدادات مكون **الصفحة‏‎** الحالي. يتم تكرار نطاق Excel المقترن بمكون التنسيق هذا في أعلى كل صفحة يتم إنشاؤها باستخدام إعدادات مكون **الصفحة** الحالي.

> [!NOTE]
> لفصل الصفحات بطريقة صحيحة، إذا تم تكوين النطاق [تكرار الصفوف في الأعلى](https://support.microsoft.com/office/repeat-specific-rows-or-columns-on-every-printed-page-0d6dac43-7ee7-4f34-8b08-ffcc8b022409) في قالب Excel، فيجب أن يكون عنوان نطاق Excel هذا مساويًا لنطاق Excel المقترن بمكون **النطاق** الذي ورد وصفه في وقت سابق.

إذا كان المكون الأخير تحت مكون **الصفحة** عبارة عن مكون **نطاق** حيث تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **بدون نسخ متماثل**، فسيتم اعتبار هذا النطاق تذييل الصفحة لفصل الصفحات الذي يستند إلى إعدادات مكون **الصفحة‏‎** الحالي. يتم تكرار نطاق Excel المقترن بمكون التنسيق هذا في أسفل كل صفحة يتم إنشاؤها باستخدام إعدادات مكون **الصفحة** الحالي.

> [!NOTE]
> لفصل الصفحات بطريقة صحيحة، يجب عدم تغيير حجم نطاقات Excel المقترنة بمكونات **النطاق** في وقت التشغيل. لا ننصح بتنسيق خلايا هذا النطاق باستخدام **التفاف النص في خلية** and **احتواء تلقائي لارتفاع الصف** [خيارات](https://support.microsoft.com/office/wrap-text-in-a-cell-2a18cff5-ccc1-4bce-95e4-f0d4f3ff4e84) Excel.

يمكنك إضافة مكونات **نطاق** أخرى متعددة بين مكونات **النطاق** الاختياري لتحديد كيفية تعبئة مستند مُنشأ.

إذا كانت مجموعة مكونات **النطاق** المتداخلة ضمن مكون **الصفحة** غير متوافقة مع البنية الموضحة سابقًا، فسيحدث [خطأ](er-components-inspections.md#i17) تحقق من الصحة في وقت التصميم في مصمم تنسيق التقارير الإلكترونية. تعلمة رسالة الخطأ بأن هذه المشكلة قد تتسبب في حدوث مشاكل في وقت التشغيل.

> [!NOTE]
> لإنشاء المخرجات الصحيحة، لا تحدد رابطًا لأي مكون **نطاق** تحت مكون **الصحة** إذا كانت خاصية **اتجاه النسخ المتماثل** لذلك **النطاق‏‎** معينة إلى **بدون نسخ متماثل**، وإذا كان النطاق مكونًا لإنشاء رؤوس أو تذييلات الصفحات.

إذا أردت أن تقوم عمليات الجمع والتعداد ذات الصلة بفصل الصفحات بحساب الإجماليات الحالية والإجماليات لكل صفحة، فمن المستحسن أن تقوم بتكوين مصادر بيانات [جمع البيانات](er-data-collection-data-sources.md) المطلوبة‏‎. لمعرفة كيفية استخدام مكون **الصفحة** لفصل صفحات مستند Excel تم إنشاؤه، أكمل الإجراءات في [تصميم تنسيق تقارير إلكترونية (ER) لفصل صفحات مستند تم إنشاؤه بتنسيق Excel‬](er-paginate-excel-reports.md).

### <a name="limitations"></a><a name="page-component-limitations"></a>قيود

عند استخدام مكون **الصفحة** لفصل الصفحات في Excel، لن تعرف العدد النهائي للصفحات في المستند الذي تم إنشاؤه حتى اكتمال فصل الصفحات. وبالتالي، لا يمكنك حساب العدد الإجمالي للصفحات باستخدام صيغ التقارير الإلكترونية وطباعة العدد الصحيح لصفحات المستند الذي تم إنشاؤه على صفحة قبل الصفحة الأخيرة.

> [!TIP]
> لتحقيق هذه النتيجة في رأس أو تذييل Excel باستخدام [التنسيق](/office/vba/excel/concepts/workbooks-and-worksheets/formatting-and-vba-codes-for-headers-and-footers) الخاص في Excel للرؤوس والتذييلات.

لا تؤخذ في الاعتبار مكونات **الصفحة** المكونة عندما تقوم بتحديث قالب Excel بالتنسيق القابل للتحرير في الإصدار 10.0.22 من Dynamics 365 Finance. تؤخذ هذه الوظيفة في الاعتبار لإصدارات Finance اللاحقة.

إذا قمت بتكوين قالب Excel لاستخدام [التنسيق الشرطي](/office/dev/add-ins/excel/excel-add-ins-conditional-formatting)، فقد لا يعمل كما هو متوقع في بعض الحالات.

### <a name="applicability"></a>إمكانية التطبيق

يعمل مكون **الصفحة** لتنسيق [ملف Excel](er-fillable-excel.md#excel-file-component) فقط عند تكوين ذلك المكون لاستخدام قالب في برنامج Excel. إذا [استبدلت](tasks/er-design-configuration-word-2016-11.md)قالب Excel بقالب Word، ثم قمت بتشغيل تنسيق التقارير الإلكترونية القابل للتحرير، سيتم تجاهل مكون **الصفحة**.

يعمل مكون **الصفحة** فقط عند تمكين الميزة **تمكين استخدام مكتبة EPPlus في إطار عمل التقارير الإلكترونية**. يتم طرح استثناء في وقت التشغيل إذا حاولت التقارير الإلكترونية معالجة مكون **الصفحة** بينما هذه الميزة معطلة.

> [!NOTE]
> يتم طرح استثناء في وقت التشغيل إذا قام تنسيق التقارير الإلكترونية بمعالجة مكون **الصفحة** لقالب Excel يحتوي على صيغة واحدة على الأقل تشير إلى خلية غير صالحة. للمساعدة في تجنب أخطاء وقت التشغيل، يمكنك إصلاح قالب Excel كما هو موضح في [كيفية تصحيح خطأ #REF!](https://support.microsoft.com/office/how-to-correct-a-ref-error-822c8e46-e610-4d02-bf29-ec4b8c5ff4be).

## <a name="footer-component"></a>مكون التذييل

يُستخدم مكون  **التذييل** لملء التذييلات في أسفل ورقة عمل تم إنشاؤها في مصنف Excel.

> [!NOTE]
> يمكنك إضافة هذا المكون لكل مكون **ورقة عمل** لتحديد تذييلات مختلفة لأوراق العمل المختلفة في مصنف Excel الذي تم إنشاؤه.

عند تكوين مكون **تذييل** فردي، يمكنك استخدام خاصية **مظهر الرأس/التذييل** لتحديد الصفحات التي يتم استخدام المكون لها. تتوفر القيم التالية:

- **أي** - تشغيل مكون **التذييل** الذي تم تكوينه لأي صفحة من ورقة عمل Excel الأصلية.
- **الأولى** - تشغيل مكون **التذييل** الذي تم تكوينه للصفحة الأولى فقط من ورقة عمل Excel الأصلية.
- **زوجي** - تشغيل مكون **التذييل** الذي تم تكوينه للصفحات الزوجية فقط من ورقة عمل Excel الأصلية.
- **زوجي** فردي - تشغيل مكون **التذييل** الذي تم تكوينه للصفحات الفردية فقط من ورقة عمل Excel الأصلية.

مع مكون **ورقة عمل** فردية، يمكنك إضافة عدة مكونات **تذييل**، ولكل واحد قيمة مختلفة لخاصية **مظهر الرأس/التذييل**. بهذه الطريقة، يمكنك إنشاء تذييلات مختلفة لأنواع مختلفة من الصفحات في ورقة عمل Excel.

> [!NOTE]
> تأكد من أن كل مكون **تذييل** قمت بإضافته إلى مكون **ورقة** فردي يتضمن قيمة مختلفة لخاصية **مظهر الرأس/التذييل**. خلاف ذلك، سيحدث [خطأ في التحقق من الصحة](er-components-inspections.md#i16). تقوم رسالة الخطأ التي تلقيتها بإخطارك بشان عدم التوافق.

ضمن مكون **التذييل** المضاف، أضف المكونات المتداخلة المطلوبة من **النص\\السلسلة** أو **النص\\تاريخ/وقت** أو أي نوع آخر. قم بتكوين الروابط لهذه المكونات لتحديد كيفية ملء تذييل صفحتك.

يمكنك أيضا استخدام [أكواد التنسيق](/office/vba/excel/concepts/workbooks-and-worksheets/formatting-and-vba-codes-for-headers-and-footers) لتنسيق محتوي التذييل الذي تم إنشاؤه بشكل صحيح. لمعرفة كيفية استخدام هذا النهج، اتبع الخطوات الموضحة في [المثال 1](#example-1)، لاحقًا في هذا الموضوع.

> [!NOTE]
> عند تكوين تنسيقات ER، تأكد من مراعاة [حد Excel](https://support.microsoft.com/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3) والحد الأقصى لعدد الأحرف الخاصة برأس أو تذييل الصفحة الفردية.

## <a name="header-component"></a>مكون الرأس

يُستخدم مكون  **الرأس** لملء الرؤوس في أعلى ورقة عمل تم إنشاؤها في مصنف Excel. ويُستخدم مثل مكون **التذييل**.

## <a name="edit-an-added-er-format"></a>تحرير تنسيق ER المضاف

### <a name="update-a-template"></a>تحديث قالب

يمكنك تحديد **تحديث من Excel** من علامة التبويب **استيراد** من جزء الإجراءات لاستيراد قالب محدث إلى تنسيق ER قابل للتحرير. أثناء هذه العملية، يتم استبدال قالب لمكون **ملف\\Excel** المحدد بقالب جديد. ستتم مزامنة محتوي تنسيق ER القابل للتحرير مع محتوي قالب ER الذي تم تحديثه.

- سيتم إنشاء مكون جديد لتنسيق ER تلقائيًا لكل اسم Excel إذا لم يتم العثور على مكون تنسيق ER في التنسيق القابل للتحرير.
- سيتم حذف كل مكون من مكونات تنسيق ER من تنسيق ER القابل للتحرير إذا لم يتم العثور على اسم Excel المناسب له.

> [!NOTE]
> قم بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم** إذا كنت ترغب في إنشاء عنصر **ورقة** بتنسيق ER القابل للتحرير.
>
> إذا كان تنسيق ER القابل للتحرير مدرج في الأصل في عناصر **الورقة**، فنحن نوصي بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم** عند استيراد قالب محدث. خلاف ذلك، سيتم إنشاء كافة العناصر المتداخلة لعنصر **الورقة** الأصلي من البداية. بالتالي، سيتم فقدان كافة ارتباطات عناصر التنسيق المعاد إنشائها في تنسيق ER المحدث.

![خيار إنشاء عنصر بتنسيق ورقة Excel في مربع الحوار تحديث من Excel.](./media/er-excel-format-update-template.png)

لمعرفة المزيد حول هذه الميزة، اتبع الخطوات الموجودة في [تعديل تنسيقات التقارير الإلكترونية عن طريق إعادة تطبيق قوالب Excel](modify-electronic-reporting-format-reapply-excel-template.md).

## <a name="validate-an-er-format"></a>التحقق من صحة تنسيق ER

عند التحقق من صحة تنسيق ER الذي يمكن تحريره، يتم التحقق من التناسق للتأكد من وجود اسم Excel في قالب Excel المستخدم حاليًا. سيتم إعلامك بوجود أي حالات عدم تناسق. بالنسبة لبعض حالات عدم التناسق، يتم تقديم خيار لإصلاح المشكلات تلقائيًا.

![رسالة خطأ التحقق من الصحة.](./media/er-excel-format-validate.png)

## <a name="control-the-calculation-of-excel-formulas"></a>التحكم في حساب معادلات Excel

عند إنشاء مستند خارجي في تنسيق مصنف Microsoft Excel، قد تحتوي بعض الخلايا الخاصة بهذا المستند على معادلات Excel. عندما يتم تمكين ميزة **تمكين استخدام لمكتبة EPPlus في إطار عمل التقارير الإلكترونية**، يمكنك التحكم في الوقت الذي يتم فيه حساب المعادلات بتغيير قيمة **معلمة** [خيارات الحساب](https://support.microsoft.com/office/change-formula-recalculation-iteration-or-precision-in-excel-73fc7dac-91cf-4d36-86e8-67124f6bcce4#ID0EAACAAA=Windows) في قالب Excel الذي يتم استخدامه:

- حدد **تلقائي** لإعادة حساب كافة المعادلات التابعة في كل مره يتم فيها إلحاق مستند تم إنشاؤه بنطاقات وخلايا جديدة وغيرها.

    >[!NOTE]
    > قد يتسبب هذا في حدوث مشكلة في الأداء لقوالب Excel التي تحتوي على عدة صيغ ذات صلة.

- حدد **يدوي** لتجنب إعادة حساب المعادلة عند إنشاء مستند.

    >[!NOTE]
    > يتم فرض إعادة حساب المعادلة يدويًا عند فتح مستند تم إنشاؤه للمعاينة باستخدام Excel.
    > لا تستخدم هذا الخيار إذا قمت بتكوين وجهة إعداد التقارير الإلكترونية التي تفترض استخدام مستند تم إنشاؤه بدون معاينته في Excel (تحويل PDF، وإرسال بريد إلكتروني، وما إلى ذلك) لأن المستند الذي تم إنشاؤه قد لا يحتوي على قيم في الخلايا التي تحتوي على معادلات.

## <a name="example-1-format-footer-content"></a><a name="example-1"></a>مثال رقم 1: تنسيق محتوى التذييل 

1. استخدم تكوينات ER المتوفرة [لإنشاء](er-generate-printable-fti-forms.md) مستند فاتورة ذات نص حر قابل للطباعة (FTI).
2. قم بمراجعة تذييل المستند الذي تم إنشاؤه. لاحظ أنه يحتوي على معلومات حول رقم الصفحة الحالية والعدد الإجمالي للصفحات في المستند.

    ![مراجعة تذييل المستند الذي تم إنشاؤه بتنسيق Excel.](./media/er-fillable-excel-footer-1.gif)

3. في مصمم تنسيق ER، [افتح](er-generate-printable-fti-forms.md#features-that-are-implemented-in-the-sample-er-format) نموذج تنسيق ER للمراجعة.

    يتم إنشاء تذييل ورقة عمل **الفاتورة** استنادا إلى إعدادات مكونين من مكونات **السلسلة** الموجودة ضمن مكون **التذييل**:

    - يقوم مكون **السلسلة** الأول بتعبئة أكواد التنسيق الخاصة التالية لإجبار Excel على تطبيق تنسيق محدد:

        - **&C** - محاذاة نص التذييل إلى الوسط.
        - **&"Segoe UI,Regular"&8** – إظهار نص التنسيق بخط "Segoe UI Regular" بحجم 8 نقاط.

    - يملأ مكون **السلسلة** الثاني النص الذي يحتوي على رقم الصفحة الحالية والعدد الإجمالي للصفحات في المستند الحالي.

    ![مراجعة مكون تنسيق التقارير الإلكترونية (ER) في صفحة مصمم التنسيق.](./media/er-fillable-excel-footer-2.png)

4. تخصيص تنسيق نموذج ER لتعديل تذييل الصفحة الحالية:

    1. قم [بإنشاء](er-quick-start2-customize-report.md#DeriveProvidedFormat) تنسيق **مخصص لفاتورة نص حر (Excel)** مشتق يستند إلى نموذج تنسيق ER.
    2. أضف الزوج الجديد الأول من مكونات **السلسلة** لمكون **التذييل** لورقة عمل **الفاتورة**:

        1. أضف مكون **سلسلة** لمحاذاة اسم الشركة على اليسار وعرضه بخط 8 نقاط من "Segoe UI Regular" (**"&L&"Segoe UI,Regular"&8"**).
        2. إضافة مكون **سلسله** يقوم بتعبئة اسم الشركة (**model.InvoiceBase.CompanyInfo.Name**).

    3. أضف الزوج الجديد الثاني من مكونات **السلسلة** لمكون **التذييل** لورقة عمل **الفاتورة**:

        1. أضف مكون **سلسلة** لمحاذاة تاريخ المعالجة على اليمين وعرضه بخط 8 نقاط من "Segoe UI Regular" (**"&L&"Segoe UI,Regular"&8"**).
        2. أضف مكون **سلسلة** يقوم بتعبئة تاريخ المعالجة بتنسيق مخصص (**"&nbsp;"&DATEFORMAT(SESSIONTODAY(), "yyyy-MM-dd")**).

        ![مراجعة مكون تنسيق التقارير الإلكترونية (ER) في صفحة مصمم التنسيق.](./media/er-fillable-excel-footer-3.png)

    4. [أكمل](er-quick-start2-customize-report.md#CompleteDerivedFormat) إصدار المسودة من تنسيق ER لـ **فاتورة نص حرة (Excel) مخصصة** مشتقة.

5. [قم بتكوين](er-generate-printable-fti-forms.md#configure-print-management) إدارة الطباعة لاستخدام تنسيق ER لـ **فاتورة نص حر (Excel) مخصص** المشتقة بدلا من نموذج تنسيق ER.
6. قم بإنشاء وثيقة FTI قابلة للطباعة، وقم بمراجعه تذييل الوثيقة التي تم إنشائها.

    ![مراجعة تذييل المستند الذي تم إنشاؤه بتنسيق Excel.](./media/er-fillable-excel-footer-4.gif)

## <a name="example-2-fixing-the-merged-cells-epplus-issue"></a><a name="example-2"></a>مثال 2: إصلاح EPPlus بالخلايا المدمجة

يمكنك تشغيل تنسيق التقارير الإلكترونية لإنشاء مستند صادر بتنسيق مصنف Excel. عندما يتم تمكين الميزة **تمكين استخدام مكتبة EPPlus في إطار عمل التقارير الإلكترونية** في مساحة العمل **إدارة الميزات**، يتم استخدام [مكتبة EPPlus](https://www.nuget.org/packages/epplus/4.5.2.1) لإنشاء مخرجات Excel. ومع ذلك، بسبب [سلوك Excel](https://answers.microsoft.com/msoffice/forum/all/deleting-a-range-of-cells-that-includes-merged/8601462c-4e2c-48e0-bd23-848eecb872a9) المعروف وقيود مكتبة EPPlus، فقد تواجه الاستثناء التالي: "يتعذر حذف/استبدال الخلايا المدمجة. يتم دمج النطاق جزئيًا مع النطاق المدمج الآخر." لمعرفة نوع قوالب Excel التي قد تتسبب في حدوث هذا الاستثناء وكيف يمكنك حل المشكلة، أكمل المثال التالي.

1. في تطبيق Excel لسطح المكتب، قم بإنشاء مصنف Excel جديد.
2. في ورقه العمل **Sheet1**، أضف اسم **ReportTitle**  للخلية **A2**.
3. أدمج الخلايا **A1** و **A2**.

    ![مراجعة نتائج دمج الخلايا A1 وA2 في مصنف Excel المصمم في تطبيق Excel لسطح مكتب.](./media/er-fillable-excel-example2-1.png)

3. في الصفحة **تكوينات**، [أضف تنسيق تقارير إلكترونية جديد](er-fillable-excel.md#add-a-new-er-format) لإنشاء مستند صادر بتنسيق مصنف Excel.
4. في الصفحة **مصمم التنسيق**، [قم باستيراد](er-fillable-excel.md#template-import) مصنف Excel المصمم بتنسيق التقارير الإلكترونية المضاف كقالب جديد للمستندات الصادرة.
5. في علامة التبويب **التخطيط**، قم بتكوين الربط للمكون **ReportTitle** للنوع [خلية](er-fillable-excel.md#cell-component).
6. قم بتشغيل تنسيق التقارير الإلكترونية. لاحظ طرح الاستثناء التالي: "يتعذر حذف/استبدال الخلايا المدمجة. يتم دمج النطاق جزئيًا مع النطاق المدمج الآخر."

    ![مراجعة نتائج تشغيل تنسيق التقارير الإلكترونية المكون في الصفحة "مصمم التنسيق".](./media/er-fillable-excel-example2-2.png)

يمكن إصلاح المشكلة بأي من الطريقتين التاليتين:

- **الأسهل ولكن لا يُنصح به:** في مساحة العمل **إدارة الميزات**، قم بإيقاف تشغيل الميزة **تمكين استخدام مكتبة EPPlus في إطار عمل التقارير الإلكترونية**. على الرغم من أن هذه الطريقة أسهل، فقد تواجه مشكلات أخرى في حالة استخدامها، وذلك لأنه يتم دعم بعض وظائف التقارير الإلكترونية فقط عندما يتم تمكين الميزة **‬‏‫تمكين استخدام مكتبة EPPlus في إطار عمل التقارير الإلكترونية**.
- **مُوصى به:** اتبع هذه الخطوات:

    1. في تطبيق سطح المكتب في Excel، قم بتعديل مصنف Excel بإحدى الطرق التالية:

        - في ورقة العمل **Sheet1**، قم بإلغاء دمج الخلايا **A1** و **A2**.
        - قم بتغيير مرجع الاسم **ReportTitle** من **=Sheet1!$A$2** إلى **=Sheet1!$A$1**.

        ![مراجعة نتائج تغيير المرجع في مصنف Excel المصمم في تطبيق Excel لسطح مكتب.](./media/er-fillable-excel-example2-3.png)

    2. في الصفحة **مصمم التنسيق**، [قم باستيراد](er-fillable-excel.md#template-import) مصنف Excel المعدل إلى تنسيق التقارير الإلكترونية القابل للتحرير لتحديث القالب الموجود.
    3. قم بتشغيل تنسيق التقارير الإلكترونية المعدّل.

        ![مراجعة المستند المُنشأ في تطبيق Excel لسطح المكتب.](./media/er-fillable-excel-example2-4.png)

## <a name="limitations"></a>قيود

### <a name="known-epplus-library-limitations"></a>قيود مكتبة EPPlus المعروفة

#### <a name="external-data-sources"></a>مصادر بيانات خارجية

إذا احتوى أحد القوالب الخاصة بك على PivotTable يستند إلى نموذج PowerPivot الذي يشير إلى [مصدر بيانات خارجي](https://support.microsoft.com/office/create-a-pivottable-with-an-external-data-source-db50d01d-2e1c-43bd-bfb5-b76a818a927b)، وتم تمكين ميزة **تمكين استخدام مكتبة EPPlus في إطار عمل التقارير الإلكترونية**، تتلقى رسالة الخطأ التالية عند تشغيل تنسيق تقارير إلكترونية يستخدم هذا القالب لإنشاء مستند صادر بتنسيق Excel: "مصدر التخزين المؤقت ليس ورقة عمل." لإصلاح هذه المشكلة، لديك الخيارات التالية:

- **موصى به:** أعد تصميم حل Excel الذي تستخدمه:

    1. افصل الجزء الذي يحتوي على محاور في مصنف Excel منفصل (مصنف أ). 
    2. استخدم التقارير الإلكترونية لإنشاء مصنف Excel ثانٍ (مصنف ب) من Finance يحتوي على التفاصيل المطلوبة. 
    3. راجع المصنف ب في المصنف أ بمجرد إنشاء المصنف ب.

- استخدم خيارًا بخلاف EPPlus لإيقاف تشغيل الميزة. 

## <a name="additional-resources"></a>الموارد الإضافية

[نظرة عامة حول التقارير الإلكترونية](general-electronic-reporting.md)

[تصميم تكوين لإنشاء تقارير بتنسيق OPENXML](tasks\er-design-reports-openxml-2016-11.md)

[تعديل تنسيقات التقارير الإلكترونية من خلال إعادة تطبيق قوالب Excel](modify-electronic-reporting-format-reapply-excel-template.md)

[استخدام النطاقات القابلة للتوسيع أفقيًا لإضافة الأعمدة بشكل حيوي في تقارير Excel](tasks/er-horizontal-1.md)

[تضمين الصور والأشكال في المستندات التي تقوم بإنشائها باستخدام التقارير الإلكترونية](electronic-reporting-embed-images-shapes.md)

[تكوين التقارير الإلكترونية (ER) لسحب البيانات إلى Power BI](general-electronic-reporting-report-configuration-get-data-powerbi.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
