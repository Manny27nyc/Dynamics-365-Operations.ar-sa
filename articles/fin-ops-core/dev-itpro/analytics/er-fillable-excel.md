---
title: تصميم تكوين لإنشاء المستندات بتنسيق Excel
description: يوفر هذا الموضوع معلومات حول كيفية تصميم تنسيق التقارير الإلكترونية (ER) لملء قالب Excel، ثم إنشاء مستندات صادرة بتنسيق Excel.
author: NickSelin
manager: AnnBe
ms.date: 11/02/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: EROperationDesigner, ERParameters
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: Version 7.0.0
ms.openlocfilehash: d5733e40c67f9c97b04f126f7c3cfea9d4f8f5b5
ms.sourcegitcommit: 659375c4cc7f5524cbf91cf6160f6a410960ac16
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 12/05/2020
ms.locfileid: "4686528"
---
# <a name="design-a-configuration-for-generating-documents-in-excel-format"></a>تصميم تكوين لإنشاء المستندات بتنسيق Excel

[!include[banner](../includes/banner.md)]

يمكن تصميم تكوين لتنسيق [التقارير الإلكترونية (ER)](general-electronic-reporting.md) يتضمن [مكون تنسيق](general-electronic-reporting.md#FormatComponentOutbound) ER والذي يمكنك تكوينه لإنشاء مستند صادر بتنسيق مصنف Microsoft Excel. يجب استخدام مكونات تنسيق ER المحددة لهذا الغرض.

لمعرفة المزيد حول هذه الميزة، اتبع الخطوات الواردة في موضوع، [تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](tasks/er-design-reports-openxml-2016-11.md).

## <a name="add-a-new-er-format"></a>إضافة تنسيق ER جديد

عند إضافة تكوين لتنسيق ER جديد لإنشاء مستند صادر بتنسيق مصنف Excel، يجب عليك إما تحديد قيمة **Excel** لسمة **نوع التنسيق** للتنسيق أو ترك سمة **نوع التنسيق** فارغة.

- إذا قمت بتحديد **Excel**، يمكنك تكوين التنسيق لإنشاء مستند صادر بتنسيق Excel فقط.
- إذا تركت السمة فارغة، يمكنك تكوين التنسيق لإنشاء مستند صادر بأي تنسيق يدعمه إطار عمل ER.

لتكوين مكون تنسيق ER للتكوين، حدد **المصمم** في جزء الإجراءات، وافتح مكون تنسيق ER للتحرير في مصمم تشغيل التقارير الإلكترونية‬.

![صفحة التكوينات](./media/er-excel-format-add-format.png)

## <a name="excel-file-component"></a>مكون ملف Excel

### <a name="manual-entry"></a>إدخال يدوي

يجب إضافة مكون **ملف\\Excel** إلى تنسيق ER الذي تم تكوينه لإنشاء مستند صادر بتنسيق Excel.

![مكون ملف/ Excel](./media/er-excel-format-add-file-component.png)

لتحديد مخطط المستند الصادر، قم بإرفاق مصنف Excel يتضمن الملحق .xlsx إلى مكون **ملف\\Excel** كقالب للمستندات الصادرة.

> [!NOTE]
> عندما تقوم بإرفاق قالب يدويًا، يجب عليك استخدام [نوع مستند](https://docs.microsoft.com/dynamics365/fin-ops-core/fin-ops/organization-administration/configure-document-management#configure-document-types) تم تكوينه لهذا الغرض في [معلمات ER](electronic-reporting-er-configure-parameters.md#parameters-to-manage-documents).

![إضافة مرفق إلى مكون ملف/Excel](./media/er-excel-format-add-file-component2.png)

لتحديد كيفية ملء القالب المرفق عند تشغيل تنسيق ER المكون، يجب إضافة مكونات **الورقة** و **النطاق** و **الخلية** المتداخلة إلى مكون **ملف\\Excel**. يجب أن يرتبط كل مكون متداخل بعنصر يسمى Excel.

### <a name="template-import"></a>استيراد القالب

يمكنك تحديد **استيراد من Excel** من علامة التبويب **استيراد** من جزء الإجراءات لاستيراد قالب جديد إلى تنسيق ER فارغ. في هذا المثال، سيتم إنشاء مكون **ملف\\Excel** تلقائيًا، وسيتم إرفاق القالب المستورد به. سيتم أيضًا إنشاء كافة مكونات ER المطلوبة تلقائيًا، وذلك استنادًا إلى قائمة العناصر المسماة Excel التي تم اكتشافها.

![تحديد استيراد من Excel](./media/er-excel-format-import-template.png)

> [!NOTE]
> إذا كنت ترغب في إنشاء عنصر **ورقة** اختياري بتنسيق ER القابل للتحرير، قم بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم**.

## <a name="sheet-component"></a>مكون الورقة

يشير مكون **الورقة** إلى ورقة عمل من مصنف Excel المرفق الذي يجب تعبئته. يتم تعريف اسم ورقه العمل في قالب Excel في خاصية **الورقة** لهذا المكون.

> [!NOTE]
> هذا المكون اختياري لمصنفات Excel التي تحتوي على ورقة عمل واحدة.

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **الورقة** لتحديد ما إذا كان يجب وضع المكون في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم وضع ورقه العمل المناسبة في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، لن يحتوي المستند الذي تم إنشاؤه على أي ورقة عمل.

![مثال لمكون الورقة](./media/er-excel-format-sheet-component.png)

## <a name="range-component"></a>مكون النطاق

يشير مكون **النطاق** إلى نطاق Excel الذي يجب أن يتم التحكم فيه بواسطة مكون ER هذا. يتم تعريف اسم النطاق في خاصية **نطاق Excel** لهذا المكون.

تحدد خاصية **اتجاه النسخ المتماثل** ما إذا كان سيتم تكرار النطاق في المستند المنشأ أم لا:

- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **عدم النسخ المتماثل**، لن يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه.
- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **رأسي**، فسيتم يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه. يتم وضع كل نطاق منسوخ نسخًا متماثلاً أسفل النطاق الأصلي في قالب Excel. يتم تحديد عدد التكرارات حسب عدد السجلات في مصدر بيانات من نوع **قائمة السجلات** المرتبط بمكون ER هذا.
- إذا تم تعيين خاصية **اتجاه النسخ المتماثل** إلى **أفقي**، فسيتم يتكرر نطاق Excel المناسب في المستند الذي تم إنشاؤه. يتم وضع كل نطاق منسوخ نسخًا متماثلاً على يمين النطاق الأصلي في قالب Excel. يتم تحديد عدد التكرارات حسب عدد السجلات في مصدر بيانات من نوع **قائمة السجلات** المرتبط بمكون ER هذا.

لمعرفة المزيد عن النسخ المتماثل الأفقي، اتبع الخطوات الموجودة في [استخدام نطاقات قابلة للتوسيع أفقيًا لإضافة أعمدة في تقارير Excel ديناميكيًا](tasks/er-horizontal-1.md).

يمكن أن يكون لمكون **النطاق** مكونات ER أخرى يتم استخدامها لإدخال القيم في النطاقات المناسبة المسماة Excel.

- في حالة استخدام أي مكون من المجموعة **النصية** لإدخال القيم، يتم إدخال القيمة في نطاق Excel كقيمة نصية.

    > [!NOTE]
    > استخدم هذا النمط لتنسيق القيم التي تم إدخالها استنادا إلى الإعدادات المحلية التي تم تحديدها في التطبيق.

- إذا تم استخدام مكون **الخلية** الخاص بمجموعة **Excel** لإدخال القيم، يتم إدخال القيمة في نطاق Excel كقيمة لنوع البيانات الذي تم تحديد بواسطة ربط مكون **الخلية** هذا (على سبيل المثال، **سلسة** أو **حقيقي** أو **عدد صحيح**).

    > [!NOTE]
    > استخدم هذا النمط لتمكين تطبيق Excel من تنسيق القيم المدخلة استنادا إلى الإعدادات المحلية للكمبيوتر المحلي الذي يقوم بفتح المستند الصادر.

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **النطاق** لتحديد ما إذا كان يجب وضع المكون في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم ملء النطاق المناسب في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، وإذا كان هذا النطاق لا يمثل الصفوف أو الأعمدة بأكملها، لن يتم ملء النطاق المناسب في المستند الذي تم إنشاؤه.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، وكان هذا النطاق يمثل الصفوف أو الأعمدة بأكملها، فسوف يحتوي المستند الذي تم إنشاؤه على تكل الصفوف والأعمدة كصفوف وأعمدة مخفية.

## <a name="cell-component"></a>مكون الخلية

يتم استخدام مكون **الخلية** لملء الخلايا والأشكال والصور المسماة Excel. للإشارة إلى كائن باسم Excel والذي يجب تعبئته بواسطة مكون ER **الخلية**، يجب تحديد اسم ذلك الكائن في خاصية **نطاق Excel** لمكون **الخلية**.

من علامة التبويب **التعيين** بمصمم تشغيل التقارير الإلكترونية، يمكنك تكوين خاصية **ممكّن** لمكون **الخلية** لتحديد ما إذا كان يجب ملء الكائن في مستند تم إنشاؤه أم لا:

- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **صحيح** في وقت التشغيل، أو إذا لم يتم تكوين أي تعبير على الإطلاق، سيتم ملء الكائن المناسب في المستند الذي تم إنشاؤه. يحدد ربط مكون **الخلية** هذا قيمة يتم وضعها في الكائن المناسب.
- إذا تم تكوين تعبير لخاصية **ممكّن** لإرجاع القيمة **خطأ** في وقت التشغيل، فلن يتم ملء الكائن المناسب في المستند الذي تم إنشاؤه.

عند تكوين المكون **خلية** لإدخال قيمة في خلية، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات أساسي (على سبيل المثال، **سلسلة** أو **حقيقي** أو **عدد صحيح**). في هذه الحالة، يتم إدخال القيمة في الخلية كقيمة من نفس نوع البيانات.

عند تكوين المكون **خلية** لإدخال قيمة في شكل Excel، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات أساسي (على سبيل المثال، **سلسلة** أو **حقيقي** أو **عدد صحيح**). في هذه الحالة، يتم إدخال القيمة في شكل Excel كنص لهذا الشكل. بالنسبة لقيم أنواع البيانات التي ليست **سلسلة**، يتم إجراء التحويل إلى نص تلقائيًا.

> [!NOTE]
> يمكنك تكوين المكون **خلية** لتعبئة الشكل فقط في الحالات التي تكون فيها خاصية نص الشكل مدعومة.

عند تكوين المكون **خلية** لإدخال قيمة في صورة Excel، فمن الممكن ربطه بمصدر بيانات يرجع قيمة نوع بيانات **حاوية** والذي يمثل الصورة بتنسيق ثنائي. في هذه الحالة، يتم إدخال القيمة في صورة Excel كصورة.

> [!NOTE]
> يتم اعتبار كل صورة وشكل خاص بـ Excel مرتبطًا من الزاوية العلوية اليسرى له في خلية أو نطاق Excel معين. إذا أردت إجراء نسخ متماثل لصورة أو شكل خاص بـ Excel، فيجب عليك تكوين الخلية أو النطاق الذي يتم ربطه بالخلية أو النطاق المنسوخ.

لمعرفة المزيد حول كيفية تضمين الصور والأشكال، راجع [تضمين الصور والأشكال في المستندات التي تنشئها باستخدام ER](electronic-reporting-embed-images-shapes.md).

## <a name="page-break-component"></a>مكون فاصل الصفحات

يجبر مكون **PageBreak** Excel على بدء صفحة جديدة. لا يكون هذا المكون مطلوبًا عندما تريد استخدام ترحيل الصفحات الافتراضي في Excel، ولكن يجب عليك استخدامه عندما تريد أن يتبع Excel تنسيق ER لهيكلة الترحيل.

## <a name="edit-an-added-er-format"></a>تحرير تنسيق ER المضاف

### <a name="update-a-template"></a>تحديث قالب

يمكنك تحديد **تحديث من Excel** من علامة التبويب **استيراد** من جزء الإجراءات لاستيراد قالب محدث إلى تنسيق ER قابل للتحرير. أثناء هذه العملية، يتم استبدال قالب لمكون **ملف\\Excel** المحدد بقالب جديد. ستتم مزامنة محتوي تنسيق ER القابل للتحرير مع محتوي قالب ER الذي تم تحديثه.

- سيتم إنشاء مكون جديد لتنسيق ER تلقائيًا لكل اسم Excel إذا لم يتم العثور على مكون تنسيق ER في التنسيق القابل للتحرير.
- سيتم حذف كل مكون من مكونات تنسيق ER من تنسيق ER القابل للتحرير إذا لم يتم العثور على اسم Excel المناسب له.

> [!NOTE]
> قم بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم** إذا كنت ترغب في إنشاء عنصر **ورقة** بتنسيق ER القابل للتحرير.
>
> إذا كان تنسيق ER القابل للتحرير مدرج في الأصل في عناصر **الورقة**، فنحن نوصي بتعيين خيار **إنشاء عنصر تنسيق ورقة Excel** إلى **نعم** عند استيراد قالب محدث. خلاف ذلك، سيتم إنشاء كافة العناصر المتداخلة لعنصر **الورقة** الأصلي من البداية. بالتالي، سيتم فقدان كافة ارتباطات عناصر التنسيق المعاد إنشائها في تنسيق ER المحدث.

![خيار إنشاء عنصر بتنسيق ورقة Excel في مربع الحوار تحديث من Excel](./media/er-excel-format-update-template.png)

لمعرفة المزيد حول هذه الميزة، اتبع الخطوات الموجودة في [تعديل تنسيقات التقارير الإلكترونية عن طريق إعادة تطبيق قوالب Excel](modify-electronic-reporting-format-reapply-excel-template.md).

## <a name="validate-an-er-format"></a>التحقق من صحة تنسيق ER

عند التحقق من صحة تنسيق ER الذي يمكن تحريره، يتم التحقق من التناسق للتأكد من وجود اسم Excel في قالب Excel المستخدم حاليًا. سيتم إعلامك بوجود أي حالات عدم تناسق. بالنسبة لبعض حالات عدم التناسق، يتم تقديم خيار لإصلاح المشكلات تلقائيًا.

![رسالة خطأ التحقق من الصحة](./media/er-excel-format-validate.png)

## <a name="control-the-calculation-of-excel-formulas"></a>التحكم في حساب معادلات Excel

عند إنشاء مستند خارجي في تنسيق مصنف Microsoft Excel، قد تحتوي بعض الخلايا الخاصة بهذا المستند على معادلات Excel. عندما يتم تمكين ميزة **تمكين استخدام لمكتبة EPPlus في إطار عمل التقارير الإلكترونية**، يمكنك التحكم في الوقت الذي يتم فيه حساب المعادلات بتغيير قيمة **معلمة** [خيارات الحساب](https://support.microsoft.com/office/change-formula-recalculation-iteration-or-precision-in-excel-73fc7dac-91cf-4d36-86e8-67124f6bcce4#ID0EAACAAA=Windows) في قالب Excel الذي يتم استخدامه:

- حدد **تلقائي** لإعادة حساب كافة المعادلات التابعة في كل مره يتم فيها إلحاق مستند تم إنشاؤه بنطاقات وخلايا جديدة وغيرها.
    >[!NOTE]
    > قد يتسبب هذا في حدوث مشكلة في الأداء لقوالب Excel التي تحتوي على عدة صيغ ذات صلة.
- حدد **يدوي** لتجنب إعادة حساب المعادلة عند إنشاء مستند.
    >[!NOTE]
    > يتم فرض إعادة حساب المعادلة يدويًا عند فتح مستند تم إنشاؤه للمعاينة باستخدام Excel.
    > لا تستخدم هذا الخيار إذا قمت بتكوين وجهة إعداد التقارير الإلكترونية التي تفترض استخدام مستند تم إنشاؤه بدون معاينته في Excel (تحويل PDF، وإرسال بريد إلكتروني، وما إلى ذلك) لأن المستند الذي تم إنشاؤه قد لا يحتوي على قيم في الخلايا التي تحتوي على معادلات.

## <a name="additional-resources"></a>الموارد الإضافية

[نظرة عامة حول التقارير الإلكترونية](general-electronic-reporting.md)

[تصميم تكوين لإنشاء التقارير بتنسيق OPENXML](tasks\er-design-reports-openxml-2016-11.md)

[تعديل تنسيقات التقارير الإلكترونية من خلال إعادة تطبيق قوالب Excel](modify-electronic-reporting-format-reapply-excel-template.md)

[استخدام النطاقات القابلة للتوسيع أفقيًا لإضافة الأعمدة بشكل حيوي في تقارير Excel](tasks/er-horizontal-1.md)

[تضمين الصور والأشكال في المستندات التي تقوم بإنشائها باستخدام التقارير الإلكترونية](electronic-reporting-embed-images-shapes.md)

[تكوين التقارير الإلكترونية (ER) لسحب البيانات إلى Power BI](general-electronic-reporting-report-configuration-get-data-powerbi.md)
