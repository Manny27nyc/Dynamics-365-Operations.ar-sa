---
title: تصميم تنسيق تقارير إلكترونية (ER) لفصل صفحات المستندات التي تم إنشاؤها في Excel
description: يشرح هذا الموضوع كيفية تصميم تنسيق تقارير إلكترونية (ER) لفصل صفحات المستندات التي تم إنشاؤها في Microsoft Excel.
author: NickSelin
ms.date: 09/14/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: EROperationDesigner
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2021-08-01
ms.dyn365.ops.version: Version 10.0.22
ms.openlocfilehash: ce29225c4bce24adc2abefc3d3d6f20774852af4
ms.sourcegitcommit: 7a2001e4d01b252f5231d94b50945fd31562b2bc
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 09/15/2021
ms.locfileid: "7488329"
---
# <a name="design-an-er-format-to-paginate-generated-documents-in-excel"></a>تصميم تنسيق تقارير إلكترونية (ER) لفصل صفحات المستندات التي تم إنشاؤها في Excel

[!include [banner](../includes/banner.md)]

يوضح هذا الموضوع كيف يمكن لمستخدم لديه دور مسؤول النظام أو المستشار الوظيفي للتقارير الإلكترونية تكوين تنسيق [التقارير الإلكترونية (ER)](general-electronic-reporting.md) لإنشاء مستندات صادرة في Microsoft Excel وإدارة فصل صفحات المستندات.

في هذا المثال، ستقوم بتعديل تنسيق التقارير الإلكترونية الذي وفرته Microsoft والذي يُستخدم في طباعة تقرير المراقبة عند [إنشاء](../../../finance/localizations/tasks/eur-00002-eu-intrastat-declaration.md) إعلان نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي. يتيح لك هذا التقرير مراقبة حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي التي تم الإبلاغ عنها. ستسمح لك تعديلاتك بإدارة فواصل صفحات تقارير المراقبة التي يتم إنشاؤها.

يمكن إكمال الإجراءات الموجودة في هذا الموضوع في شركة **DEMF**. الترميز غير مطلوب. قبل أن تبدأ ، قم بتنزيل وحفظ الملفات التالية.

| الوصف       | اسم الملف |
|-------------------|-----------| 
| قالب التقرير 1 | [ERIntrastatReportDemo1.xlsx](https://download.microsoft.com/download/7/2/a/72ae292a-8bb2-4b9d-8397-9764218f6fa8/ERIntrastatReportDemo1%20.xlsx) |
| قالب التقرير 2 | [ERIntrastatReportDemo2.xlsx](https://download.microsoft.com/download/7/d/1/7d15858d-6260-4afa-9dda-d8b955e59b1a/ERIntrastatReportDemo2.xlsx) |

## <a name="configure-the-er-framework"></a>تكوين إطار عمل ER

اتبع الخطوات في [تكوين إطار عمل التقارير الإلكترونية](er-quick-start2-customize-report.md#ConfigureFramework) لإعداد الحد الأدنى لمجموعة معلمات التقارير الإلكترونية. يجب إكمال هذا الإعداد قبل بدء استخدام إطار عمل التقارير الإلكترونية لتصميم إصدار مخصص من التنسيق القياسي للتقارير الإلكترونية.

## <a name="import-the-standard-er-format-configuration"></a>استيراد تكوين التنسيق القياسي للتقارير الإلكترونية.

اتبع الخطوات الواردة في [استيراد تكوين التنسيق القياسي للتقارير الإلكترونية](er-quick-start2-customize-report.md#ImportERSolution1) لإضافة التكوينات القياسية للتقارير الإلكترونية إلى مثيل Dynamics 365 Finance الحالي. استيراد الإصدار **1.9** من تكوين تنسيق **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**. يتم استيراد الإصدار الأساسي 1 من تكوين **نموذج نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** الأساسي بشكل تلقائي من المستودع.

## <a name="customize-the-standard-er-format"></a>تخصيص تنسيق ER القياسي

### <a name="create-the-custom-er-format"></a>إنشاء تنسيق التقارير الإلكترونية المخصص

في هذا السيناريو، أنت ممثل شركة Litware, Inc.، وهي محددة حاليًا كموفر تكوين التقارير الإلكترونية النشط. يجب إنشاء تكوين تنسيق تقارير إلكترونية جديد باستخدام تكوين **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** كأساس.

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوين**، في شجرة التكوين في الجزء الأيمن، وسَّع **نموذج نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**، ثم حدد **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**. سوف تستخدم Litware, Inc. الإصدار 1.9 من تكوين تنسيق ER هذا كأساس للإصدار المخصص.
3. حدد **إنشاء تكوين** لفتح مربع الحوار المنسدل. يمكنك استخدام مربع الحوار هذا لإنشاء تكوين جديد لتنسيق دفع مخصص.
4. في مجموعة الحقول **جديد**، حدد خيار **مشتق من الاسم: تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي، Microsoft**.
5. في حقل **الاسم**، أدخل **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي Litware‎**.
6. حدد **إنشاء تكوين** لإنشاء التنسيق الجديد.

تم إنشاء الإصدار 1.9.1 من تكوين تنسيق التقارير الإلكترونية **Intrastat report Litware**. هذا الإصدار [بالحالة](general-electronic-reporting.md#component-versioning) **مسودة** ويمكن تحريره. يطابق المحتوي الحالي لتنسيق ER الخاص بك محتوي التنسيق الذي توفره Microsoft.

### <a name="make-the-custom-format-runnable"></a>جعل التنسيق المخصص قابلاً للتشغيل

والآن بعد أن تم إنشاء الإصدار الأول من التنسيق المخصص وأصبح بالحالة **مسودة**، يمكنك تشغيل التنسيق لأغراض الاختبار. لتشغيل التقرير، عليك معالجة دفع المورد باستخدام طريقة الدفع التي تشير إلى تنسيق ER المخصص. افتراضيًا، عندما تستدعي أحد تنسيقات ER من التطبيق، يتم فقط استخدام الإصدارات التي بالحالة **مكتمل** أو **مشترك** والتي تتم [مراعاتها](general-electronic-reporting.md#component-versioning). يساعد هذا السلوك في منع استخدام تنسيقات ER التي لها تصميمات غير مكتملة. مع ذلك، بالنسبة لتشغيل الاختبارات الخاصة بك، يمكنك إجبار التطبيق على استخدام إصدار تنسيق ER بالحالة **مسودة**. وبهذه الطريقة، يمكنك تعديل إصدار التنسيق الحالي إذا كانت هناك أية تعديلات مطلوبة. لمزيد من المعلومات، راجع [قابلية التطبيق‬](electronic-reporting-destinations.md#applicability).

لاستخدام إصدار المسودة لتنسيق ER، يجب وضع علامة بوضوح على تنسيق ER.

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات**، في جزء الإجراءات، في علامة التبويب **التكوينات**، في مجموعة **الإعدادات المتقدمة**، حدد **معلمات المستخدمين**.
3. في مربع الحوار **معلمات المستخدم**، قم بتعيين خيارات **إعدادات التشغيل** إلى **نعم**، ثم حدد **موافق**.
4. حدد **تحرير** لتجعل الصفحة الحالية قابلة للتحرير، حسب الحاجة.
5. في شجرة التكوين الموجودة في الجزء الأيمن، حدد **Intrastat report Litware**.
6. قم بتعيين خيار **‏‫تشغيل المسودة‬** إلى **نعم** ، ثم حدد **حفظ**.

    ![خيار تشغيل المسودة في صفحة التكوينات.](./media/er-paginate-excel-reports-derived-format-configuration.png)

## <a name="set-up-foreign-trade-parameters-to-use-the-custom-er-format"></a>اعداد معلمات التجارة الخارجية لاستخدام تنسيق التقارير الإلكترونية المخصص

اتبع هذه الخطوات لتكوين معلمات التجارة الخارجية بحيث يمكنك استخدام التنسيق المخصص.

1. انتقل إلى **الضريبة** \> **الإعداد** \> **التجارة الخارجية** \> **معلمات التجارة الخارجية.**.
2. في صفحة **معلمات التجارة الخارجية** في علامة التبويب السريعة **إعداد التقارير الإلكترونية**، في حقل **تعيين تنسيق الملف**، حدد **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي Litware**.
3. في حقل **تعيين تنسيق التقرير** – حدد **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي Litware**.
4. حدد **حفظ**.

## <a name="configure-the-custom-format-to-use-the-downloaded-report-template"></a>تكوين التنسيق المخصص لاستخدام قالب التقرير الذي تم تنزيله

### <a name="review-the-first-downloaded-excel-template"></a>مراجعة قالب Excel الأول الذي تم تنزيله

1. في تطبيق سطح مكتب Excel، افتح ملف القالب **ERIntrastatReportDemo1.xlsx** الذي قمت بتنزيله في وقت سابق.
2. تحقق من أن القالب يحتوي على نطاقات مسماة لإنشاء أقسام رأس التقرير وتفاصيل التقرير وتذييل التقرير في المستندات التي تم إنشاؤها.

    ![تخطيط قالب Excel رقم 1 في تطبيق سطح المكتب.](./media/er-paginate-excel-reports-template1.gif)

### <a name="replace-the-current-excel-template-in-the-custom-er-format"></a><a id="replace-template"></a>استبدال قالب Excel الحالي بتنسيق التقارير الإلكترونية المخصص

يجب إضافة قالب Excel جديد إلى تنسيق التقارير الإلكترونية المخصص.

1. انتقل إلى **إدارة المؤسسة** \> **التقارير الإلكترونية** \> **التكوينات**.
2. في صفحة **التكوينات** ، في شجرة التكوين في الجزء الأيمن، وسّع **نموذج نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** \> **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**، وحدد تكوين **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي Litware**.
3. حدد **المصمم**.
4. في صفحة **مصمم التنسيق**، في جزء الإجراءات، حدد **إظهار التفاصيل**.
5. تأكد من تحديد مكون التنسيق الجذر **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي: Excel**، ثم، على جزء الإجراءات، على علامة التبويب **استيراد** في المجموعة **استيراد‏‎**، حدد **تحديث من Excel**.
6. في مربع الحوار **تحديث من Excel**، حدد **تحديث القالب**.
7. في مربع الحوار **فتح**، استعرض وصولاً إلى الملف **ERIntrastatReportDemo1.xlsx** الذي قمت بتنزيله سابقًا. ثم حدد **فتح**.
8. حدد **موافق**.
9. حدد **حفظ**.

![بنية التنسيق في مصمم تنسيق التقارير الإلكترونية بعد إضافة قالب Excel الجديد.](./media/er-paginate-excel-reports-format1.png)

## <a name="change-the-data-binding-to-show-the-item-description-on-a-generated-report"></a>تغيير ربط البيانات لإظهار وصف العنصر في تقرير مُنشأ

1. في الصفحة **مصمم التنسيق**، حدد علامة التبويب **التعيين**.
2. وسّغ **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** \> **بنود التقرير**، وحدد المكون **كود السلعة**.
3. حدد **تحرير المعادلة**.
4. غيّر صيغة الربط من `@.CommodityCode` إلى `CONCATENATE(@.CommodityCode, " ", @.ProductName)`.
5. حدد **حفظ**.

![الربط المكون لإظهار وصف العنصر في مصمم تنسيق التقارير الإلكترونية.](./media/er-paginate-excel-reports-format1a.png)

## <a name="generate-an-intrastat-declaration-control-report"></a><a id="generate-intrastat-control-report"></a>إنشاء تقرير مراقبة إقرار نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي

تأكد أولاً من وجود حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي للإبلاغ عنها في صفحة **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**.

![الحركات في صفحة نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي.](./media/er-paginate-excel-reports-transactions1.gif)

ثم استخدم تنسيق التقارير الإلكترونية المخصص لإنشاء تقرير المراقبة الخاص بإقرار نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي.

1. انتقل إلى **الضريبة** \> **الإقرارات‬** \> **التجارة الخارجية** \> **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**.
2. في صفحة **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**، في جزء الإجراءات، حدد **إخراج** \> **تقرير**.
3. في مربع الحوار **تقرير نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**، اتبع هذه الخطوات لتشغيل التقرير:

    1. عيّن الحقلين **تاريخ البدء** و **تاريخ الانتهاء** لتضمين حركات خاصة بنظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي في التقرير.
    2. عيّن الخيار **إنشاء ملف** إلى **لا**.
    3. عيّن خيار **إنشاء تقرير** إلى **نعم**.
    4. حدد **موافق**.

4. قم بتنزيل وحفظ المستند الذي تم إنشاؤه.
5. افتح في Excel، ثم راجعه.

    ![مستند Excel المُنشأ في تطبيق سطح المكتب.](./media/er-paginate-excel-reports-document1.png)

## <a name="configure-the-custom-format-to-paginate-generated-documents"></a>تكوين التنسيق المخصص لفصل صفحات المستندات التي تم إنشاؤها

### <a name="review-the-second-downloaded-excel-template"></a>مراجعة قالب Excel الثاني الذي تم تنزيله

1. في Excel، افتح ملف القالب **ERIntrastatReportDemo2.xlsx** الذي قمت بتنزيله في وقت سابق.
2. قارن هذا القالب مع القالب **ERIntrastatReportDemo1.xlsx**، وتأكد من احتوائه على عدة أسماء Excel جديدة لإنشاء أقسام خاصة بالصفحة وتعبئتها في المستندات المُنشأة.

    - يُضاف النطاق **ReportPageHeader** لإنشاء رؤوس الصفحات.
    - يُضاف النطاق **ReportPageFooter‎** لإنشاء تذييلات الصفحات.
    - الخلية **ReportPageFooter\_PageLines** مكوّنة لإظهار عدد الحركات في الصفحة.
    - الخلية **ReportPageFooter\_PageAmount** مكوّنة لإظهار إجمالي عدد الحركات في الصفحة.
    - الخلية **ReportPageFooter\_PageWeight** مكوّنة لإظهار الوزن الإجمالي للحركات الحركات في الصفحة.
    - الخلية **ReportPageFooter\_RunningCounterLines** مكوّنة لإظهار العداد الحالي للحركات من بداية التقرير حتى الصفحة الحالية.
    - الخلية **ReportPageFooter\_RunningTotalAmount** مكوّنة لإظهار إجمالي المبلغ الحالي لجميع الحركات من بداية التقرير حتى الصفحة الحالية.
    - الخلية **ReportPageFooter\_RunningTotalWeight** مكوّنة لإظهار إجمالي الوزن الحالي للحركات من بداية التقرير حتى الصفحة الحالية.

    ![تخطيط قالب Excel رقم 2 في تطبيق سطح المكتب.](./media/er-paginate-excel-reports-template2a.gif)

    الخلية **CommodityCode** لهذا القالب مكوّنة لتمكين التفاف نص الخلية.. نظرًا لتكوين صف تفاصيل الحركة بحيث يحتوي تلقائيًا على ارتفاع الصف، يجب أن يتغيّر ارتفاع الصف بكامله بشكل تلقائي عند التفاف النص الموجود في الخلية **CommodityCode‎**.

    ![تم تكوين الخلية CommodityCode‎ لتمكين التفاف نص الخلية.](./media/er-paginate-excel-reports-template2b.gif)

### <a name="repeat-the-replacement-of-the-current-excel-template-in-the-custom-er-format"></a>تكرار استبدال قالب Excel الحالي بتنسيق التقارير الإلكترونية المخصص

1. اتبع الخطوات الموجودة في القسم [استبدال قالب Excel الحالي في تنسيق التقارير الإلكترونية المخصص](#replace-template) في هذا الموضوع. ولكن، في الخطوة 7، حدد الملف **ERIntrastatReportDemo2.xlsx** file.
2. في صفحة **مصمم التنسيق**، وسّع **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**.
3. قم بتسمية مكونات تنسيق [النطاق](er-fillable-excel.md#range-component) التي تمت إضافتها إلى تنسيق التقارير الإلكترونية القابل للتحرير لمزامنة البنية مع بنية قالب Excel المطبّق:

    1. حدد مكون **النطاق** المقترن باسم Excel **ReportPageHeader**.
    2. على علامة التبويب **تنسيق**، في حقل **الاسم**، أدخل **رأس صفحة التقرير**.
    3. حدد مكون **النطاق** المقترن باسم Excel **ReportPageFooter**.
    4. على علامة التبويب **تنسيق**، في حقل **الاسم**، أدخل **تذييل صفحة التقرير**.

4. حدد **حفظ**.

![بنية التنسيق في مصمم تنسيق التقارير الإلكترونية بعد استبدال قالب Excel.](./media/er-paginate-excel-reports-format2.png)

### <a name="change-the-format-structure-to-implement-document-pagination"></a>تغيير بنية التنسيق لتنفيذ فصل صفحات المستندات

1. في الصفحة **مصمم التنسيق**، في شجره التنسيق في الجزء الأيمن، حدد المكون الجذر **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**.
2. حدد **إضافة**.
3. في مربع الحوار **إضافة**، حدد مكون [الصفحة](er-fillable-excel.md#page-component) في مجموعة **Excel** للمكونات.
4. في مربع الحوار **خصائص المكون**، في الحقل **الاسم**، أدخل **صفحة التقرير**. ثم حدد **موافق**.
5. لاستخدام مكون **رأس صفحة التقرير** كرأس صفحة علي كل صفحه مُنشأة، اتبع الخطوات التالية:

    1. حدد المكون **رأس صفحة التقرير**، ثم حدد **قص**.
    2. حدد المكون **رأس صفحة التقرير**، ثم حدد **لصق**.
    3. قم بتوسيع **صفحة التقرير**.
    4. لإجبار مكون **الصفحة** على [اعتبار](er-fillable-excel.md#page-component-structure) هذا النطاق كرأس صفحة، حدد **رأس صفحة التقرير**، ثم على علامة التبويب **تنسيق**، في الحقل **بدون نسخ متماثل**، حدد **بدون نسخ متماثل**.

6. لفصل صفحات مستند تم إنشاؤه بحيث يتم اعتبار المحتوي على بنود التقرير، اتبع الخطوات التالية:

    1. حدد المكون **بنود التقرير**، ثم حدد **قص**.
    2. حدد المكون **رأس صفحة التقرير**، ثم حدد **لصق**.

7. لتضمين تذييل التقرير بعد أسطر التقرير ولكن قبل تذييل الصفحة الأخيرة، اتبع الخطوات التالية:

    1. حدد المكون **تذييل التقرير**، ثم حدد **قص**.
    2. حدد المكون **رأس صفحة التقرير**، ثم حدد **لصق**.

8. لاستخدام المكون **تذييل صفحة التقرير** كتذييل صفحة علي كل صفحه مُنشأة، اتبع الخطوات التالية:

    1. حدد المكون **تذييل صفحة التقرير**، ثم حدد **قص**.
    2. حدد المكون **رأس صفحة التقرير**، ثم حدد **لصق**.
    3. لإجبار مكون **الصفحة** على [اعتبار](er-fillable-excel.md#page-component-structure) هذا النطاق كتذييل صفحة، حدد **تذييل صفحة التقرير**، ثم على علامة التبويب **تنسيق**، في الحقل **بدون نسخ متماثل**، حدد **بدون نسخ متماثل**.

![بنية التنسيق في مصمم تنسيق التقارير الإلكترونية بعد تطبق فصل صفحات المستندات.](./media/er-paginate-excel-reports-format3.png)

### <a name="add-data-sources-to-calculate-page-footer-totals"></a>إضافة مصادر بيانات لحساب إجماليات تذييل الصفحة

يجب عليك تكوين مصادر بيانات جديدة لحساب إجمالي الصفحة، والعداد الحالي والقيم الإجمالية الجارية، ولإظهارها في قسم تذييل الصفحة. ننصحك باستخدام مصادر بيانات [جمع البيانات](er-data-collection-data-sources.md) لهذا الغرض.

1. في الصفحة **مصمم التنسيق**، حدد علامة التبويب **التعيين**.
2. حدد **إضافة جذر**، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **عام**، حدد **حاوية فارغة**.
    2. في مربع الحوار **خصائص مصدر البيانات "حاوية فارغة"** ـ في حقل  **الاسم**، أدخل **إجمالي**.
    3. حدد **موافق**.

3. حدد مصدر البيانات **إجمالي**، وحدد **إضافة**، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **عام**، حدد **حاوية فارغة**.
    2. في مربع الحوار **خصائص مصدر البيانات "حاوية فارغة"** ـ في حقل  **الاسم**، أدخل **الصفحة**.
    3. حدد **موافق**.

4. حدد **إضافة** مرة أخرى، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **عام**، حدد **حاوية فارغة**.
    2. في مربع الحوار **خصائص مصدر البيانات "حاوية فارغة"** ـ في حقل  **الاسم**، أدخل **الحالي**.
    3. حدد **موافق**.

5. حدد مصدر البيانات **Total.Page**، وحدد **إضافة**، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
    2. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **المبلغ**.
    3. في الحقل **نوع الصنف**، حدد **حقيقي**.
    4. عيّن الخيار **تجميع جميع القيم** إلى **نعم**.
    5. حدد **موافق**.

6. حدد **إضافة** مرة أخرى، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
    2. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **الوزن**.
    3. في الحقل **نوع الصنف**، حدد **حقيقي**.
    4. عيّن الخيار **تجميع جميع القيم** إلى **نعم**.
    5. حدد **موافق**.

7. حدد مصدر البيانات **Total.Running‎**، وحدد **إضافة**، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
    2. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **المبلغ**.
    3. في الحقل **نوع الصنف**، حدد **حقيقي**.
    4. عيّن الحقل **تجميع جميع القيم** إلى **نعم**.
    5. حدد **موافق**.

8. حدد **إضافة** مرة أخرى، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
    2. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **الوزن**.
    3. في الحقل **نوع الصنف**، حدد **حقيقي**.
    4. عيّن الحقل **تجميع جميع القيم** إلى **نعم**.
    5. حدد **موافق**.

9. حدد **إضافة** مرة أخرى، ثم اتبع الخطوات التالية:

    1. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
    2. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **البنود**.
    3. في الحقل **نوع العنصر**، حدد **عدد صحيح**.
    4. عيّن الحقل **تجميع جميع القيم** إلى **نعم**.
    5. حدد **موافق**.

10. حدد **حفظ**.

### <a name="add-data-sources-to-control-page-footer-visibility"></a>إضافة مصادر بيانات للتحكم في رؤية تذييل الصفحة

إذا كنت تخطط للتحكم في رؤية تذييل الصفحة، ولم تخطط لتضمين التذييل على الصفحة النهائية إذا كانت تحتوي على حركات، فيمكنك تكوين مصدر بيانات جديد لحساب العداد الحالي المطلوب.

1. في الصفحة **مصمم التنسيق**، حدد علامة التبويب **التعيين**.
2. حدد مصدر بيانات **Total.Running**، وحدد **إضافة**.
3. في مربع الحوار **إضافة مصدر بيانات**، في القسم **وظائف**، حدد **جمع البيانات**.
4. في مربع الحوار **خصائص مصدر البيانات "جمع البيانات"** ـ في حقل  **الاسم**، أدخل **البنود2**.
5. في الحقل **نوع العنصر**، حدد **عدد صحيح**.
6. عيّن الخيار **تجميع جميع القيم** إلى **نعم**.
7. حدد **موافق**.
8. حدد **حفظ**.

![مصادر البيانات المضافة في مصمم تنسيق التقارير الإلكترونية.](./media/er-paginate-excel-reports-format4.png)

### <a name="configure-bindings-to-collect-total-values"></a>تكوين الروابط لجمع القيم الإجمالية

1. في صفحة **مصمم التنسيق**، في شجرة التنسيق، وسعّ المكون **بنود التقرير** وحدد المكون المتداخل **قيمة الفاتورة**.
2. حدد **تحرير المعادلة**.
3. غيّر صيغة الربط من `NUMBERVALUE(NUMBERFORMAT(@.InvoiceValue, "F"&TEXT(model.Parameters.IntrastatAmountDecimals)), ".", "")` إلى `Total.Page.Amount.Collect(NUMBERVALUE(NUMBERFORMAT(@.InvoiceValue, "F"&TEXT(model.Parameters.IntrastatAmountDecimals)), ".", ""))`.

    > [!NOTE]
    > بالإضافة إلى وضع قيمة المبلغ في خليه Excel لكل حركة مكررة، تقوم عملية الربط هذه بجمع القيم في مصدر بيانات جمع البيانات **Total.Page.Amount**.

4. حدد المكون المتداخل **الوزن**.
5. حدد **تحرير المعادلة**.
6. غيّر صيغة الربط من `@.'$RoundedWeight'` إلى `Total.Page.Weight.Collect(@.'$RoundedWeight')`.

    > [!NOTE]
    > بالإضافة إلى وضع قيمة الوزن في خليه Excel لكل حركة مكررة، تقوم عملية الربط هذه بجمع القيم في مصدر البيانات **Total.Page.Weight‎**.

![الروابط المكونة لتجميع القيم الإجمالية في مصمم تنسيق التقارير الإلكترونية.](./media/er-paginate-excel-reports-format5.png)

### <a name="configure-bindings-to-fill-in-page-footer-totals"></a>تكوين الروابط لتعبئة إجماليات تذييل الصفحات

1. في الصفحة **مصمم التنسيق**، في شجرة التنسيق، وسّع المكون **تذييل صفحة التقرير**، وحدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_PageAmount** في Excel، ثم اتبع هذه الخطوات:

    1. في شجرة مصادر البيانات في الجزء الأيسر ، حدد العنصر **Total.Page.Amount.Sum()**.
    2. حدد **ربط**.
    3. حدد **تحرير المعادلة**.
    4. تحديث الصيغة إلى `Total.Page.Amount.Sum(false)`.

    > [!NOTE]
    > يجب تحديد الوسيطة لهذه الدالة باعتبارها **خطـ** للاحتفاظ بالبيانات المجمعة للصفحة الحالية، لأن هذه البيانات مطلوبة لحساب المبلغ الإجمالي الحالي وإجمالي عدد الأسطر في الصفحة، وعداد الأسطر الحالي.

2. في شجرة التنسيق، حدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_PageWeight** في Excel، ثم اتبع هذه الخطوات:

    1. في شجرة مصادر البيانات في الجزء الأيسر ، حدد العنصر **Total.Page.Weight.Sum()**.
    2. حدد **ربط**.
    3. حدد **تحرير المعادلة**.
    4. تحديث الصيغة إلى `Total.Page.Weight.Sum(false)`.

### <a name="configure-bindings-to-fill-in-page-running-totals"></a>تكوين الروابط لتعبئة الإجماليات الحالية

1. في الصفحة **مصمم التنسيق**، في شجرة التنسيق، وسّع المكون **تذييل صفحة التقرير**، وحدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_RunningTotalAmount** في Excel، ثم اتبع هذه الخطوات:

    1. في شجرة مصادر البيانات في الجزء الأيسر ، حدد العنصر **Total.Running.Amount.Collect()**.
    2. حدد **ربط**.
    3. حدد **تحرير المعادلة**.
    4. تحديث الصيغة إلى `Total.Running.Amount.Sum(false)+Total.Running.Amount.Collect(Total.Page.Amount.Sum(true))`.

    > [!NOTE]
    > يقوم المعامل `Total.Running.Amount.Sum(false)` بإرجاع المبلغ الإجمالي الحالي الذي تم جمعه في وقت سابق. يقوم المعامل `Total.Running.Amount.Collect(Total.Page.Amount.Sum(true))` بإرجاع المبلغ الإجمالي للصفحة الحالية. يجب تحديد وسيطة الدالة المتداخلة للمعامل الثاني باعتبارها **صواب** لإعادة تعيين جمع البيانات `Total.Page.Amount` فور وضع هذه القيمة في مجموعة الإجمال الحالية `Total.Running.Amount`. يجب أن تبدأ الوسيطة المحددة عملية جمع إجمالي الصفحة التالية من القيمة 0 (الصفر).
    >
    > يتم استدعاء الدالة `Total.Running.Amount.Sum(false)` لإدخال إجمالي المبلغ الحالي في خلية Excel **ReportPageFooter\_RunningTotalAmount** على الصفحة الحالية.

2. في شجرة التنسيق، حدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_RunningTotalWeight** في Excel، ثم اتبع هذه الخطوات:

    1. في شجرة مصادر البيانات في الجزء الأيسر ، حدد العنصر  **Total.Running.Weight.Collect()**.
    2. حدد **ربط**.
    3. حدد **تحرير المعادلة**.
    4. تحديث الصيغة إلى `Total.Running.Weight.Sum(false)+Total.Running.Weight.Collect(Total.Page.Weight.Sum(true))`.

### <a name="configure-bindings-to-fill-in-the-page-running-counter"></a>تكوين الروابط لتعبئة عداد الصفحات الحالي

1. في الصفحة **مصمم التنسيق**، في شجرة التنسيق، وسّع المكون **تذييل صفحة التقرير**، وحدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_RunningCounterLines** في Excel.
2. حدد **تحرير المعادلة**.
3. أضف الصيغة `Total.Running.Lines.Collect(COUNT(Total.Page.Amount.Result))`.

    > [!NOTE]
    > ترجع هذه الصيغة عدد قيم المبالغ المجمعة للتقرير بكامله. يساوي هذا الرقم عدد المعاملات التي تم تكرارها في اللحظة الحالية. وفي نفس الوقت، تقوم الصيغة بجمع القيمة المرتجعة في المجموعة **Total.Running.Lines**.

### <a name="configure-bindings-to-fill-in-the-page-footer-counter"></a>تكوين الروابط لتعبئة عداد التذييلات الحالي

1. في الصفحة **مصمم التنسيق**، في شجرة التنسيق، وسّع المكون **تذييل صفحة التقرير**، وحدد المكون المتداخل **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_PageLines** في Excel.
2. حدد **تحرير المعادلة**.
3. أضف الصيغة `COUNT(Total.Page.Amount.Result)-Total.Running.Lines.Sum(false)`.

    > [!NOTE]
    > تحسب هذه الصيغة عدد الحركات على الصفحة الحالية كالفرق بين عدد الحركات التي تم جمعها في **Total.Page.Amount.Result** للتقرير بكامله وعدد الحركات التي تم تخزينها في هذه المرحلة في **Total.Running.Lines.Sum**. ونظرًا لتخزين عدد الحركات للصفحة الحالية في **Total.Running.Lines** في عملية ربط المكون **النطاق** الذي يشير إلى الخلية **ReportPageFooter\_RunningCounterLines** في Excel، لا يتم تضمين عدد الحركات على الصفحة الحالية. وبالتالي، يساوي هذا الفرق عدد الحركات في الصفحة الحالية.

![الروابط المكونة لتعبئة عداد تذييلات الصفحة في مصمم تنسيق التقارير الإلكترونية.](./media/er-paginate-excel-reports-format6.png)

### <a name="configure-component-visibility"></a>تكوين رؤية المخزون

يمكنك تغيير رؤية رأس وتذييل الصفحة على صفحة محددة من مستند تم إنشاؤه لإخفاء العناصر التالية:

- رأس الصفحة في الصفحة الأولى، لأن رأس التقرير يحتوي بالفعل على عناوين أعمدة
- رأس الصفحة على أي صفحة لا يوجد بها حركات يمكنها أن تحدث للصفحة الأخيرة
- تذييل الصفحة على أي صفحة لا يوجد بها حركات يمكنها أن تحدث للصفحة الأخيرة

لتغيير الرؤية، قم بتحديث الخاصية **ممكّن** للمكونين **رأس صفحة التقرير** و **تذييل صفحة التقرير**.

1. في صفحة **مصمم التنسيق**، في شجرة التنسيق، وسعّ المكون **صفحة التقرير** وحدد المكون المتداخل **رأس صفحة التقرير**، ثم اتبع هذه الخطوات.

    1. حدد **تحرير** للحقل **ممكّن**.
    2. في الصفحة **مصمم الصيغة**، في حقل **الصيغة‏‎**، أدخل التعبير التالي:

        `AND(`<br>
        `COUNT(Total.Page.Amount.Result)<>0,`<br>
        `COUNT(Total.Page.Amount.Result)<>COUNT(model.CommodityRecord)`<br>
        `)`

2. في شجرة التنسيق ، حدد المكون المتداخل **تذييل صفحة التقرير**، ثم اتبع الخطوات التالية:

    1. حدد **تحرير** للحقل **ممكّن**.
    2. في الصفحة **مصمم الصيغة**، في حقل **الصيغة‏‎**، أدخل التعبير التالي:

        `(`<br>
        `COUNT(Total.Page.Amount.Result)-Total.Running.Lines2.Sum(false)+`<br>
        `0*Total.Running.Lines2.Collect(COUNT(Total.Page.Amount.Result))`<br>
        `)<>0`

    > [!NOTE]
    > تُستخدم البنية `COUNT(Total.Page.Amount.Result)-Total.Running.Lines2.Sum(false)` لحساب عدد الحركات في الصفحة الحالية. تُستخدم البنية `0*Total.Running.Lines2.Collect(COUNT(Total.Page.Amount.Result)` لإضافة عدد الحركات في الصفحة الحالية إلى المجموعة، لمعالجة رؤية تذييل الصفحة التالية بشكل صحيح.
    >
    > لا يمكن إعادة استخدام المجموعة `Total.Running.Lines` هنا بسبب معالجة الخاصية **ممكّن** لمكون أساسي **بعد** معالجة روابط المكونات المتداخلة. عند معالجة الخاصية **ممكّن**، تتم زيادة المجموعة `Total.Running.Lines` بعدد الحركات على الصفحة الحالية.

3. حدد **حفظ**.

## <a name="generate-an-intrastat-declaration-control-report-updated"></a>إنشاء تقرير مراقبة إقرار نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي (محدّث).

1. تأكد أولاً من وجود 24 حركة في صفحة **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**. كرر الخطوات الموجودة في القسم [إنشاء تقرير مراقبة إقرار نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي‬](#generate-intrastat-control-report) من هذا الموضوع لإنشاء تقرير المراقبة ومراجعته.

    يتم عرض كافة الحركات في الصفحة الأولى. تساوي إجماليات الصفحات وعداداتها إجماليات التقارير وعداداتها. يتم إخفاء رأس الصفحة في الصفحة الأولى، لأن رأس التقرير يحتوي بالفعل على عناوين أعمدة. يتم إخفاء رأس الصفحة وتذييلها على الصفحة الثانية لأت هذه الصفحة لا تحتوي على حركات.

    ![مستند Excel المُنشأ في تطبيق سطح المكتب.](./media/er-paginate-excel-reports-document2.gif)

2. حدّث حركتين في صفحة **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** عن طريق تغيير رمز **رقم العنصر** من **D00006** إلى **L0010**. لاحظ أن اسم المنتج للعنصر الجديد **زوج مكبر صوت استيريو نشط** هو أطول من اسم المنتج للعنصر الأصلي **مكبر صوت قياسي**. تفرض هذه الحالة التفاف النص في الخلية المقابلة للمستند الذي تم إنشاؤه. من المفترض أن يتم الآن تحديث فصل صفحات المستند والجمع والتعداد المرتبطين بالصفحة. كرر الخطوات الموجودة في القسم [إنشاء تقرير مراقبة إقرار نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي‬](#generate-intrastat-control-report) لإنشاء تقرير المراقبة ومراجعته.

    في الوقت الحالي، يتم تقديم الحركات على صفحتين، ويتم حساب إجماليات الصفحات وعداداتها بشكل صحيح. يتم إخفاء نطاق رأس الصفحة بشكل صحيح على الصفحة الأولى ويظهر على الصفحة الثانية. يظهر تذييل الصفحة في الصفحتين نظرا لأنهما تحتويان على حركات.

    ![مستند Excel المحدّث المُنشأ في تطبيق سطح المكتب.](./media/er-paginate-excel-reports-document3.gif)

## <a name="frequently-asked-questions"></a>الأسئلة المتداولة

### <a name="is-there-any-way-to-recognize-when-the-final-page-is-processed-by-the-page-format-component"></a>هل هناك طريقة لمعرفة متى تتم معالجة الصفحة الأخيرة بواسطة مكون تنسيق الصفحة؟

مكون **الصفحة** [لا يعرض](er-fillable-excel.md#page-component-limitations) معلومات حول عدد الصفحات التي تمت معالجتها والعدد الإجمالي للصفحات في مستند تم إنشاؤه. ومع ذلك، يمكنك تكوين [صيغ](er-formula-language.md) التقارير الإلكترونية للتعرف على الصفحة الأخيرة وفيما يلي مثال على ذلك:

- حساب العدد الإجمالي للحركات التي تمت معالجتها باستخدام مكون **صفحة التقرير**. يمكنك القيام بذلك باستخدام الصيغة `COUNT(Total.Page.Amount.Result)`. 
- حساب العدد الإجمالي للحركات التي يجب معالجتها بالاستناد إلى الربط `model.CommodityRecord` الذي تم تكوينه للمكون **بنود التقرير**. يمكنك القيام بذلك باستخدام الصيغة `COUNT(model.CommodityRecord)`.
- مقارنة الرقمين للتعرف على الصفحة الأخيرة. عندما تكون القيمتان متساويتين، يتم إنشاء الصفحة الأخيرة.

> [!NOTE]
> نوصي باستخدام هذه الطريقة فقط عندما لا تحتوي الخاصية **ممكّن** للمكون **بنود التقرير** على صيغة قد ترجع القيمة [خطأ](er-formula-supported-data-types-primitive.md#boolean) في وقت التشغيل لبعض السجلات [المكررة](er-formula-supported-data-types-composite.md#record) في [قائمة السجلات](er-formula-supported-data-types-composite.md#record-list) المرتبطة.

## <a name="additional-resources"></a>الموارد الإضافية

- [تصميم تكوين لإنشاء مستندات بتنسيق Excel](er-fillable-excel.md)
- [استخدام مصادر بيانات جمع البيانات في تنسيقات التقارير الإلكترونية](er-data-collection-data-sources.md)

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
