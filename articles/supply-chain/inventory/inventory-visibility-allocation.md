---
title: توزيع مخزون Inventory Visibility
description: يشرح هذا المقال كيفية إعداد واستخدام ميزة تخصيص المخزون، والتي تتيح لك تخصيص مخزون مخصص لضمان قدرتك على تلبية أكثر القنوات أو العملاء ربحية.
author: yufeihuang
ms.date: 05/27/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2022-05-13
ms.dyn365.ops.version: 10.0.27
ms.openlocfilehash: ccc3a8c4b3d0649397b1d1f9139f7feebf39b02f
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 06/03/2022
ms.locfileid: "8852494"
---
# <a name="inventory-visibility-inventory-allocation"></a>تخصيص المخزون لرؤية المخزون

[!include [banner](../includes/banner.md)]

## <a name="business-background-and-purpose"></a>الخلفية التجارية والغرض منها

في كثير من الحالات، يجب على المصنعين وتجار التجزئة وغيرهم من أصحاب الأعمال في سلسلة التوريد تخصيص مخزون مسبقًا لقنوات المبيعات أو المواقع أو العملاء المهمة أو لأحداث مبيعات محددة. يعد تخصيص المخزون ممارسة نموذجية في عملية التخطيط التشغيلي للمبيعات، ويتم إجراؤه قبل حدوث أنشطة المبيعات الفعلية وإنشاء أمر مبيعات.

على سبيل المثال، تمتلك شركة دراجات مخزونًا محدودًا لدراجة مشهورة جدًا. تقوم هذه الشركة بالمبيعات عبر الإنترنت وفي المتاجر. في كل قناة مبيعات، تمتلك الشركة عددًا قليلاً من الشركاء المؤسسيين المهمين (الأسواق وتجار التجزئة الكبار) الذين يطالبون بتوفير جزء معين من مخزون الدراجة المتاح لهم. لذلك، يجب أن تكون شركة الدراجات قادرة على موازنة توزيع المخزون عبر القنوات وأيضًا إدارة توقعات شركائها من كبار الشخصيات. أفضل طريقة لتحقيق كلا الهدفين هي استخدام تخصيص المخزون، بحيث يمكن لكل قناة وبائع تجزئة تلقي كميات مخصصة محددة يمكن بيعها للمستهلكين لاحقًا.

تخصيص المخزون له غرضان تجاريان أساسيان:

- **حماية المخزون (المبارزة)** – ترغب المؤسسات في تخصيص مخزون محدود أو محدود مسبقًا للقنوات والمناطق والعملاء من كبار الشخصيات والشركات الفرعية ذات الأولوية. تهدف ميزة تخصيص رؤية المخزون إلى حماية المخزون المخصص، بحيث لا تؤثر عمليات التخصيص أو الحجوزات أو طلبات المبيعات الأخرى على المخزون المخصص مسبقًا.
- **التحكم في البيع الزائد** – تهدف ميزة تخصيص رؤية المخزون إلى وضع قيود على الكميات المخصصة مسبقًا، بحيث لا يفرط الطرف المتلقي (على سبيل المثال، قناة أو مجموعة عملاء) في استهلاكها عندما تكون معاملة المبيعات الفعلية التي تستند إلى حجز بسيط تدخل حيز التنفيذ.

## <a name="allocation-definition-in-inventory-visibility-service"></a>تعريف التخصيص في خدمة رؤية المخزون

على الرغم من أن ميزة التخصيص في خدمة رؤية المخزون لا تضع جانباً كميات المخزون المادية، إلا أنها تشير إلى كمية المخزون المادية المتاحة لتحديد كمية تجمع افتراضي أولي *متاح للتخصيص* خاص بها. يعد تخصيص المخزون في رؤية المخزون تخصيصًا بسيطًا. يتم إجراؤه قبل حدوث معاملات المبيعات الفعلية ولا يعتمد على أوامر المبيعات. على سبيل المثال، يمكنك تخصيص مخزون لأهم قنوات مبيعاتك أو كبار تجار التجزئة في الشركات قبل أن يزور أي عميل نهائي قناة المبيعات أو متجر البيع بالتجزئة لشرائه.

يتمثل الاختلاف بين تخصيص المخزون [والحجز البرمجي للمخزون](inventory-visibility-reservations.md) في أن الحجز البرمجي يرتبط عادةً بحركات المبيعات الفعلية (بنود أوامر المبيعات). لذلك، إذا كنت ترغب في استخدام ميزات التخصيص والحجز الناعم معًا، فإننا نوصيك بإجراء تخصيص المخزون أولاً ثم إجراء حجز ضعيف مقابل الكميات المخصصة. لمزيد من المعلومات، راجع [استهلاك كحجز برمجي](#consume-to-soft-reserved).

تتيح ميزة تخصيص المخزون لمخططي المبيعات أو مديري الحسابات الرئيسية إدارة المخزون المهم وتخصيصه مسبقًا عبر مجموعات التخصيص (مثل القنوات والمناطق ومجموعات العملاء). كما أنه يدعم التتبع في الوقت الفعلي، والتعديل، وتحليلات الاستهلاك مقابل الكميات المخصصة، بحيث يمكن إعادة التزويد أو إعادة التخصيص في الوقت المحدد. تعد هذه القدرة على الحصول على رؤية في الوقت الفعلي في التخصيص والاستهلاك والتخصيص مهمة بشكل خاص في أحداث البيع السريع أو الترويج.

## <a name="terminology"></a>المصطلحات

المصطلحات والمفاهيم التالية مفيدة في مناقشات تخصيص المخزون:

- **مجموعة التخصيص** – المجموعة التي تمتلك التخصيص، مثل قناة المبيعات أو مجموعة العملاء أو نوع الأمر.
- **قيمة مجموعة التخصيص** – قيمة كل مجموعة تخصيص. على سبيل المثال، قد يكون *الويب* أو *المتجر* قد تكون قيمة مجموعة تخصيص قنوات المبيعات، بينما قد يكون *كبار الشخصيات* أو *عادي* قيمة مجموعة تخصيص العملاء.
- **التدرج الهرمي للتخصيص** – وسيلة لدمج مجموعات التخصيص بطريقة هرمية. على سبيل المثال، يمكنك تحديد *قناة* كمستوى هرمي 1،  و *المنطقة* كمستوى 2، و *مجموعة العملاء* كمستوى 3. أثناء تخصيص المخزون، يجب عليك اتباع التسلسل الهرمي للتخصيص عندما تحدد قيمة مجموعة التخصيص. على سبيل المثال، قد تخصص 200 دراجة حمراء لقناة *الويب*، ومنطقة *لندن*، ومجموعة العملاء من *كبار الشخصيات*.
- **متاح للتخصيص** – *التجمع الشائع الافتراضي* التي تشير إلى الكمية المتوفرة لمزيد من التخصيص. إنه مقياس محسوب يمكنك تحديده بحرية باستخدام الصيغة الخاصة بك. إذا كنت تستخدم أيضًا ميزة الحجز البرمجي، نوصيك باستخدام نفس الصيغة لحساب المتاح للتخصيص والمتاح للحجز.
- **مخصص** – مقياس مادي يوضح الحصة المخصصة التي يمكن لمجموعات التخصيص استهلاكها.
- **تم الاستهلاك** – مقياس مادي يشير إلى الكميات التي تم استهلاكها مقابل الكمية المخصصة الأصلية. عند إضافة الأرقام إلى هذا المقياس المادي، يتم تقليل القياس المادي المخصص تلقائيًا.

يوضح الرسم التوضيحي التالي سير عمل الأعمال لتخصيص المخزون.

![سير عمل أعمال تخصيص رؤية المخزون.](media/inventory-visibility-allocation-flow.png "سير عمل أعمال تخصيص رؤية المخزون.")

## <a name="set-up-inventory-allocation"></a>إعداد تخصيص المخزون

تتكون ميزة تخصيص المخزون من المكونات التالية:

- مصدر البيانات المحدد مسبقًا والمرتبط بالتخصيص والمقاييس المادية والمقاييس المحسوبة.
- مجموعات تخصيص قابلة للتخصيص لها ثمانية مستويات كحد أقصى.
- مجموعة من واجهات برمجة تطبيقات التخصيص (APIs):

    - تخصيص
    - إعادة تخصيص
    - إلغاء تخصيص
    - استهلاك
    - استعلام

تتكون عملية تكوين ميزة التخصيص من خطوتين:

- قم بإعداد [مصدر البيانات](inventory-visibility-configuration.md#data-source-configuration) و[مقاييسها](inventory-visibility-configuration.md#data-source-configuration-physical-measures).
- قم بإعداد اسم مجموعة التخصيص والتسلسل الهرمي.

### <a name="predefined-data-source"></a>مصدر بيانات محدد مسبقًا

عندما تقوم بتمكين ميزة التخصيص واستدعاء واجهة برمجة تطبيقات تحديث التكوين، فإن رؤية المخزون تنشئ مصدر بيانات واحدًا محددًا مسبقًا والعديد من الإجراءات الأولية.

تمت تسمية مصدر البيانات باسم `@iv`.

فيما يلي المقاييس المادية الأولية:

- `@iv`

    - `@allocated`
    - `@cumulative_allocated`
    - `@consumed`
    - `@cumulative_consumed`

فيما يلي المقاييس المحسوبة الأولية:

- `@iv`

    - `@iv.@available_to_allocate` = `??` – `??` – `@iv.@allocated`

### <a name="add-other-physical-measures-to-the-available-to-allocate-calculated-measure"></a>أضف مقاييس مادية أخرى إلى المقياس المحسوب المتاح للتخصيص

لاستخدام التخصيص، يجب عليك إعداد المقياس المحسوب المتاح للتخصيص (`@iv.@available_to_allocate`). على سبيل المثال، لديك مصدر بيانات `fno` ومقياس `onordered`، ومصدر بيانات `pos` ومقياس `inbound`، وتريد إجراء تخصيص متاح لمجموع `fno.onordered` و`pos.inbound`. في هذه الحالة، يجب أن يحتوي `@iv.@available_to_allocate` على `pos.inbound` و`fno.onordered` في المعادلة. وفيما يلي مثال على ذلك:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

### <a name="change-the-allocation-group-name"></a>تغيير اسم مجموعة التخصيص

يمكن تعيين ثمانية أسماء مجموعة تخصيص كحد أقصى. المجموعات لها تسلسل هرمي.

يمكنك تعيين أسماء المجموعات في صفحة **تكوين Power App لرؤية المخزون**. لفتح هذه الصفحة، في بيئة Microsoft Dataverse الخاصة بك، افتح تطبيق رؤية المخزون، وحدد **تكوين \> تخصيص**.

على سبيل المثال، إذا كنت تستخدم أربعة أسماء مجموعات وقمت بتعيينها إلى \[`channel`، `customerGroup`، `region`، `orderType`\]، ستكون هذه الأسماء صالحة للطلبات المتعلقة بالتخصيص عند استدعاء واجهة برمجة تطبيقات تحديث التكوين.

### <a name="allocation-using-tips"></a>نصائح استخدام التخصيص

- لكل منتج، يجب أن تستخدم وظيفة التخصيص في نفس *مستوى الأبعاد* وفقًا للتسلسل الهرمي لفهرس المنتج الذي قمت بتعيينه [في تكوين التدرج الهرمي لفهرس المنتجات.](inventory-visibility-configuration.md#index-configuration). علي سبيل المثال ، لنفترض ان التسلسل الهرمي للفهرس هو \[`Site`و `Location`و `Color`و `Size`\]. إذا قمت بتوزيع بعض الكمية لمنتج واحد في مستوي \[`Site`البعد، `Location`و `Color`\] ، فانه في المرة التالية التي ترغب في تخصيص هذا المنتج فيها ، يجب عليك أيضا التخصيص علي نفس المستوي و \[`Site`و `Location`و `Color`\] إذا كنت تستخدم المستوي \[`Site`أو `Location`و `Color`و `Size`\] أو \[`Site`و `Location`\] ، فان البيانات لن تكون متناسقة.
- لن يؤثر تغيير اسم مجموعة التخصيص على البيانات المحفوظة في الخدمة.
- يجب أن يتم التخصيص بعد أن يكون للمنتج الكمية الموجبة المتاحة.
- لتخصيص منتجات من مجموعه مستوي *توزيع عاليه الجودة* إلى مجموعه فرعيه ، استخدم واجهه برمجه التطبيقات `Reallocate` الAPI. علي سبيل المثال، لديك التدرج الهرمي \[`channel`و `customerGroup`و `region`و `orderType`\]و الذي تريد تخصيص بعض المنتجات من مجموعه \[التوزيع عبر الإنترنت ، فب\] مجموعه \[التخصيص الفرعية عبر الإنترنت ، فب ، EU\] ، استخدم `Reallocate` الAPI لنقل الكمية. في حاله استخدام واجهه برمجه التطبيقات `Allocate` (API) ، سيتم تخصيص الكمية من الوعاء العام الظاهري.

### <a name="using-the-allocation-api"></a><a name="using-allocation-api"></a>استخدام واجهة برمجة تطبيقات التخصيص

حاليًا، تم فتح خمس واجهات برمجة تطبيقات للتخصيص:

- POST /api/environment/{environmentId}/allocation/allocate
- POST /api/environment/{environmentId}/allocation/unallocate
- POST /api/environment/{environmentId}/allocation/reallocate
- POST /api/environment/{environmentId}/allocation/consume
- POST /api/environment/{environmentId}/allocation/query

#### <a name="allocate"></a>توزيع

قم باستدعاء واجهة برمجة تطبيقات `Allocate` لتخصيص منتج له أبعاد معينة. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "targetGroups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

على سبيل المثال، تريد تخصيص كمية 10 لمنتج *الدراجة*، والموقع *1*، والمكان *11*، واللون *أحمر*، و *على الإنترنت*، ومجموعة عملاء *كبار الشخصيات*، والمنطقة *الولايات المتحدة*. للقيام بهذا التخصيص، يمكنك إجراء مكالمة تحتوي على محتوى النص التالي.

```json
{
    "id": "???",
    "productId": "Bike",
    "targetGroups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 10,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

يجب أن تكون الكمية دائمًا أكبر من 0 (صفر).

#### <a name="unallocate"></a>إلغاء تخصيص

استخدم واجهة برمجة تطبيقات `Unallocate` لإلغاء عملية `Allocate`. غير مسموح بالكمية السالبة في عملية `Allocate`. نص `Unallocate` مطابق لنص `Allocate`.

#### <a name="reallocate"></a>إعادة تخصيص

استخدم واجهة برمجة تطبيقات `Reallocate` لنقل بعض الكمية المخصصة إلى تركيبة مجموعات أخرى. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "sourceGroups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "targetGroups": {
        "groupD": "string",
        "groupE": "string",
        "groupF": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    }
}
```

على سبيل المثال، يمكنك نقل دراجتين لهما الأبعاد \[الموقع=1، المكان=11, اللون=أحمر\] من مجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الولايات المتحدة\] إلى مجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الاتحاد الأوروبي\] عن طريق استدعاء واجهة برمجة تطبيقات `Reallocate` وتوفير النص الأساسي التالي.

```json
{
    "id": "???",
    "productId": "Bike",
    "sourceGroups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
    "targetGroups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "EU"
    },
    "quantity": 2,
    "organizationId": "usmf",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    }
}
```

#### <a name="consume"></a>الاستهلاك

استخدم واجهة برمجة تطبيقات `Consume` لترحيل كمية الاستهلاك مقابل التخصيص. على سبيل المثال، يمكنك استخدام واجهة برمجة التطبيقات هذه لنقل الكمية المخصصة إلى بعض المقاييس الحقيقية. هنا مخطط نص الطلب.

```json
{
    "id": "string",
    "productId": "string",
    "dimensionDataSource": "string",
    "targetGroups": {
        "groupA": "string",
        "groupB": "string",
        "groupC": "string"
    },
    "quantity": 0,
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "physicalMeasures": {
        "datasource1": {
            "measure": "string" // Addition or Subtraction
        }
    }
}
```

على سبيل المثال، هناك ثماني دراجات مخصصة لها أبعاد \[الموقع=1, المكان=11، اللون=أحمر\] لمجموعة التخصيص \[على الإنترنت، كبار الشخصيات، الولايات المتحدة\]. يتم استخدام الصيغة التالية المتاحة للتخصيص:

`@iv.@available_to_allocate` = `fno.onordered` + `pos.inbound` – `@iv.@allocated`

يتم تخصيص الدراجات الثماني من مقياس `pos.inbound`.

الآن، تم بيع ثلاث دراجات، وتم أخذها من مجموعة التخصيص. لتسجيل هذه الخطوة، يمكنك إجراء مكالمة تحتوي على نص الطلب التالي.

```json
{
    "id": "???",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "targetGroups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "pos": {
            "inbound": "Subtraction"
        }
    }
}
```

بعد هذا الاستدعاء، سيتم تقليل الكمية المخصصة للمنتج بمقدار 3. بالإضافة إلى ذلك، ستنشئ رؤية المخزون حدث تغيير متاح حيث `pos.inbound` = *-3*. بدلاً من ذلك، يمكنك الاحتفاظ بقيمة `pos.inbound` كما هي واستهلاك الكمية المخصصة فقط. ومع ذلك، في هذه الحالة، يجب عليك إما إنشاء مقياس مادي آخر للاحتفاظ بالكميات المستهلكة أو استخدام المقياس المحدد مسبقًا `@iv.@consumed`.

في هذا الطلب، لاحظ أن المقياس المادي الذي تستخدمه في نص طلب الاستهلاك يجب أن يستخدم نوع المعدل المعاكس (الجمع أو الطرح)، مقارنة بنوع المعدل المستخدم في القياس المحسوب. لذلك في نص الاستهلاك هذا، يحتوي `iv.inbound` على قيمة `Subtraction`، وليس `Addition`.

لا يمكن استخدام مصدر بيانات `fno` في نص الاستهلاك كما زعمنا دائمًا أن رؤية المخزون لا يمكنها تغيير أي بيانات لمصدر بيانات `fno`. يكون تدفق البيانات باتجاه واحد، مما يعني أنه يجب الحصول على كافة تغييرات الكمية لمصدر البيانات `fno` من بيئة Supply Chain Management.

#### <a name="consume-as-a-soft-reservation"></a><a name="consume-to-soft-reserved"></a>الاستهلاك كحجز برمجي

يمكن لواجهة برمجة تطبيقات `Consume` أيضًا أن تستهلك الكمية المخصصة كحجز برمجي. في هذه الحالة، ستعمل عملية `Consume` على تقليل الكمية المخصصة ثم إجراء حجز برمجي لتلك الكمية. لاستخدام هذا الأسلوب، يجب أن تستخدم أيضًا ميزة [الحجز البرمجي](inventory-visibility-reservations.md) لرؤية المخزون.

على سبيل المثال، لقد قمت بتعيين مُعدِّل حجز برمجي (قياس) كـ `iv.softreserved`. تُستخدم الصيغة التالية للمقياس المحسوب المتاح للاحتياطي:

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved`

لاستخدام هذا الإعداد مع ميزة التخصيص، أضف `@iv.@allocated` إلى `iv.available_to_reserve` لإنتاج الصيغة التالية:

`iv.available_to_reserve` = `fno.onordered` + `pos.inbound` – `iv.softreserved` – `@iv.@allocated`

وبعد ذلك، قم بتحديث `@iv.@available_to_allocate` إلى القيمة نفسها.

عندما تريد استهلاك كمية 3 والاحتفاظ بهذه الكمية مباشرة، يمكنك إجراء مكالمة تحتوي على نص الطلب التالي.

```json
{
    "id": "???",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "targetGroups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
    "quantity": 3,
    "physicalMeasures": {
        "iv": {
            "softreserved": "Addition"
        }
    }
}
```

في هذا الطلب، لاحظ أن `iv.softreserved` يحتوي على القيمة `Addition`، وليس `Subtraction`.

#### <a name="query"></a>استعلام

استخدم واجهة برمجة تطبيقات `Query` لاسترداد المعلومات المتعلقة بالتخصيص لبعض المنتجات. يمكنك استخدام عوامل تصفية الأبعاد وعوامل تصفية مجموعة التخصيص لتضييق نطاق النتائج. يجب أن تتطابق الأبعاد تمامًا مع الأبعاد التي تريد استردادها، على سبيل المثال، سيحتوي \[الموقع=1, المكان=11\] على النتائج غير ذات الصلة مقارنةً بـ \[الموقع=1، المكان=11, اللون=أحمر\].

```json
{
    "productId": "string",
    "organizationId": "string",
    "dimensions": {
        "dimension1": "string",
        "dimension2": "string",
        "dimension3": "string"
    },
    "groups": {
        "additionalProp1": "string",
        "additionalProp2": "string",
        "additionalProp3": "string"
    },
}
```

على سبيل المثال، استخدم \[الموقع=1، المكان=11، اللون=أحمر\] ومجموعات فارغة للحصول على جميع سجلات التخصيص:

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```

استخدم \[الموقع=1، المكان=11, اللون=أحمر\] والمجموعات \[القناة=على الإنترنت, مجموعة العملاء=كبار الشخصيات، المنطقة=الولايات المتحدة\] للحصول على سجلات التخصيص لهذه المجموعة:

```json
{
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "siteId": "1",
        "locationId": "11",
        "colorId": "red"
    },
    "groups": {
        "channel": "Online",
        "customerGroup": "VIP",
        "region": "US"
    },
}
```
