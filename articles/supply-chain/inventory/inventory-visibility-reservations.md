---
title: حجوزات رؤية المخزون
description: يصف هذا الموضوع كيفية إعداد ميزة الحجز لإنشاء عمليات حجز، واستهلاك الحجوزات، و/أو كميات المخزون المحددة غير المفرج عنها باستخدام "رؤية المخزون".
author: yufeihuang
ms.date: 08/02/2021
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: yufeihuang
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 6c87018cbfbe22fbbc441a1a23aee0ac44af9ddc
ms.sourcegitcommit: b9c2798aa994e1526d1c50726f807e6335885e1a
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 08/13/2021
ms.locfileid: "7345139"
---
# <a name="inventory-visibility-reservations"></a>حجوزات رؤية المخزون

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]
[!INCLUDE [cc-data-platform-banner](../../includes/cc-data-platform-banner.md)]

يصف هذا الموضوع كيفية إعداد ميزة الحجز لإنشاء عمليات حجز، واستهلاك الحجوزات، و/أو كميات المخزون المحددة غير المفرج عنها باستخدام "رؤية المخزون".

تحدد الحجوزات كمية المخزون التي سيتم استخدامها في المستقبل. عند إنشاء حجز، يمنع النظام الطلبات الأخرى من حجز أو استهلاك البضائع المحجوزة حتى يتم استهلاك الحجز أو دون تحفظ. يتم إنشاء الحجوزات واستهلاكها وإلغاءها باستخدام استدعاءات API لخدمة "رؤية المخزون".

يمكنك اختياريا إعداد Microsoft Dynamics 365 Supply Chain Management (وأنظمة أخرى تابعة لجهة خارجية) لتعويض الكمية المحجوزة تلقائيا باستخدام "رؤية المخزون". يتم حذف كمية الإزاحة من سجلات الحجز في "رؤية المخزون".

عند تشغيل ميزة الحجز، تصبح Supply Chain Management جاهزة تلقائيًا لتعويض الحجوزات التي تم إجراؤها باستخدام رؤية المخزون.

> [!NOTE]
> تتطلب وظيفة الإزاحة الإصدار 10.0.22 من Supply Chain Management أو إصدار أحدث. إذا كنت تريد استخدام حجوزات رؤية المخزون، نوصيك بالانتظار حتى ترقية Supply Chain Management إلى الإصدار 10.0.22 أو إصدار أحدث.

## <a name="turn-on-the-reservation-feature"></a>تشغيل ميزة الحجز

لتشغيل ميزة الحجز، اتبع الخطوات التالية.

1. في Power Apps، افتح **رؤية المخزون**.
1. افتح صفحة **التكوين**.
1. في علامة التبويب **إدارة الميزات**، قم بتشغيل ميزة *OnHandReservation*.
1. سجل دخولك إلى Supply Chain Management.
1. انتقل إلى **إدارة المخزون \> إعداد \> معلمات تكامل رؤية المخزون**.
1. ضمن **إزاحة الحجز**، قم بتعيين الخيار **تمكين إزاحة الحجز** إلى *نعم*.

## <a name="use-the-reservation-feature-in-inventory-visibility"></a>استخدام ميزة الحجز في رؤية المخزون

عند استدعاء API الحجز، النظام علامات حجز السلع والكميات المحددة. يجب تحديد التسلسل الهرمي للحجز ونشر الطلبات التي تطابق هذا التسلسل الهرمي للحجز. يمكن بعد ذلك إجراء الحجوزات عن طريق الاتصال بواجهات برمجة تطبيقات الحجز مباشرة.

### <a name="configure-the-reservation-hierarchy"></a>تكوين التدرج الهرمي للحجز

يصف التسلسل الهرمي للحجز تسلسل الأبعاد التي يجب تحديدها عند إجراء الحجوزات. يعمل بنفس الطريقة التي يعمل بها التسلسل الهرمي الفهرس للاستعلامات الموجودة.

يمكن أن يختلف التسلسل الهرمي للحجز عن التسلسل الهرمي للفهرس. يتيح لك هذا الاستقلال تنفيذ إدارة الفئات حيث يمكن للمستخدمين تقسيم الأبعاد إلى تفاصيل لتحديد متطلبات إجراء حجوزات أكثر دقة.

لتكوين تدرج هرمي للحجز في Power Apps، افتح صفحة **التكوين**، ثم قم، في علامة التبويب **تعيين الحجز المرن**، وقم بإعداد التسلسل الهرمي للحجز عن طريق إضافة و/أو تعديل الأبعاد ومستويات التسلسل الهرمي الخاصة بها.

### <a name="call-the-reservation-api"></a>استدعاء API للحجز

يتم إجراء الحجوزات في خدمة رؤية المخزون عن طريق إرسال طلب POST إلى عنوان URL الخاص بالخدمة، مثل `/api/environment/{environment-ID}/onhand/reserve`.

بالنسبة للحجز، يجب أن يحتوي نص الطلب على معرف المؤسسة، معرف المنتج، الكميات المحجوزة والأبعاد. يقوم الطلب بإنشاء معرف حجز فريد لكل سجل حجز. يحتوي سجل الحجز على تركيبة فريدة من معرف المنتج وأبعاده.

هنا مثال على نص الطلب، للرجوع إليها.

```json
# Url
# replace {RegionShortName} and {EnvironmentId} with your value
https://inventoryservice.{RegionShortName}-il301.gateway.prod.island.powerapps.com/api/environment/{EnvironmentId}/onhand/reserve

# Method
Post

# Header
# replace {access_token} with the one get from security service
Api-version: "1.0"
Content-Type: "application/json"
Authorization: "Bearer {access_token}"

# Body
{
    "id": "id-bike-0001",
    "organizationId": "usmf",
    "productId": "Bike",
    "dimensions": {
        "SiteId": "1",
        "LocationId": "11",
        "ColorId": "Red",
        "SizeId": "small"
    },
    "quantityDataSource": "iv",
    "modifier": "SoftReservOrdered",
    "quantity": 1,
    "ifCheckAvailForReserv": true
}
```

## <a name="offset-reservations-in-supply-chain-management"></a>إزاحة الحجوزات في Supply Chain Management

بالنسبة لحالات حركات المخزون التي تتضمن معدل إزاحة حجز محدد، سيقوم تحديث الحركة بمعادلة سجل الحجز المقابل عند استيفاء كافة الشروط التالية:

- يتطابق معرف الحجز في حركة المخزون مع معرف الحجز لسجل الحجز في خدمة "رؤية المخزون".
- تتطابق أبعاد حركة المخزون مع أبعاد سجل الحجز في خدمة رؤية المخزون.
- تؤدي التغييرات في حالة حركة المخزون إلى عمليات إزاحة للحجوزات عندما تعكس حالة حركة المخزون حقيقة أن عملية الأمر قد اكتملت أو تم تخطيها.

تتبع كمية الإزاحة كمية المخزون المحددة في حركات المخزون. لا يسري الإزاحة إذا لم تبقى كمية محجوزة في خدمة "رؤية المخزون".

> [!NOTE]
> تتوفر وظيفة الإزاحة اعتبارا من الإصدار 10.0.22

### <a name="set-up-the-reserve-offset-modifier"></a>إعداد معدل إزاحة الحجز

يحدد معدل إزاحة الحجز مرحلة معالجة الأمر التي تقوم بتشغيل الإزاحات. يتم تتبع المرحلة حسب حالة حركة المخزون الخاصة بالأمر. لإعداد معدل إزاحة الحجز، اتبع هذه الخطوات.

1. انتقل إلى **إدارة المخزون \> إعداد \> معلمات تكامل رؤية المخزون \> إزاحة الحجز**.
1. قم بتعيين حقل **معدل إزاحة الحجز** إلى إحدى القيم التالية:

    - *في أمر* – بالنسبة لحالة *في الحركة*، سيقوم أمر بإرسال طلب إزاحة عند إنشائه.
    - *الحجز* – بالنسبة لحالة *الحركة المطلوبة للحجز*، سيقوم أمر بإرسال طلب تعويض عند حجزه أو انتقاؤها أو ترحيل كشف التعبئة أو فوترتها. سيتم تشغيل الطلب مرة واحدة فقط، للخطوة الأولى عند حدوث العملية المذكورة.

### <a name="set-up-reservation-ids"></a>إعداد معرفات الحجز

معرف الحجز بشكل فريد علامات سجل حجز في "رؤية المخزون". في Supply Chain Management، يضع المستخدمون حجوزات على سطور الأمر لتمييز الإزاحة لسجل الحجز المقابل.

لإعداد معرفات الحجز في Supply Chain Management، اتبع هذه الخطوات.

1. افتح أمر مبيعات (على سبيل المثال، من صفحة **جميع أوامر المبيعات**).
1. في علامة التبويب السريعة **بنود أمر المبيعات**، حدد بند أمر.
1. في علامة التبويب السريعة **بنود أمر المبيعات**، على شريط الأدوات، حدد **تحديث بند \> المخزون \> تكامل رؤية المخزون**.
1. أدخل معرفات الحجز ذات الصلة.

يتطابق تغيير حالة المخزون مع إعداد معدل الإزاحة.
