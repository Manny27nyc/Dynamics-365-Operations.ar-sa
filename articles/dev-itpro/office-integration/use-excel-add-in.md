---
title: "استخدام الوظيفة الإضافية لبرنامج Excel"
description: "يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel، ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics Office لبرنامج Excel."
author: ChrisGarty
manager: AnnBe
ms.date: 11/30/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, Operations
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: a0739304723d19b910388893d08e8c36a1f49d13
ms.openlocfilehash: f3ed06dbbce21ac093107953d3a72d8ab086af2a
ms.contentlocale: ar-sa
ms.lasthandoff: 03/26/2018

---

# <a name="use-the-excel-add-in"></a>استخدام الوظيفة الإضافية لبرنامج Excel

[!include[banner](../includes/banner.md)]

يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel، ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics Office لبرنامج Excel. لفتح بيانات الكيان، يمكنك البدء من Excel أو من Microsoft Dynamics 365 for Finance and Operations.

من خلال فتح بيانات الكيان في Excel، يمكنك أن تقوم بسرعة وسهولة بعرض وتحرير البيانات باستخدام وظيفة Excel الإضافية. هذه الوظيفة الإضافية تتطلب Microsoft Excel 2016.

> [!NOTE]
> إذا تم تكوين مستأجر Microsoft Azure Active Directory ‏(Azure AD) لاستخدام خدمات الأمان المشترك لـ Active Directory‬ (أو AD FS)، فيجب التأكد من تطبيق تحديث مايو 2016 لـ Office، لتمكين وظيفة Excel الإضافية من تسجيل دخولك بشكل صحيح.

## <a name="open-entity-data-in-excel-when-you-start-from-finance-and-operations"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من Finance and Operations
1. على صفحة في Finance and Operations، حدد **فتح في Microsoft Office**.

    إذا كان مصدر البيانات الجذر (الجدول) للصفحة هو نفسه مصدر البيانات الجذر لأي كيانات، فسيتم إنشاء خيارات **فتح في Excel** الافتراضية للصفحة. يمكن العثور على خيارات **فتح في Excel** على الصفحات المستخدمة بشكل متكرر، مثل **كافة الموردين** و**كافة العملاء**.
 
2. حدد أحد خيارات **فتح في Excel**، وافتح المصنف الذي يتم إنشاؤه. يحتوي هذا المصنف على معلومات ربط للكيان ومؤشر إلى بيئتك ومؤشر إلى وظيفة Excel الإضافية.
3. في Excel، حدد **تمكين التحرير** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4. إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية**.
5. في حالة مطالبتك بتسجيل الدخول، حدد **تسجيل الدخول**، وبعد ذلك سجّل الدخول باستخدام نفس بيانات الاعتماد التي استخدمتها لتسجيل الدخول إلى Finance and Operations. سوف تستخدم وظيفة Excel الإضافية سياق تسجيل الدخول السابق من Internet Explorer وتسجّل دخولك تلقائيًا إليها، إذا أمكنها ذلك. لذلك، تحقق من اسم المستخدم الموجود في الزاوية اليسرى العليا من وظيفة Excel الإضافية.

تقرأ وظيفة Excel الإضافية بشكل تلقائي البيانات للكيان الذي قمت بتحديده. لاحظ أن المصنف لن يتضمن أي بيانات إلى أن تقوم وظيفة Excel الإضافية بقراءتها فيه.

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من Excel
1. في Excel، على علامة التبويب **إدراج**، في مجموعة **الوظائف الإضافية**، حدد **متجر** لفتح متجر Office.
2. في متجر Office، ابحث عن الكلمة الأساسية **Dynamics‎**، وانقر فوق **إضافة** إلى جانب **وظيفة Microsoft Dynamics Office الإضافية** (وظيفة Excel الإضافية).
3. إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فحدد **الثقة بهذه الوظيفة الإضافية** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4. حدد **إضافة معلومات الخادم** لفتح الجزء **خيارات**.
5. في المستعرض، انسخ عنوان URL لمثيل Finance and Operations الهدف، والصقه في حقل **URL‏‎ الخادم**، ثم احذف كل شيء بعد اسم المضيف. يجب أن يتضمن عنوان URL الناتج فقط اسم المضيف.

    على سبيل المثال، إذا كان عنوان URL `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`، فاحذف كل شيء باستثناء `https://xxx.dynamics.com`.

6. حدد **موافق**، ثم حدد **نعم** لتأكيد التغيير. يبدأ تشغيل وظيفة Excel الإضافية من جديد وتقوم بتحميل بيانات التعريف.

    يتوفر الآن الزر **تصميم**. إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬**، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لمزيد من المعلومات، راجع "ظهور زر تحميل البرامج" في قسم [استكشاف الأخطاء وإصلاحها](https://docs.microsoft.com/en-us/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) في هذا الموضوع.

7. حدد **تصميم**. تقوم وظيفة Excel الإضافية باسترداد بيانات تعريف الكيان.
8. حدد **إضافة جدول**. تظهر قائمة بالكيانات. تكون الكيانات مدرجة بصيغة "الاسم - التسمية".
9. حدد كيانًا في القائمة، مثل **العميل-العملاء**، ثم حدد **التالي**.
10. لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**. بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.
11. بعد أن تنتهي من إضافة الحقول المطلوبة إلى قائمة **الحقول المحددة**، تأكد من وجود المؤشر في المكان الصحيح في ورقة العمل (على سبيل المثال، الخلية A1)، ثم حدد **تم**. بعد ذلك، حدد **تم** لإغلاق المصمم.
12. حدد **تحديث** لسحب مجموعة من البيانات.

## <a name="view-and-update-entity-data-in-excel"></a>عرض بيانات الكيان وتحديثها في Excel
بعد أن تقوم وظيفة Excel الإضافية بقراءة بيانات الكيان في المصنف، يمكنك تحديث البيانات في أي وقت بتحديد **تحديث** في وظيفة Excel الإضافية.

## <a name="edit-entity-data-in-excel"></a>تحرير بيانات الكيان في Excel
يمكنك تغيير بيانات الكيان وفق احتياجاتك، ثم إعادة نشرها بتحديد **نشر** في وظيفة Excel الإضافية. لتحرير سجل، حدد خلية في ورقة العمل ثم قم بتغيير قيمة الخلية. لإضافة سجل جديد، اتبع إحدى الخطوات التالية:

- انقر في أي مكان في جدول مصادر البيانات، ثم حدد **جديد** في وظيفة Excel الإضافية.
- انقر بأي مكان في الصف الأخير من جدول مصادر البيانات، ثم اضغط المفتاح Tab حتى خروج المؤشر من العمود الأخير لذلك الصف وإنشاء صف جديد.
- انقر بأي مكان في الصف مباشرة أسفل جدول مصادر البيانات، وابدأ إدخال بيانات في خلية. عند نقل التركيز من هذه الخلية، يتوسع الجدول لتضمين الصف الجديد.
- فيما يتعلق بروابط الحقول لسجلات الرأس، حدد أحد الحقول، ثم حدد **جديد** في وظيفة Excel الإضافية.

لاحظ أنه يمكن إنشاء سجل جديد فقط إذا كانت كافة الحقول الأساسية والإلزامي مرتبطة في ورقة العمل، أو إذا تم إدخال القيم الافتراضية باستخدام شرط عامل التصفية.

لحذف سجل، اتبع إحدى الخطوات التالية:

- انقر بزر الماوس الأيمن فوق رقم الصف الموجود بجانب صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف**.
- انقر بزر الماوس الأيمن في أي مكان في صف ورقة العمل الذي تريد حذفه، ثم حدد **حذف** &gt; **صفوف الجدول**.

إذا تمت إضافة مصادر البيانات على أنها مصادر بيانات مرتبطة، فسيتم نشر الرأس قبل البنود. في حال وجود تبعيات بين مصادر بيانات الأخرى، قد تحتاج إلى تغيير أمر النشر الافتراضي. ‏‫لتغيير أمر النشر، في وظيفة Excel الإضافية، حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة **موصل البيانات**، حدد **تكوين أمر نشر‬**.

## <a name="add-or-remove-columns"></a>إضافة الأعمدة أو إزالتها
يمكنك استخدام المصمم لضبط الأعمدة التي تُضاف تلقائيًا إلى ورقة العمل.

> [!NOTE]
> إذا كان زر **التصميم** لا يظهر أسفل زر **عامل التصفية** في وظيفة Excel الإضافية، يجب تمكين مصمم مصدر البيانات. حدد الزر **خيارات** (رمز الترس)، ثم حدد خانة الاختيار **تمكين التصميم**.

1. في وظيفة Excel الإضافية، حدد **تصميم**. يتم سرد كافة مصادر البيانات.
2. إلى جانب مصدر البيانات، حدد الزر **تحرير** (رمز القلم).
3. في قائمة **الحقول المحددة**، اضبط قائمة الحقول وفق احتياجاتك:

    - لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إضافة**. بدلاً من ذلك، انقر نقراً مزدوجاً فوق الحقل في القائمة **الحقول المتوفرة**.
    - لإزالة حقل من قائمة **الحقول المحددة**، حدد الحقل، ثم حدد **إزالة**. أو انقر نقرًا مزدوجًا فوق الحقل.
    - لتغيير ترتيب الحقول في قائمة **الحقول المحددة**، حدد حقل، ثم حدد **أعلى** أو **أسفل**.

4. لتطبيق التغييرات على مصدر البيانات، حدد **تحديث**. بعد ذلك، حدد **تم** لإغلاق المصمم.
5. إذا قمت بإضافة حقل (عمود)، فحدد **تحديث** لسحب مجموعة محدّثة من البيانات.

## <a name="copy-environment-data"></a>نسخ بيانات البيئة

يمكن نسخ البيانات التي تتم قراءتها في المصنف من بيئة إلى بيئة أخرى. مع ذلك، لا يمكنك تغيير عنوان URL الاتصال فحسب، نظرًا لأن ذاكرة التخزين المؤقت للبيانات في المصنف ستستمر في التعامل مع البيانات كبيانات موجودة. بدلاً من ذلك، يجب استخدام وظيفة نسخ بيانات البيئة‬ لنشر البيانات إلى بيئة جديدة كبيانات جديدة.

1. حدد الزر **خيارات** (رمز الترس)، وبعد ذلك، في علامة التبويب السريعة‬ **‏‫موصل البيانات‬**، حدد **نسخ بيانات البيئة‬**. 
2. أدخل عنوان URL للخادم لبيئة جديدة. 
3. حدد **موافق**، ثم حدد **نعم** لتأكيد الإجراء. ‏‫يبدأ تشغيل وظيفة Excel الإضافية من جديد وتتصل بالبيئة الجديدة. يتم التعامل مع أية بيانات موجودة في المصنف كبيانات جديدة.

    بعد إعادة تشغيل وظيفة Excel الإضافية، يظهر مربع رسالة يفيد بأن المصنف موجود في وضع نسخة البيئة.

4. لنسخ البيانات إلى البيئة الجديدة كبيانات جديدة، حدد **نشر**. لإلغاء عملية نسخ البيئة ومراجعة البيانات الموجودة في البيئة الجديدة، حدد **تحديث**.

## <a name="troubleshooting"></a>استكشاف الأخطاء وإصلاحها
هناك بعض المشاكل التي يمكن حلها من خلال بعض الخطوات السهلة.

- **‬‏‫ظهور زر تحميل البرامج** - إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬** بعد تسجيل الدخول، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.
- **‬‏‫تلقيت رسالة "ممنوع"** – إذا تلقيت رسالة "ممنوع" أثناء قيام وظيفة Excel الإضافية بتحميل بيانات التعريف، فهذا يعني أن الحساب الذي سجل دخوله إلى وظيفة Excel الإضافية لا يملك الأذونات الكافية لاستخدام الخدمة أو المثيل أو قاعدة البيانات المستهدفة. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فحدده، وسجّل خروجك، ثم سجّل دخولك مرة أخرى.
- **‬‏‫ظهور صفحة ويب فارغة على Excel** – إذا تم فتح صفحة ويب فارغة أثناء عملية تسجيل الدخول، فهذا يعني أن الحساب يحتاج إلى AD FS، ولكن إصدار وظيفة Excel الإضافية الذي يقوم بتشغيل الوظيفة الإضافية ليس حديثًا بشكل كافٍ لكي يتمكن من تحميل مربع حوار تسجيل الدخول. لحل هذه المشكلة، قم بتحديث إصدار Excel الذي تستخدمه. لتحديث إصدار Excel عندما تكون في مؤسسة موجودة على القناة المؤجلة، استخدم [أداة نشر Office](https://technet.microsoft.com/library/jj219422.aspx) من أجل [الانتقال من القناة المؤجلة إلى القناة الحالية](https://technet.microsoft.com/library/mt455210.aspx).

