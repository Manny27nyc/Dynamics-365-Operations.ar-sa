---
title: "استخدام الوظيفة الإضافية لبرنامج Excel"
description: "يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel، ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics Office لبرنامج Excel."
author: ChrisGarty
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: sericks
ms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: cgarty
ms.search.validFrom: 2016-02-28T00:00:00.000Z
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 08c38aada355583c5a6872f75b57db95d9b81786
ms.openlocfilehash: 06fc9f8dda83fddea9ae331bb82c8874b15d76b9
ms.contentlocale: ar-sa
ms.lasthandoff: 07/27/2017

---

# <a name="use-the-excel-add-in"></a>استخدام الوظيفة الإضافية لبرنامج Excel

[!include[banner](../includes/banner.md)]


يشرح هذا الموضوع كيفية فتح بيانات الكيان في Microsoft Excel، ثم عرض وتحديث وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics Office لبرنامج Excel. لفتح بيانات الكيان، يمكنك البدء من Excel أو من Microsoft Dynamics 365 for Finance and Operations, Enterprise edition.

من خلال فتح بيانات الكيان في Microsoft Excel، يمكنك أن تقوم بسرعة وسهولة بعرض وتحرير البيانات باستخدام الوظيفة الإضافية Microsoft Dynamics Office لبرنامج Excel. هذه الوظيفة الإضافية تتطلب Microsoft Excel 2016. **ملاحظة:** إذا تم تكوين مستأجر Microsoft Azure Active Directory (Azure AD) لاستخدام خدمات الأمان المشترك لـ Active Directory‬ (أو AD FS)، فيجب التأكد من تطبيق تحديث مايو 2016، لتمكين وظيفة Excel الإضافية من تسجيل دخولك بشكل صحيح.

## <a name="open-entity-data-in-excel-when-you-start-from-dynamics-365-for-finance-and-operations"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من Dynamics 365 for Finance and Operations
1.  على صفحة في Microsoft Dynamics 365 for Finance and Operations، انقر فوق **فتح في Microsoft Office**. إذا كان مصدر البيانات الجذر (الجدول) للصفحة هو نفسه مصدر البيانات الجذر لأي كيانات، فسيتم إنشاء خيارات **فتح في Excel** الافتراضية للصفحة. يمكن العثور على خيارات **فتح في Excel** على الصفحات المستخدمة بشكل متكرر، مثل **كافة الموردين** و**كافة العملاء**.
2.  انقر فوق أحد خيارات **فتح في Excel**، وافتح المصنف الذي يتم إنشاؤه. يحتوي هذا المصنف على معلومات ربط للكيان ومؤشر إلى بيئتك ومؤشر إلى وظيفة Excel الإضافية.
3.  في Excel، انقر فوق **تمكين التحرير** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4.  إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فانقر فوق **الثقة بهذه الوظيفة الإضافية**.
5.  في حالة مطالبتك بتسجيل الدخول، انقر فوق **تسجيل الدخول**، وبعد ذلك سجّل الدخول باستخدام نفس بيانات الاعتماد التي استخدمتها لتسجيل الدخول إلى Dynamics 365 for Finance and Operations. سوف تستخدم وظيفة Excel الإضافية سياق تسجيل الدخول السابق من Internet Explorer وتسجّل دخولك تلقائيًا إليها، إذا أمكنها ذلك. لذلك، تحقق من اسم المستخدم الموجود في الزاوية اليسرى العليا من وظيفة Excel الإضافية.

تقرأ وظيفة Excel الإضافية بشكل تلقائي البيانات للكيان الذي قمت بتحديده. لاحظ أن المصنف لن يتضمن أي بيانات إلى أن تقوم وظيفة Excel الإضافية بقراءتها فيه.

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a>فتح بيانات الكيان في Excel عند بدء التشغيل من Excel
1.  في Excel، على علامة التبويب **إدراج**، في مجموعة **الوظائف الإضافية**، انقر فوق **متجر** لفتح متجر Office.
2.  في متجر Office، ابحث عن الكلمة الأساسية "Dynamics"، وانقر فوق **إضافة** إلى جانب **الوظيفة الإضافية Microsoft Dynamics Office** (وظيفة Excel الإضافية).
3.  إذا كنت تقوم بتشغيل وظيفة Excel الإضافية للمرة الأولى، فانقر فوق **الثقة بهذه الوظيفة الإضافية** لتمكين تشغيل وظيفة Excel الإضافية. يتم تشغيل وظيفة Excel الإضافية في جزء يقع على الجانب الأيسر من نافذة Excel.
4.  انقر فوق **إضافة معلومات الخادم** لفتح الجزء **خيارات**.
5.  انسخ عنوان URL للمستعرض من مثيل Dynamics 365 for Finance and Operations الهدف، والصقه في حقل **URL‏‎ الخادم**، ثم احذف كل شيء بعد اسم المضيف. يجب أن يتضمن عنوان URL الناتج فقط اسم المضيف.
على سبيل المثال، إذا كان عنوان URL على الشكل https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage، فاحذف كل شيء باستثناء **https://xxx.dynamics.com**.
6.  انقر فوق **موافق**، ثم انقر فوق **نعم** لتأكيد التغيير. يبدأ تشغيل وظيفة Excel الإضافية من جديد وتقوم بتحميل بيانات التعريف. يتوفر الآن الزر **تصميم**. إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬**، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لمزيد من المعلومات، راجع "ظهور زر تحميل البرامج" في قسم "استكشاف الأخطاء وإصلاحها" في هذا الموضوع.
7.  انقر فوق **تصميم**. تقوم وظيفة Excel الإضافية باسترداد بيانات تعريف الكيان.
8.  انقر فوق **إضافة جدول**. تظهر قائمة بالكيانات. تكون الكيانات مدرجة بصيغة "الاسم - التسمية".
9.  حدد كيانًا في القائمة، مثل **العميل-العملاء**، ثم انقر فوق **التالي**.
10. لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، انقر فوق الحقل، ثم انقر فوق **إضافة**. أو انقر نقرًا مزدوجًا فوق الحقل.
11. بعد أن تنتهي من إضافة الحقول المطلوبة إلى قائمة **الحقول المحددة**، تأكد من وجود المؤشر في المكان الصحيح في ورقة العمل (على سبيل المثال، الخلية A1)، ثم انقر فوق **تم**. بعد ذلك، انقر فوق **تم** لإغلاق المصمم.
12. انقر فوق **تحديث** لسحب مجموعة من البيانات.

## <a name="view-and-update-entity-data-in-excel"></a>عرض بيانات الكيان وتحديثها في Excel
بعد أن تقوم وظيفة Excel الإضافية بقراءة بيانات الكيان في المصنف، يمكنك تحديث البيانات في أي وقت بالنقر فوق **تحديث** في وظيفة Excel الإضافية.

## <a name="edit-entity-data-in-excel"></a>تحرير بيانات الكيان في Excel
يمكنك تغيير بيانات الكيان وفق احتياجاتك، ثم إعادة نشرها بالنقر فوق **نشر** في وظيفة Excel الإضافية. لتحرير سجل، حدد خلية في ورقة العمل ثم قم بتغيير قيمة الخلية. لإضافة سجل جديد، اتبع إحدى الخطوات التالية:

-   انقر في أي مكان في جدول مصادر البيانات، ومن ثم انقر فوق **جديد** في وظيفة Excel الإضافية.
-   انقر في الصف الأخير من جدول مصادر البيانات، ثم اضغط المفتاح Tab حتى خروج المؤشر من العمود الأخير لذلك الصف وإنشاء صف جديد.
-   انقر في الصف مباشرة أسفل جدول مصادر البيانات، وابدأ إدخال بيانات في خلية. عند نقل التركيز من هذه الخلية، يتوسع الجدول لتضمين الصف الجديد.
-   فيما يتعلق بروابط الحقول لسجلات الرأس، انقر فوق أحد الحقول، ثم انقر فوق **جديد** في وظيفة Excel الإضافية.

لاحظ أنه يمكن إنشاء سجل جديد فقط إذا كانت كافة الحقول الأساسية والإلزامي مرتبطة في ورقة العمل، أو إذا تم إدخال القيم الافتراضية باستخدام شرط عامل التصفية.
لحذف سجل، اتبع إحدى الخطوات التالية:

-   انقر بزر الماوس الأيمن فوق رقم الصف الموجود بجانب صف ورقة العمل الذي تريد حذفه، ثم انقر فوق **حذف**.
-   انقر بزر الماوس الأيمن في صف ورقة العمل الذي تريد حذفه، ثم انقر فوق **حذف** &gt; **صفوف الجدول**.
إذا تمت إضافة مصادر البيانات على أنها مرتبطة، فسيتم نشر الرأس قبل البنود. في حال وجود تبعيات بين مصادر بيانات الأخرى، قد تحتاج إلى تغيير أمر النشر الافتراضي. لتغيير أمر النشر، في وظيفة Excel الإضافية، انقر فوق الزر **خيارات** (رمز الترس). بعد ذلك، على علامة التبويب السريعة **"موصل البيانات"**، انقر فوق **تكوين أمر النشر**.

## <a name="add-or-remove-columns"></a>إضافة الأعمدة أو إزالتها
يمكنك استخدام المصمم لضبط الأعمدة التي تُضاف تلقائيًا إلى ورقة العمل.

1.  ابدأ تشغيل مصمم مصدر البيانات لوظيفة Excel الإضافية بالنقر فوق الزر **خيارات** (رمز الترس) ثم حدد خانة الاختيار **تمكين التصميم**.
2.  انقر فوق **تصميم** في وظيفة Excel الإضافية. يتم سرد كافة مصادر البيانات.
3.  إلى جانب مصدر البيانات، انقر فوق الزر **تحرير** (رمز القلم).
4.  اضبط القائمة في قائمة **الحقول المحددة** وفق احتياجاتك:
    -   لإضافة حقل من قائمة **الحقول المتوفرة** إلى قائمة **الحقول المحددة**، انقر فوق الحقل، ثم انقر فوق **إضافة**. أو انقر نقرًا مزدوجًا فوق الحقل.
    -   لإزالة حقل من قائمة **الحقول المحددة**، انقر فوق الحقل، ثم انقر فوق **إزالة**. أو انقر نقرًا مزدوجًا فوق الحقل.
    -   لتغيير ترتيب الحقول، انقر فوق الحقل الموجود في قائمة **الحقول المحددة**، وانقر فوق حقل، ثم فوق **أعلى** أو **أسفل**.

5. لتطبيق التغييرات على مصدر البيانات، انقر فوق **تحديث**. بعد ذلك، انقر فوق **تم** لإغلاق المصمم. 
6. إذا قمت بإضافة حقل (عمود)، فانقر فوق **تحديث** لسحب مجموعة محدّثة من البيانات.

## <a name="troubleshooting"></a>استكشاف الأخطاء وإصلاحها
هناك بعض المشاكل التي يمكن حلها من خلال بعض الخطوات السهلة.

-   **ظهور زر تحميل البرامج.** إذا تضمنت وظيفة Excel الإضافية الزر **تحميل البرامج‬** بعد تسجيل الدخول، فهذا يعني على الأرجح أنك لم تسجل دخولك كمستخدم صحيح. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فانقر فوقه وسجّل خروج وثم سجّل دخولك مرة أخرى.
-   **تلقيت رسالة "ممنوع".** إذا تلقيت رسالة "ممنوع" أثناء قيام وظيفة Excel الإضافية بتحميل بيانات التعريف، فهذا يعني أن الحساب الذي سجل دخوله إلى وظيفة Excel الإضافية لا يملك الأذونات الكافية لاستخدام الخدمة أو المثيل أو قاعدة البيانات المستهدفة. لحل هذه المشكلة، تحقق من ظهور اسم المستخدم الصحيح في الزاوية اليسرى العليا من وظيفة Excel الإضافية. إذا ظهر اسم مستخدم غير صحيح، فانقر فوقه وسجّل خروج وثم سجّل دخولك مرة أخرى.
-   **ظهور صفحة ويب فارغة على Excel.** إذا تم فتح صفحة ويب فارغة أثناء عملية تسجيل الدخول، فهذا يعني أن الحساب يحتاج إلى AD FS، ولكن إصدار وظيفة Excel الإضافية الذي يقوم بتشغيل الوظيفة الإضافية ليس حديثًا بشكل كافٍ لكي يتمكن من تحميل مربع حوار تسجيل الدخول. لحل هذه المشكلة، قم بتحديث إصدار Excel الذي تستخدمه. لتحديث إصدار Excel عندما تكون في مؤسسة موجودة على القناة المؤجلة، استخدم [أداة نشر Office](https://technet.microsoft.com/library/jj219422.aspx) من أجل [الانتقال من القناة المؤجلة إلى القناة الحالية](https://technet.microsoft.com/library/mt455210.aspx).





