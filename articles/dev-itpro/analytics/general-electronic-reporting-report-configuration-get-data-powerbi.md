---
title: "تكوين التقارير الإلكترونية لسحب البيانات إلى Power BI"
description: "يشرح هذا الموضوع كيفية استخدام تكوين التقارير الإلكترونية لترتيب نقل البيانات من مثيل Finance and Operations إلى خدمات Power BI. يستخدم هذا الموضوع، كمثال، حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي كبيانات عمل يجب نقلها. تستخدم الرسوم المرئية في Power BI هذه البيانات لحركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي لتقديم طريقة عرض لتحليل أنشطة الاستيراد/التصدير في الشركة على تقرير Power BI."
author: NickSelin
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.translationtype: HT
ms.sourcegitcommit: 2771a31b5a4d418a27de0ebe1945d1fed2d8d6d6
ms.openlocfilehash: 90749012c3eb4f3d1c275f0661f8cff43ec285a2
ms.contentlocale: ar-sa
ms.lasthandoff: 11/03/2017

---

# <a name="configure-electronic-reporting-to-pull-data-into-power-bi"></a>تكوين التقارير الإلكترونية لسحب البيانات إلى Power BI

[!include[banner](../includes/banner.md)]


يشرح هذا الموضوع كيفية استخدام تكوين التقارير الإلكترونية لترتيب نقل البيانات من مثيل Finance and Operations إلى خدمات Power BI. يستخدم هذا الموضوع، كمثال، حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي كبيانات عمل يجب نقلها. تستخدم الرسوم المرئية في Power BI هذه البيانات لحركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي لتقديم طريقة عرض لتحليل أنشطة الاستيراد/التصدير في الشركة على تقرير Power BI.

<a name="overview"></a>نظرة عامة
--------

إن Microsoft Power BI عبارة عن مجموعة من خدمات البرامج والتطبيقات والموصلات التي تعمل معًا لتحويل مصادر البيانات الخارجية إلى معلومات معمقة مترابطة وتفاعلية ذات تأثيرات مرئية رائعة. يتيح إعداد التقارير الإلكترونية لمستخدمي Microsoft Dynamics 365 for Finance and Operations تكوين مصادر البيانات وترتيب نقل البيانات من Dynamics 365 for Finance and Operations إلى Power BI بسهولة. ويتم نقل البيانات كملفات بتنسيق ورقة عمل OpenXML (ملف مصنف Microsoft Excel). يتم تخزين الملفات المنقولة على Microsoft SharePoint Server تم تكوينه لهذا الغرض. ويتم استخدام الملفات المخزنة في Power BI لإنشاء تقارير تتضمن رسومًا مرئية (جداول ورسوم بيانية وخرائط وهكذا). وتتم مشاركة تقارير Power BI مع مستخدمي Power BI، ويتم الوصول إليها في لوحات معلومات Power BI وفي صفحات Finance and Operations. يشرح هذا الموضوع المهام التالية:

-   تكوين Finance and Operations.
-   إعداد تكوين تنسيق التقارير الإلكترونية الحصول على بيانات من Finance and Operations.
-   تكوين بيئة التقارير الإلكترونية لنقل البيانات إلى Power BI.
-   استخدام البيانات المنقولة لإنشاء تقرير Power BI.
-   الوصول إلى تقرير Power BI في Finance and Operations.

## <a name="prerequisites"></a>المتطلبات الأساسية
لإكمال المثال في هذا الموضوع، يجب أن يكون لديك الوصول التالي:

-   الوصول إلى Finance and Operations لأحد الأدوار التالية:
    -   مطور إعداد التقارير الإلكتروني
    -   مستشار وظيفي لإعداد التقارير الإلكتروني
    -   مسؤول النظام
-   الوصول إلى SharePoint Server الذي تم تكوينه للاستخدام مع Finance and Operations
-   الوصول إلى إطار عمل Power BI

## <a name="configure-document-management-parameters"></a>تكوين معلمات إدارة المستندات‬
1.  في صفحة **معلمات إدارة المستندات‬**، قم بتكوين الوصول إلى SharePoint Server الذي سيتم استخدامه في الشركة التي قمت بتسجيل الدخول إليها (شركة DEMF في هذا المثال).
2.  اختبر اتصال SharePoint Server للتأكد من أنه تم منحك حق الوصول. [![صفحة معلمات إدارة المستندات](./media/ger-power-bi-sharepoint-server-setting-1024x369.png)](./media/ger-power-bi-sharepoint-server-setting.png)
3.  افتح موقع SharePoint الذي تم تكوينه. أنشئ مجلدًا جديدًا حيث ستقوم التقارير الإلكترونية بتخزين ملفات Excel التي تحتوي على بيانات العمل التي تحتاج إليها تقارير Power BI كمصدر لمجموعات بيانات Power BI.
4.  في Finance and Operations، في صفحة **أنواع المستندات**، قم بإنشاء نوع مستند جديد سيتم استخدامه للوصول إلى مجلد SharePoint الذي قمت بإنشائه للتوّ. أدخل **ملف** في حقل **المجموعة** و**SharePoint** في حقل **الموقع**، ثم أدخل عنوان مجلد SharePoint. [![صفحة أنواع المستندات](./media/ger-power-bi-sharepoint-document-type-1024x485.png)](./media/ger-power-bi-sharepoint-document-type.png)

## <a name="configure-er-parameters"></a>تكوين معلمات التقارير الإلكترونية
1.  في مساحة عمل **إعداد التقارير الإلكترونية**، انقر فوق الارتباط **معلمات ‏‫إعداد التقارير الإلكترونية‬**.
2.  على علامة تبويب **المرفقات**، حدد نوع المستند **ملف** لكافة الحقول.
3.  في مساحة عمل **إعداد التقارير الإلكترونية**، اعمل على تنشيط الموفر المطلوب عن طريق النقر فوق **تعيين كنشط‬**. لمزيد من المعلومات، يمكنك تشغيل دليل المهام **التقارير الإلكترونية - تحديد موفر الخدمة**.

## <a name="use-an-er-data-model-as-the-source-of-data"></a>استخدام نموذج بيانات تقارير إلكترونية كمصدر بيانات
يجب أن يكون لديك نموذج بيانات تقارير إلكترونية كمصدر لبيانات العمل التي سيتم استخدامها في تقارير Power BI. يتم تحميل نموذج البيانات هذا من مستودع تكوينات التقارير الإلكترونية. لمزيد من المعلومات، يمكنك مراجعة [تنزيل تكوينات التقارير الإلكترونية من Lifecycle Services](download-electronic-reporting-configuration-lcs.md)، أو يمكنك تشغيل دليل المهام **التقارير الإلكترونية - استيراد تكوين من Lifecycle Services**. حدد **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**كنموذج البيانات الذي سيتم تحميله من مستودع تكوينات التقارير الإلكترونية المحددة. ‏‫(في هذا المثال، يتم استخدام الإصدار 1 من النموذج.)‬ ‏‫يمكنك عندئذٍ الوصول إلى تكوين نموذج التقارير الإلكترونية في **‬‏‫نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** في صفحة **التكوينات**. [![صفحة التكوينات](./media/ger-power-bi-data-model-1024x371.png)](./media/ger-power-bi-data-model.png)

## <a name="design-an-er-format-configuration"></a>تصميم تكوين تنسيق تقارير إلكترونية
يجب إنشاء تكوين تنسيق تقارير إلكترونية يستخدم نموذج بيانات **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** كمصدر لبيانات العمل. يجب أن ينشئ تكوين التنسيق هذا نتائج الإخراج كالمستندات الإلكترونية بتنسيق OpenXML (ملف Excel). لمزيد من المعلومات، يمكنك تشغيل دليل المهام **/التقارير الإلكترونية - إنشاء تكوين للتقارير بتنسيق OPENXML**. قم بتسمية التكوين الجديد **أنشطة الاستيراد/التصدير**، كما يظهر في التوضيح التالي. استخدم ملف Excel [بيانات التقارير الإلكترونية - تفاصيل الاستيراد والتصدير](https://go.microsoft.com/fwlink/?linkid=845208) كقالب عند تصميم تنسيق التقارير الإلكترونية. ‏‫(لمزيد من المعلومات حول كيفية استيراد قالب تنسيق، يمكنك تشغيل دليل المهام.) [![تكوين أنشطة الاستيراد/التصدير](media/ger-power-bi-format-configuration.png)](media/ger-power-bi-format-configuration.png) ‏‫لتعديل تكوين تنسيق **‬‏‫أنشطة الاستيراد/التصدير**، اتبع الخطوات التالية.‬

1.  انقر فوق **المصمم**.
2.  على علامة التبويب **تنسيق**، قم بتسمية عنصر الملف لهذا التنسيق **ملف الإخراج من Excel**. [![عنصر ملف الإخراج من Excel](./media/ger-power-bi-format-configuration-file-element-name-1024x395.png)](./media/ger-power-bi-format-configuration-file-element-name.png)
3.  على علامة التبويب **تعيين**، حدد اسم ملف Excel الذي سيتم إنشاؤه كلما تم تشغيل هذا التنسيق. قم بتكوين التعبير ذي صلة لإرجاع القيمة **تفاصيل الاستيراد والتصدير** (سيُضاف ملحق اسم الملف .xlsx تلقائيًا). [![مصمم التنسيق](./media/ger-power-bi-format-configuration-output-file-name-1024x396.png)](./media/ger-power-bi-format-configuration-output-file-name.png)
4.  أضف عنصر مصدر بيانات جديدًا لهذا التنسيق. (هذا التعداد سيكون مطلوبًا لربط بيانات أخرى.)
    1.  أدخل **direction\_enum** كاسم لمصدر البيانات.
    2.  حدد **تعداد نموذج البيانات** كنوع مصدر البيانات.
    3.  يمكنك الإشارة إلى تعداد نموذج البيانات **اتجاه**.

    [![direction\_enum](./media/ger-power-bi-format-configuration-mapping-added-enum-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-added-enum.png)
5.  استكمل ربط عناصر نموذج بيانات **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** وعناصر التنسيق المصمم، كما هو مبين في التوضيح التالي. [![استكمال الربط](./media/ger-power-bi-format-configuration-mapping-details-1024x454.png)](./media/ger-power-bi-format-configuration-mapping-details.png)

ينشئ تنسيق التقارير الإلكترونية، بعد تشغيله، نتيجة الإخراج بتنسيق Excel. ويرسل تفاصيل حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي إلى نتيجة الإخراج، ويفصلها كحركات تصف أنشطة الاستيراد أو أنشطة التصدير. انقر فوق **‎تشغيل** لاختبار التنسيق الجديد للتقارير الإلكترونية لقائمة حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي في صفحة **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي** (**الضريبة** &gt; **‎الإقرارات** &gt; **‎التجارة الخارجية** &gt; **نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي**). [![صفحة نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي](./media/ger-power-bi-format-test-run-transactions-1024x322.png)](./media/ger-power-bi-format-test-run-transactions.png) يتم إنشاء نتيجة الإخراج التالية. الملف يسمى **Import and export details.xlsx**، كما حددت في إعدادات التنسيق. [![Import and export details.xlsx](./media/ger-power-bi-format-test-run-output-1024x472.png)](./media/ger-power-bi-format-test-run-output.png)

## <a name="configure-the-er-destination"></a>تكوين وجهة التقارير الإلكترونية
يجب عليك تكوين إطار عمل التقارير الإلكترونية لإرسال نتيجة الإخراج الخاصة بتكوين تنسيق التقارير الإلكترونية الجديد بطريقة خاصة.

-   يجب إرسال نتيجة الإخراج إلى مجلد SharePoint Server المحدد.
-   يجب أن تنشئ كل عملية تنفيذ لتكوين التنسيق إصدارًا جديدًا من ملف Excel نفسه.

في صفحة **إعداد التقارير الإلكترونية** (**إدارة المؤسسة** &gt; **إعداد التقارير الإلكترونية**)، انقر فوق البند **وجهة إعداد التقارير الإلكترونية**، ثم أضف وجهة جديدة. في حقل **المرجع**، حدد تكوين تنسيق **أنشطة الاستيراد/التصدير** الذي قمت بإنشائه سابقًا. اتبع هذه الخطوات لإضافة سجل وجهة ملف جديد للمرجع.

1.  في حقل **الاسم**، أدخل عنوان وجهة الملف.
2.  في حقل **اسم ملف**، حدد الاسم **ملف الإخراج من Excel** لمكون تنسيق ملف Excel.

انقر فوق الزر **إعدادات** لسجل الوجهة الجديد. بعد ذلك، في مربع الحوار **إعدادات الوجهة**، اتبع الخطوات التالية.

1.  على علامة التبويب **Power BI**، قم بتعيين الخيار **ممكّن** إلى **نعم**.
2.  في حقل **SharePoint**، حدد نوع المستند **مشترك** الذي قمت بإنشائه سابقًا.

## <a name="schedule-execution-of-the-configured-er-format"></a>جدولة تنفيذ تنسيق التقارير الإلكتروني المكون
في صفحة **التكوينات** (**إدارة المؤسسة** &gt; **إعداد التقارير الإلكترونية** &gt; **التكوينات**)، في شجرة التكوينات، حدد تكوين **أنشطة الاستيراد/التصدير** الذي قمت بإنشائه سابقًا. قم بتغيير حالة الإصدار 1.1 من **مسودة** إلى **مكتمل** لجعل هذا التنسيق متوفرًا للاستخدام. [![صفحة التكوينات‬‏‫](./media/ger-power-bi-format-configuration-complete-1024x401.png)](./media/ger-power-bi-format-configuration-complete.png) حدد الإصدار المكتمل لتكوين **أنشطة الاستيراد/التصدير**، ومن ثم انقر فوق **تشغيل‏‎**. لاحظ تطبيق الوجهة المكوّنة على نتيجة الإخراج التي نشأت بتنسيق Excel. عيّن الخيار **معالجة الدُفعات‬** إلى **نعم** لتشغيل هذا التقرير في الوضع غير المراقب. انقر فوق **التكرار** لجدولة التكرار المطلوب لتنفيذ هذه الدُفعة. يحدد التكرار مدى تكرار نقل البيانات المحدثة من Finance and Operations إلى Power BI. [![‬‏‫مربع حوار معلمات التقرير الإلكتروني](./media/ger-power-bi-format-configuration-run-to-schedule-1024x413.png)](./media/ger-power-bi-format-configuration-run-to-schedule.png) يمكنك العثور على وظيفة تنفيذ التقارير الإلكترونية، بعد تكوينها، في صفحة **الوظائف الدفعية** (**إدارة النظام‬ &gt; الاستعلامات &gt; الوظائف الدفعية**). [![صفحة الوظائف الدفعية](./media/ger-power-bi-format-configuration-running-job-1024x410.png)](./media/ger-power-bi-format-configuration-running-job.png) عن تشغيل هذه الوظيفة للمرة الأولى، تنشئ الوجهة ملف Excel جديدًا لديه الاسم الذي تم تكوينه في مجلد SharePoint المحدد. وفي كل مرة يتم فيها تشغيل الوظيفة، تنشئ الوجهة إصدارًا جديدًا من ملف Excel هذا. [![إصدار جديد من ملف Excel](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2-1024x412.png)](./media/ger-power-bi-output-file-in-sharepoint-server-folder-2.png)

## <a name="create-a-power-bi-dataset-by-using-the-output-result-of-the-er-format"></a>إنشاء مجموعة بيانات Power BI باستخدام نتيجة الإخراج لتنسيق التقارير الإلكترونية
سجّل دخولك إلى Power BI وافتح مجموعة Power BI موجودة (مساحة عمل) أو أنشئ مجموعة جديدة. انقر فوق **إضافة** تحت **الملفات** في المقطع **استيراد أو الاتصال بالبيانات**، أو انقر فوق علامة الجمع (**+**) إلى جانب **مجموعات البيانات** في الجزء الأيمن. [![‬‏‫إنشاء مجموعة بيانات](./media/ger-power-bi-add-dataset-1024x524.png)](./media/ger-power-bi-add-dataset.png) حدد الخيار **SharePoint – مواقع الفريق**، ثم قم بإدخال مسار SharePoint Server الذي تستخدمه (**https://ax7partner.litware.com** في المثال الذي قدمناه). ثم استعرض وصولاً إلى المجلد **/Shared Documents/GER data/PowerBI**، وحدد ملف Excel الذي أنشأته كمصدر بيانات لمجموعات بيانات Power BI الجديدة. [![‬‏‫تحديد ملف Excel](./media/ger-power-bi-add-dataset-select-excel-file-1024x522.png)](./media/ger-power-bi-add-dataset-select-excel-file.png) انقر فوق **اتصال**، ثم فوق **استيراد‏‎**. يتم إنشاء مجموعة بيانات جديدة استنادًا إلى ملف Excel المحدد. كما يمكن إضافة مجموعة البيانات تلقائيًا إلى لوحة المعلومات التي تم إنشاؤها مؤخرًا. [![‬‏‫مجموعة بيانات في لوحة المعلومات](./media/ger-power-bi-added-dataset-1024x489.png)](./media/ger-power-bi-added-dataset.png) قم بتكوين جدول التحديث لمجموعة البيانات هذه لفرض تحديث دوري. تتيح التحديثات الدورية استهلاك بيانات العمل الجديدة التي تأتي من Finance and Operations من خلال التنفيذ الدوري للتقارير الإلكترونية عبر الإصدارات الجديدة من ملف Excel الذي تم إنشاؤه على SharePoint Server.

## <a name="create-a-power-bi-report-by-using-the-new-dataset"></a>إنشاء تقرير Power BI باستخدام مجموعة البيانات الجديدة
لإنشاء تقرير Power BI جديد، انقر فوق مجموعة بيانات Power BI **تفاصيل الاستيراد والتصدير** التي قمت بإنشائها. ثم قم بتكوين الرسوم المرئية. على سبيل المثال، حدد الرسم المرئي **خريطة معبأة**، ثم قم بتكوينه كما يلي:

-   قم بتعيين حقل مجموعة البيانات **CountryOrigin** إلى حقل **الموقع** للرسوم المرئية على الخريطة.
-   قم بتعيين حقل مجموعة البيانات **المبلغ** إلى حقل **إشباع الألوان** للرسوم المرئية على الخريطة.
-   أضف حقلي مجموعة البيانات **النشاط** و**السنة** إلى مجموعة حقول **عوامل التصفية** للرسوم المرئية على الخريطة.

احفظ تقرير Power BI بصيغة **تقرير تفاصيل الاستيراد والتصدير**. [![‬‏‫تقرير تفاصيل الاستيراد والتصدير](./media/ger-power-bi-added-report-1024x498.png)](./media/ger-power-bi-added-report.png) لاحظ أن الخريطة تعرض فقط البلدان/المناطق المذكورة في ملف Excel (النمسا وسويسرا في هذا المثال). يتم تلوين هذه البلدان/المناطق لإظهار نسبة المبالغ المفوترة لكل واحد منها. قم بتحديث قائمة حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي. تُضاف حركة التصدير التي نشأت من إيطاليا. [![قائمة حركات نظام جمع المعلومات التجارية بين دول الاتحاد الأوروبي](./media/ger-power-bi-new-run-new-transaction-1024x321.png)](./media/ger-power-bi-new-run-new-transaction.png) انتظر التحديث المجدول التالي للتقارير الإلكترونية والتحديث المجدول التالي لمجموعة بيانات Power BI. ثم اعمل على مراجعة تقرير Power BI (حدد لإظهار حركات الاستيراد فقط). تعرض الآن الخريطة المحدّثة إيطاليا. [![الخريطة المحدّثة](./media/ger-power-bi-new-run-new-map-1024x511.png)](./media/ger-power-bi-new-run-new-map.png)

## <a name="access-power-bi-report-in-finance-and-operations"></a>الوصول إلى تقرير Power BI في Finance and Operations.
قم بإعداد التكامل بين Finance and Operations وPower BI. لمزيد من المعلومات، راجع [تكوين تكامل Power BI لمساحات عمل](configure-power-bi-integration.md). في صفحة مساحة عمل **إعداد التقارير الإلكترونية** التي تدعم تكامل Power BI (**إدارة المؤسسة** &gt; **مساحات العمل** &gt; **مساحة عمل إعداد التقارير الإلكترونية**)، انقر فوق **خيارات** &gt; **فتح كتالوج التقرير**. حدد تقرير Power BI  **تفاصيل الاستيراد والتصدير** الذي قمت بإنشائه، لإظهار هذا التقرير كعنصر إجراء على الصفحة المحددة. انقر فوق عنصر الإجراء لفتح صفحة Finance and Operations التي تعرض التقرير الذي قمت بتصميمه في Power BI. [![تقرير تفاصيل الاستيراد والتصدير](./media/ger-power-bi-review-bi-report-in-ax-form-1024x586.png)](./media/ger-power-bi-review-bi-report-in-ax-form.png)

<a name="see-also"></a>راجع أيضًا
--------

[وجهات التقارير الإلكترونية‬](electronic-reporting-destinations.md)

[نظرة عامة حول التقارير الإلكترونية](general-electronic-reporting.md)




