---
title: "تكوين استيراد البيانات من SharePoint"
description: "يشرح هذا الموضوع كيفية استيراد بيانات من Microsoft SharePoint."
author: NickSelin
manager: AnnBe
ms.date: 11/29/2018
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User, Developer, IT Pro
ms.reviewer: shylaw
ms.search.scope: Core, Operations
ms.custom: 220314
ms.assetid: 2685df16-5ec8-4fd7-9495-c0f653e82567
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2018-04-01
ms.dyn365.ops.version: Release 8.0
ms.translationtype: HT
ms.sourcegitcommit: 060c3dec71e2b953d9341c5b5c89e60925fda34d
ms.openlocfilehash: 8053b0316c86c614b87b0e658dffade3a135f2cc
ms.contentlocale: ar-sa
ms.lasthandoff: 12/07/2018

---
# <a name="configure-data-import-from-sharepoint"></a>تكوين استيراد البيانات من SharePoint

[!include[banner](../includes/banner.md)]

لاستيراد بيانات من ملف وارد باستخدام إطار عمل إعداد التقارير الإلكتروني (ER)، يجب عليك تكوين أحد تنسيقات التقارير الإلكترونية الذي يدعم عملية الاستيراد، ثم قم بتشغيل تعيين نموذج لنوع **إلى الوجهة** الذي يستخدم هذا التنسيق كمصدر بيانات. لاستيراد البيانات، يجب عليك الانتقال إلى الملف الذي تريد استيراده. يمكن تحديد الملف الوارد يدويًا عن طريق المستخدم. باستخدام إمكانية إعداد التقارير الإلكترونية الجديدة لدعم استيراد البيانات من Microsoft SharePoint، يمكن تكوين هذه العملية كعملية غير مراقبة. يمكنك استخدام تكوينات إعداد التقارير الإلكترونية للقيام باستيراد البيانات من الملفات المخزنة في مجلدات Microsoft SharePoint. يوضح هذا الموضوع كيفية إكمال الاستيراد من SharePoint إلى Microsoft Dynamics 365 for Finance and Operations. تستخدم الأمثلة حركات المورد كبيانات الأعمال.

## <a name="prerequisites"></a>المتطلبات الأساسية
لإكمال الأمثلة في هذا الموضوع، يجب أن يكون لديك الوصول التالي:

- الوصول إلى Finance and Operations لأحد الأدوار التالية:

    - مطور إعداد التقارير الإلكتروني
    - مستشار وظيفي لإعداد التقارير الإلكتروني
    - مسؤول النظام

- الوصول إلى مثيل Microsoft SharePoint Server الذي تم تكوينه للاستخدام مع Finance and Operations.
- تنسيق التقارير الإلكترونية وتكوينات النموذج لمدفوعات 1099.

### <a name="create-required-er-configurations"></a>إنشاء تكوينات إعداد التقارير الإلكترونية اللازمة
قم بتشغيل دلائل مهام **استيراد بيانات ER من ملف Microsoft Excel** ، والتي تمثل جزءًا من العملية التجارية **‬‏‫7.5.4.3 اكتساب/تطوير خدمة تكنولوجيا المعلومات/مكونات الحلول (10677)** . تُطلعك دلائل المهام هذه على عملية تصميم تكوينات إعدادات التقارير الإلكترونية واستخدامها لاستيراد حركات المورد بشكل تفاعلي من ملفات Microsoft Excel. للحصول على مزيد من المعلومات، راجع [توزيع المستندات الواردة في Microsoft Excel](parse-incoming-documents-excel.md). بعد إكمال دلائل المهام، ستقوم بإعداد ما يلي:

#### <a name="er-configurations"></a>تكوينات التقارير الإلكترونية

- تكوين نموذج إعداد التقارير الإلكترونية، **نموذج مدفوعات 1099**
- تكوين تنسيق إعداد التقارير الإلكترونية، **التنسيق لاستيراد حركات الموردين من ملف Excel**

![تكوينات التقارير الإلكترونية لاستيراد البيانات من SharePoint](./media/GERImportFromSharePoint-01-Configurations.PNG)

#### <a name="sample-of-the-incoming-file-for-data-import"></a>عينة من ملف وارد لاستيراد البيانات

- ملف Excel **1099import data.xlsx**، مع حركات المورد التي ينبغي استيرادها إلى Finance and Operations.

![عينة من ملف Microsoft Excel للاستيراد من SharePoint](./media/GERImportFromSharePoint-02-Excel.PNG)
    
> [!NOTE]
> تم تحديد التنسيق لاستيراد حركات المورد كتخطيط نموذج افتراضي. لذلك، إذا قمت بتشغيل تعيين نموذج لـ **نموذج مدفوعات 1099**، وكان تعيين النموذج هذا من النوع **إلى الوجهة** ، يقوم تعيين النموذج بتشغيل هذا التنسيق لاستيراد بيانات من ملفات خارجية. ثم يستخدم هذه البيانات لتحديث جداول التطبيق.

## <a name="configure-access-to-sharepoint-for-file-storage"></a>تكوين الوصول إلى SharePoint لتخزين الملفات
لتخزين ملفات التقارير الإلكترونية في موقع SharePoint، يجب أن تقوم بتكوين الوصول إلى مثيل SharePoint Server الذي ستستخدمه الشركة الحالية. في هذا المثال، الشركة هي USMF. للحصول على الإرشادات، راجع [تكوين مساحة تخزين SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).

1. أكمل الخطوات الواردة في [تكوين مساحة تخزين SharePoint](../../fin-and-ops/organization-administration/configure-document-management.md#configure-sharepoint-storage).
2. افتح موقع SharePoint الذي تم تكوينه.
3. أنشئ المجلدات التالية حيث يمكنك حفظ ملفات التقارير الإلكترونية الواردة:

     - مصدر استيراد الملفات (الرئيسي) (يظهر مثال في لقطة الشاشة أدناه)
     - مصدر استيراد الملفات (البديل)

    ![مصدر استيراد الملفات (الرئيسي)](./media/GERImportFromSharePoint-04-SharePointFolder1.png)

4. (اختياري) أنشئ المجلدات التالية حيث يمكنك حفظ الملفات بعد استيرادها. 

    - مجلد أرشيف الملفات - يتم تخزين الملفات التي تم استيرادها بنجاح في هذا المجلد.
    - مجلد تحذير الملفات -يتم تخزين الملفات التي تم استيرادها مع تحذير في هذا المجلد.
    - مجلد أخطاء الملفات - يتم تخزين الملفات التي فشل استيرادها في هذا المجلد.

4. في Finance and Operations، انتقل إلى **إدارة المؤسسة‬ > إدارة المستندات > أنواع المستندات**.
5. أنشئ أنواع المستندات التالية التي سيتم استخدامها للوصول إلى مجلدات SharePoint التي أنشأته للتوّ. بإنشائها. للحصول على إرشادات، راجع [تكوين أنواع المستندات](../../fin-and-ops/organization-administration/configure-document-management.md#configure-document-types).

|نوع المستند       | مجموعة              |  الموق      | مجلد SharePoint      |
|--------------------|--------------------|---------------|------------------------|
|SP الرئيسي             |ملف                |SharePoint     |مصدر استيراد الملفات (الرئيسي)|
|ٍSP البديل             |ملف                |SharePoint     |مصدر استيراد الملفات (البديل)|
|أرشيف SP             |ملف                |SharePoint     |مجلد أرشيف الملفات|
|تحذير SP             |ملف                |SharePoint     |مجلد تحذير الملفات|
|خطأ SP             |ملف                |SharePoint     |مجلد أخطاء الملفات|

![إعداد SharePoint - نوع مستند جديد](./media/GERImportFromSharePoint-06-SharePointDocumentTypesSetup.png)

## <a name="configure-er-sources-for-the-er-format"></a>تكوين مصادر إعداد التقارير الإلكترونية لتنسيق إعداد التقارير الإلكترونية
1. انقر فوق **إدارة المؤسسة** \> **إعداد التقارير الإلكترونية** \> **مصدر إعداد التقارير الإلكترونية**.
2. على صفحة **مصدر إعداد التقارير الإلكترونية** ، قم بتكوين ملفات المصدر لاستيراد البيانات باستخدام تنسيق إعداد التقارير الإلكترونية الذي تم تكوينه.
3. تعريف قناع اسم ملف، بحيث يتم فقط استيراد الملفات ذات الامتداد .xlsx. يُعد قناع اسم الملف اختياريًا، ويستخدم فقط عندما يتم تعريفه. يمكنك تحديد قناع واحد فقط لكل تنسيق إعداد تقارير إلكترونية.
4. قم بتغيير **فرز الملفات قبل الاستيراد‬** إلى **لا يقومون بالفرز**، إذا كان عدد الملفات المطلوب استيرادها كبيرًا جدًا ولم يكن ترتيب الاستيراد مهمًا.
5. حدد جميع مجلدات SharePoint التي أنشأتها في وقت سابق.

    [![إعداد مصدر ملفات إعداد التقارير الإلكترونية](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)](./media/GERImportFromSharePoint-07-FormatSourceSetup.PNG)

> [!NOTE]
> - يتم تعريف *مصدر* إعداد التقارير الإلكترونية لكل شركة تطبيق على حدة. وفي المقابل، تتم مشاركة *تكوينات* إعداد التقارير الإلكترونية بين الشركات.
> - عندما تقوم بحذف إعداد مصدر التقارير الإلكترونية لتنسيق التقارير الإلكترونية، يتم أيضًا حذف كافة حالات الملفات المتصلة (أنظر أدناه) حسب تأكيد الحذف.

## <a name="review-the-files-states-for-the-er-format"></a>مراجعة حالات الملفات لتنسيق إعداد التقارير الإلكترونية
1. على صفحة **مصدر التقارير الإلكترونية** ، حدد **حالات الملفات للمصادر** لمراجعة محتوى مصادر الملفات المكونة لتنسيق التقارير الإلكترونية الحالي.
2. في قسم **الملفات** ، راجع قائمة الملفات. توضح هذه القائمة ما يلي:

    - ملفات المصادر القابلة للتطبيق، استنادًا إلى قناع اسم الملف (إذا كان قناع اسم الملف مُعرفًا)، والتي تكون جاهزة لاستيراد البيانات. بالنسبة لهذه الملفات، يكون قسم **‏‫سجلات المصادر لتنسيق الاستيراد‬** فارغًا.
    - الملفات التي تم استيرادها في وقت سابق. لكل ملف من هذه الملفات، في قسم **سجلات المصادر لتنسيق الاستيراد** ، يمكنك مراجعة محفوظات الاستيراد من هذا الملف.

يمكنك أيضًا فتح صفحة **حالات الملف للمصادر** عن طريق تحديد **إدارة المؤسسة** \> **إعداد التقارير الإلكترونية** \> **حالات الملف للمصادر**. في هذه الحالة، توفر الصفحة معلومات حول مصادر الملفات لكافة تنسيقات إعداد التقارير الإلكترونية التي تم تكوين مصادر ملفات لها في الشركة التي قمت بتسجيل الدخول إليها حاليًا.

## <a name="import-data-from-excel-files-that-are-in-a-sharepoint-folder"></a>استيراد بيانات من ملفات Excel موجودة في مجلد SharePoint
1. في SharePoint، قيم بتحميل ملف Microsoft Excel **1099import data.xlsx** الذي يحتوي على حركات المورد إلى مجلد SharePoint **مصدر استيراد الملفات (الرئيسي)** الذي قمت بإنشائه في وقت سابق.

    [![محتوى SharePoint- ملف Microsoft Excel للاستيراد](./media/GERImportFromSharePoint-08-UploadFile.png)](./media/GERImportFromSharePoint-08-UploadFile.png)

2. في Finance and Operations، على صفحة **حالات الملف للمصادر** ، حدد **تحديث** لتحديث الصفحة. لاحظ ظهور ملف Excel الذي تم تحميله على SharePoint في هذه الصفحة في حالة **جاهز**. الحالات التالية مدعومة حاليًا:

    - **جاهز** – تُعيّن هذه الحالة تلقائيًا لكل ملف جديد في مجلد SharePoint. تعني هذه الحالة أن الملف جاهز للاستيراد.
    - **استيراد** – تُعيّن هذه الحالة تلقائيًا بواسطة تقرير إعداد التقارير الإلكترونية عندما يتم تأمين الملف من خلال عملية الاستيراد لمنع استخدامه من خلال عمليات أخرى (عند تشغيل عدة عمليات في الوقت نفسه).
    - **مستورد** – تُعيّن هذه الحالة تلقائيًا بواسطة تقرير إعداد التقارير الإلكترونية عند إتمام عملية استيراد الملفات بنجاح. تعني هذه الحالة أن الملف المستود قد تم حذفه من مصدر الملفات المكونة (مجلد SharePoint)
    - **فشل** – تُعيّن هذه الحالة تلقائيًا بواسطة تقرير إعداد التقارير الإلكترونية عند إتمام عملية استيراد الملفات مع وجود أخطاء أو استثناءات.
    - **قيد الانتظار** – تُعيّن هذه الحالة يدويًا بواسطة المستخدم في هذه الصفحة. تعني هذه الحالة أن الملف لن يتم استيراده في الوقت الحاضر. يمكن استخدام هذه الحالة لتأجيل استيراد بعض الملفات.

    [![صفحة حالات ملف إعداد التقارير الإلكتروني للمصادر المحددة](./media/GERImportFromSharePoint-09-FileStatesForm.png)](./media/GERImportFromSharePoint-09-FileStatesForm.png)

## <a name="import-data-from-sharepoint-files"></a>استيراد بيانات من ملفات SharePoint
1. افتح شجرة تكوينات إعداد التقارير الإلكترونية، حدد **نموذج الدفع 1099**، ثم قم بتوسيع قائمة مكونات نموذج إعداد التقارير الإلكترونية.
2. حدد اسم لتعيين النموذج لفتح قائمة تعيينات النماذج لتكوينات نماذج إعداد التقارير الإلكترونية المحددة.

    [![صفحة حالات ملف إعداد التقارير الإلكتروني للمصادر المحددة](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)](./media/GERImportFromSharePoint-10-SelectModelMapping.PNG)

3. حدد **تشغيل** لتشغيل تعيين النموذج المحدد. نظرًا لقيامك بتكوين مصادر الملفات لتنسيق التقارير الإلكترونية، يمكنك تغيير إعداد الخيار **ملف المصدر** إذا اقتضت الحاجة. إذا حافظت على إعداد هذا الخيار، يتم استيراد ملفات .xslx من المصادر التي تم تكوينها (ملفات SharePoint في هذا المثال).

    في هذا المثال، تقوم باستيراد ملف واحد فقط. ومع ذلك، إذا كان هناك ملفات متعددة، يتم تحديدها للاستيراد بالترتيب الذي تمت إضافتها به إلى مجلد SharePoint. يستورد كل تشغيل لتنسيق إعداد التقارير الإلكترونية ملف واحد مُحدد.

    [![ER-model-mappingr](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)](./media/GERImportFromSharePoint-11-RunModelMapping.PNG)

4. يمكن تشغيل تعيين النموذج دون مراقبة في وضع الدفعة. في هذه الحالة، في كل مرة تقوم دفعة بتشغيل تنسيق إعداد التقارير الإلكترونية هذه، يتم استيراد ملف واحد من مصادر الملفات التي تم تكوينها.

    عند نجاح عملية استيراد ملف من مجلد SharePoint، يتم حذفه من هذا المجلد ونقله إلى مجلد الملفات التي نجحت عملية استيرادها أو إلى مجلد الملفات المستوردة مع تحذيرات. بخلاف ذلك، يتم نقله إلى مجلد الملفات التي فشل استيرادها أو يبقى موجودًا في هذا المجلد إذا لم يتم إعداد مجلد الملفات التي فشل استيرادها. 

5. أدخل معرف إيصال، مثل **V-00001**، ثم قم بتحديد **موافق**.

    [![ER-model-mappingr](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-12-ModelMappingRunFinished.PNG)

6. على صفحة **حالات الملف للمصادر** ، حدد **تحديث** لتحديث الصفحة.

    [![صفحة حالات ملف إعداد التقارير الإلكتروني للمصادر المحددة](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)](./media/GERImportFromSharePoint-13-FileStatesForm.PNG)

7. في قسم **الملفات** ، راجع قائمة الملفات. يوفر قسم **سجلات المصادر لتنسيق الاستيراد‬‬‏‫** المحفوظات الخاصة باستيراد ملف Excel. نظراً لأن هذا الملف تم استيراده بنجاح، تم وضع علامة **محذوف** في مجلد SharePoint.
8. مراجعة مجلد SharePoint **مصدر استيراد الملفات (الرئيسي)** . تم حذف ملفات Excel التي تم استيرادها بنجاح من هذا المجلد .
9. في Finance and Operations، حدد **الحسابات الدائنة** \> **المهام الدورية** \> **ضريبة 1099** \> **تسوية المورد لنموذج 1099**.
10. في حقول **من تاريخ** و **إلى تاريخ** ، أدخل القيم المناسبة. بعد ذلك، حدد **حركات 1099 اليدوية**.

    يتم عرض حركات المورد التي تم استيرادها من ملفات Excel في SharePoint للإيصال **V-00001** في الصفحة.

    [![صفحة حركات المورد 1099](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)](./media/GERImportFromSharePoint-14-ImportedTransactions.PNG)

## <a name="prepare-an-excel-file-for-import"></a>إعداد ملف Excel للاستيراد
1. افتح ملف Excel الذي استخدمته مسبقًا. في الصف رقم (3) عمود رقم (1)، أضف كود المورد غير الموجود في التطبيق. أضف معلومات مورد إضافية خطأ إلى الصف.

    [![نموذج لملف Microsoft Excel للاستيراد من SharePoint](./media/GERImportFromSharePoint-15-Excel.PNG)](./media/GERImportFromSharePoint-15-Excel.PNG)

2. قم بتحميل ملف Excel المُحدث الذي يحتوي على حركات الموردين إلى مجلد SharePoint **مصدر استيراد الملفات (الرئيسي)** .
3. في Finance and Operations، افتح شجرة تكوينات إعداد التقارير الإلكترونية، حدد **نموذج الدفع 1099**، ثم قم بتوسيع قائمة مكونات نموذج إعداد التقارير الإلكترونية.
4. حدد اسم تعيين النموذج لتحديث تعيين النموذج حتي يتم اعتبار كود المورد غير الصحيح خطأ خلال عملية استيراد البيانات.
5. حدد **المصمم**.
6. على علامة تبويب **عمليات التحقق من الصحة** ، يجب عليك تغيير إجراء ما بعد التحقق من الصحة لقاعدة التحقق من الصحة التي تم تكوينها لتقييم ما إذا كان حساب المورد الذي تم استيراده موجود في التطبيق أم لا. قم بتحديث قيمة حقل **إجراء ما بعد التحقق من الصحة** إلى **إيقاف التنفيذ** ، ثم احفظ التغييرات التي أجريتها واغلق الصفحة.

    [![ER model mapping designer](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)](./media/GERImportFromSharePoint-16-UpdateModelMapping.PNG)

7. احفظ التغييرات التي اجريتها، وقم بإغلاق مصمم تعيين نموذج إعداد التقارير الإلكترونية.
8. حدد **تشغيل** لتشغيل تعيين نموذج إعداد التقارير الإلكترونية المُعدّل.
9. أدخل معرف إيصال، مثل **V-00002**، ثم قم بتحديد **موافق**.

    لاحظ أن سجل المعلومات يتضمن إعلامًا يفيد بوجود ملف في مجلد SharePoint يحتوي على حساب مورّد غير صحيح ولا يمكن استيراده

    [![تشغيل ER model mapping](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)](./media/GERImportFromSharePoint-17-ModelMappingRunFinished.PNG)

10. في صفحة **حالات الملف للمصادر** ، حدد **تحديث**، ثم في قسم **الملفات** ، قم بمراجعة قائمة الملفات.

    [![صفحة حالات ملف إعداد التقارير الإلكتروني للمصادر المحددة](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)](./media/GERImportFromSharePoint-18-FileStatesForm.PNG)

   يشير قسم **سجلات المصدر لتنسيق الاستيراد** إلى فشل عملية الاستيراد وإلى أن الملف ما زال موجودًا في مجلد أخطاء الملفات‬ في SharePoint (لم يتم تحديد خانة الاختيار **محذوف** ). إذا أصلحت هذا الملف في SharePoint عن طريق إضافة كود المورّد المناسب ثم نقلته إلى مجلد SharePoint مصدر استيراد الملفات (الرئيسي)، يمكنك استيراد الملف مرة أخرى.

11. في Finance and Operations، حدد **الحسابات الدائنة** \> **المهام الدورية** \> **ضريبة 1099** \> **تسوية المورد لنموذج 1099**، أدخل قيمًا مناسبة في حقول **من تاريخ** و **إلى تاريخ** ، ثم حدد **حركات 1099 اليدوية**.

    تتوفر حركات للإيصال V-00001 فقط. لا تتوفر حركات للإيصال V-00002 على الرغم من أنه تم العثور على الخطأ الخاص بالحركة التي تم استيرادها مؤخرًا في ملف Excel.

